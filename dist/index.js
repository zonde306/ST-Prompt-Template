import*as __WEBPACK_EXTERNAL_MODULE__libs_faker_mjs_f3becd00__ from"../libs/faker.mjs";import*as __WEBPACK_EXTERNAL_MODULE__script_js_588e7203__ from"../../../../../script.js";import*as __WEBPACK_EXTERNAL_MODULE__slash_commands_js_f5742a84__ from"../../../../slash-commands.js";import*as __WEBPACK_EXTERNAL_MODULE__world_info_js_83198f57__ from"../../../../world-info.js";import*as __WEBPACK_EXTERNAL_MODULE__power_user_js_3c7cfb8b__ from"../../../../power-user.js";import*as __WEBPACK_EXTERNAL_MODULE__utils_js_d605cabe__ from"../../../../utils.js";import*as __WEBPACK_EXTERNAL_MODULE__group_chats_js_678c16bd__ from"../../../../group-chats.js";import*as __WEBPACK_EXTERNAL_MODULE__extensions_js_e625da88__ from"../../../../extensions.js";import*as __WEBPACK_EXTERNAL_MODULE__regex_engine_js_683beba0__ from"../../../regex/engine.js";import*as __WEBPACK_EXTERNAL_MODULE__openai_js_bf183548__ from"../../../../openai.js";import*as __WEBPACK_EXTERNAL_MODULE__tokenizers_js_d5863f55__ from"../../../../tokenizers.js";import*as __WEBPACK_EXTERNAL_MODULE__reasoning_js_8d5a64cc__ from"../../../../reasoning.js";import*as __WEBPACK_EXTERNAL_MODULE__slash_commands_SlashCommand_js_1b0d5616__ from"../../../../slash-commands/SlashCommand.js";import*as __WEBPACK_EXTERNAL_MODULE__slash_commands_SlashCommandArgument_js_a42b9371__ from"../../../../slash-commands/SlashCommandArgument.js";import*as __WEBPACK_EXTERNAL_MODULE__slash_commands_SlashCommandParser_js_42c8b851__ from"../../../../slash-commands/SlashCommandParser.js";var __webpack_modules__={7921:(e,t,n)=>{var r=n(3270),i=n(7510),s=r.Parser.extend(n(3181)).extend(n(9164)).extend(n(3511)).extend(n(9067)).extend(n(439).Ay),a=s.extend(n(4671)).extend(n(5679));function o(e){return e||(e={}),i({ecmaVersion:2020,allowHashBang:!0,allowReturnOutsideFunction:!0},e)}function u(e){return e||(e={}),"module"===e.sourceType?a:s}e.exports=i(r,{parse:function(e,t){return u(t).parse(e,o(t))},parseExpressionAt:function(e,t,n){return u(n).parseExpressionAt(e,t,o(n))},tokenizer:function(e,t){return u(t).tokenizer(e,o(t))}})},3181:(e,t,n)=>{var r=n(3270),i=r.tokTypes,s=r.isIdentifierStart;e.exports=function(e){return function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.parseLiteral=function(t){var n=e.prototype.parseLiteral.call(this,t);return 110==n.raw.charCodeAt(n.raw.length-1)&&(n.bigint=this.getNumberInput(n.start,n.end)),n},t.prototype.readRadixNumber=function(e){var t=this.pos;this.pos+=2;var n=this.readInt(e);if(null===n&&this.raise(this.start+2,"Expected number in radix "+e),110==this.input.charCodeAt(this.pos)){var r=this.getNumberInput(t,this.pos);n="undefined"!=typeof BigInt?BigInt(r):null,++this.pos}else s(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");return this.finishToken(i.num,n)},t.prototype.readNumber=function(t){var n=this.pos;if(t)return e.prototype.readNumber.call(this,t);if(48===this.input.charCodeAt(n)&&110!==this.input.charCodeAt(n+1))return e.prototype.readNumber.call(this,t);if(null===this.readInt(10)&&this.raise(n,"Invalid number"),110!=this.input.charCodeAt(this.pos))return this.pos=n,e.prototype.readNumber.call(this,t);var r=this.getNumberInput(n,this.pos),s="undefined"!=typeof BigInt?BigInt(r):null;return++this.pos,this.finishToken(i.num,s)},t.prototype.getNumberInput=function(t,n){return e.prototype.getNumberInput?e.prototype.getNumberInput.call(this,t,n):this.input.slice(t,n)},t}(e)}},9164:(e,t,n)=>{var r=n(3270).tokTypes,i=n(4078);function s(e){if(this.eat(r.eq)){var t=this._inFieldValue;this._inFieldValue=!0,e.value=this.parseExpression(),this._inFieldValue=t}else e.value=null}e.exports=function(e){return function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.parseClassElement=function(t){if(this.options.ecmaVersion>=8&&(this.type==r.name||this.type==this.privateNameToken||this.type==r.bracketL||this.type==r.string)){var n=this._branch();if(n.type==r.bracketL){var i=0;do{n.eat(r.bracketL)?++i:n.eat(r.bracketR)?--i:n.next()}while(i>0)}else n.next();if(n.type==r.eq||n.canInsertSemicolon()||n.type==r.semi){var a=this.startNode();return this.type==this.privateNameToken?this.parsePrivateClassElementName(a):this.parsePropertyName(a),("Identifier"===a.key.type&&"constructor"===a.key.name||"Literal"===a.key.type&&"constructor"===a.key.value)&&this.raise(a.key.start,"Classes may not have a field called constructor"),s.call(this,a),this.finishNode(a,"FieldDefinition"),this.semicolon(),a}}return e.prototype.parseClassElement.apply(this,arguments)},t.prototype.parseIdent=function(t,n){var r=e.prototype.parseIdent.call(this,t,n);return this._inFieldValue&&"arguments"==r.name&&this.raise(r.start,"A class field initializer may not contain arguments"),r},t}(e=i(e))}},439:(e,t,n)=>{var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};t.Ay=function(e){return function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"parseStatement",value:function(e,n,r){return this.type===s.tokTypes._import&&u.call(this)?this.parseExpressionStatement(this.startNode(),this.parseExpression()):i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"parseStatement",this).call(this,e,n,r)}},{key:"parseExprAtom",value:function(e){return this.type===s.tokTypes._import?o.call(this):i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"parseExprAtom",this).call(this,e)}}]),t}(e)};var s=n(3270);var a="Import";function o(){var e=this.startNode();return this.next(),this.type!==s.tokTypes.parenL&&this.unexpected(),this.finishNode(e,a)}function u(){return/^(\s|\/\/.*|\/\*[^]*?\*\/)*\(/.test(this.input.slice(this.pos))}s.tokTypes._import.startsExpr=!0},4671:(e,t,n)=>{var r=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,i=n(3270).tokTypes;e.exports=function(e){return function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.parseExport=function(t,n){r.lastIndex=this.pos;var s=r.exec(this.input);if("*"!==this.input.charAt(this.pos+s[0].length))return e.prototype.parseExport.call(this,t,n);this.next();var a=this.startNode();return this.expect(i.star),this.eatContextual("as")&&(t.declaration=null,a.exported=this.parseIdent(!0),this.checkExport(n,a.exported.name,this.lastTokStart),t.specifiers=[this.finishNode(a,"ExportNamespaceSpecifier")]),this.expectContextual("from"),this.type!==i.string&&this.unexpected(),t.source=this.parseExprAtom(),this.semicolon(),this.finishNode(t,t.specifiers?"ExportNamedDeclaration":"ExportAllDeclaration")},t}(e)}},5679:(e,t,n)=>{var r=n(3270).tokTypes,i=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,s=function(e){i.lastIndex=e.pos;var t=i.exec(e.input),n=e.pos+t[0].length;return"."===e.input.slice(n,n+1)};e.exports=function(e){return function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.parseExprAtom=function(t){if(this.type!==r._import||!s(this))return e.prototype.parseExprAtom.call(this,t);this.options.allowImportExportEverywhere||this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'");var n=this.startNode();return n.meta=this.parseIdent(!0),this.expect(r.dot),n.property=this.parseIdent(!0),"meta"!==n.property.name&&this.raiseRecoverable(n.property.start,"The only valid meta property for import is import.meta"),this.finishNode(n,"MetaProperty")},t.prototype.parseStatement=function(t,n,i){if(this.type!==r._import||!s(this))return e.prototype.parseStatement.call(this,t,n,i);var a=this.startNode(),o=this.parseExpression();return this.parseExpressionStatement(a,o)},t}(e)}},9067:e=>{e.exports=function(e){return function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.readInt=function(t,n){if(null!=n)return e.prototype.readInt.call(this,t,n);for(var r=this.pos,i=0,s=!1;;){var a=this.input.charCodeAt(this.pos),o=void 0;if(a>=97)o=a-97+10;else{if(95==a){s||this.raise(this.pos,"Invalid numeric separator"),++this.pos,s=!1;continue}o=a>=65?a-65+10:a>=48&&a<=57?a-48:1/0}if(o>=t)break;++this.pos,i=i*t+o,s=!0}return this.pos===r?null:(s||this.raise(this.pos-1,"Invalid numeric separator"),i)},t.prototype.readNumber=function(t){var n=e.prototype.readNumber.call(this,t),r=this.end-this.start>=2&&48===this.input.charCodeAt(this.start),i=this.getNumberInput(this.start,this.end);return i.length<this.end-this.start&&(r&&this.raise(this.start,"Invalid number"),this.value=parseFloat(i)),n},t.prototype.getNumberInput=function(e,t){return this.input.slice(e,t).replace(/_/g,"")},t}(e)}},4078:(e,t,n)=>{var r=n(3270);var i=r.tokTypes,s=r.TokenType;e.exports=function(e){if(e.prototype.parsePrivateName)return e;for(var t=e;t&&t!==r.Parser;)t=t.__proto__;if(t!==r.Parser)throw new Error("acorn-private-class-elements does not support mixing different acorn copies");return e=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._branch=function(){return this.__branch=this.__branch||new e({ecmaVersion:this.options.ecmaVersion},this.input),this.__branch.end=this.end,this.__branch.pos=this.pos,this.__branch.type=this.type,this.__branch.value=this.value,this.__branch.containsEsc=this.containsEsc,this.__branch},t.prototype.parsePrivateClassElementName=function(e){e.computed=!1,e.key=this.parsePrivateName(),"constructor"==e.key.name&&this.raise(e.key.start,"Classes may not have a private element named constructor");var t={get:"set",set:"get"}[e.kind],n=this._privateBoundNamesStack[this._privateBoundNamesStack.length-1];return Object.prototype.hasOwnProperty.call(n,e.key.name)&&n[e.key.name]!==t&&this.raise(e.start,"Duplicate private element"),n[e.key.name]=e.kind||!0,delete this._unresolvedPrivateNamesStack[this._unresolvedPrivateNamesStack.length-1][e.key.name],e.key},t.prototype.parsePrivateName=function(){var e=this.startNode();return e.name=this.value,this.next(),this.finishNode(e,"PrivateName"),"never"==this.options.allowReserved&&this.checkUnreserved(e),e},t.prototype.getTokenFromCode=function(t){if(35===t){++this.pos;var n=this.readWord1();return this.finishToken(this.privateNameToken,n)}return e.prototype.getTokenFromCode.call(this,t)},t.prototype.parseClass=function(t,n){this._privateBoundNamesStack=this._privateBoundNamesStack||[];var r=Object.create(this._privateBoundNamesStack[this._privateBoundNamesStack.length-1]||null);this._privateBoundNamesStack.push(r),this._unresolvedPrivateNamesStack=this._unresolvedPrivateNamesStack||[];var i=Object.create(null);this._unresolvedPrivateNamesStack.push(i);var s=e.prototype.parseClass.call(this,t,n);if(this._privateBoundNamesStack.pop(),this._unresolvedPrivateNamesStack.pop(),this._unresolvedPrivateNamesStack.length)Object.assign(this._unresolvedPrivateNamesStack[this._unresolvedPrivateNamesStack.length-1],i);else{var a=Object.keys(i);a.length&&(a.sort((function(e,t){return i[e]-i[t]})),this.raise(i[a[0]],"Usage of undeclared private name"))}return s},t.prototype.parseSubscript=function(t,n,r,s,a){if(!this.eat(i.dot))return e.prototype.parseSubscript.call(this,t,n,r,s,a);var o=this.startNodeAt(n,r);return o.object=t,o.computed=!1,this.type==this.privateNameToken?(o.property=this.parsePrivateName(),this._privateBoundNamesStack.length&&this._privateBoundNamesStack[this._privateBoundNamesStack.length-1][o.property.name]||(this._unresolvedPrivateNamesStack[this._unresolvedPrivateNamesStack.length-1][o.property.name]=o.property.start)):o.property=this.parseIdent(!0),this.finishNode(o,"MemberExpression")},t.prototype.parseMaybeUnary=function(t,n){var r=e.prototype.parseMaybeUnary.call(this,t,n);return"delete"==r.operator&&"MemberExpression"==r.argument.type&&"PrivateName"==r.argument.property.type&&this.raise(r.start,"Private elements may not be deleted"),r},t}(e),e.prototype.privateNameToken=new s("privateName"),e}},3511:(e,t,n)=>{var r=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,i=n(3270).tokTypes;function s(e){if(this.eat(i.eq)){var t=this._inStaticFieldValue;this._inStaticFieldValue=!0,e.value=this.parseExpression(),this._inStaticFieldValue=t}else e.value=null}var a=n(4078);e.exports=function(e){return function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.parseClassElement=function(t){var n=this;if(this.eat(i.semi))return null;var a=this.startNode(),o=function(e,t){void 0===t&&(t=!1);var r=n.start,s=n.startLoc;return!!n.eatContextual(e)&&(!(n.type===i.parenL||t&&n.canInsertSemicolon())||(a.key&&n.unexpected(),a.computed=!1,a.key=n.startNodeAt(r,s),a.key.name=e,n.finishNode(a.key,"Identifier"),!1))};if(a.static=o("static"),!a.static)return e.prototype.parseClassElement.apply(this,arguments);var u=this.eat(i.star),c=!1;if(!u)if(this.options.ecmaVersion>=8&&this.isContextual("async")){r.lastIndex=this.pos;var l=r.exec(this.input),p=this.input.charAt(this.pos+l[0].length);if(";"===p||"="===p)return a.key=this.parseIdent(!0),a.computed=!1,s.call(this,a),this.finishNode(a,"FieldDefinition"),this.semicolon(),a;this.options.ecmaVersion>=8&&o("async",!0)&&(c=!0,u=this.options.ecmaVersion>=9&&this.eat(i.star))}else o("get")?a.kind="get":o("set")&&(a.kind="set");if(this.type===this.privateNameToken){if(this.parsePrivateClassElementName(a),this.type!==i.parenL)return"prototype"===a.key.name&&this.raise(a.key.start,"Classes may not have a private static property named prototype"),s.call(this,a),this.finishNode(a,"FieldDefinition"),this.semicolon(),a}else a.key||(this.parsePropertyName(a),"prototype"!==(a.key.name||a.key.value)||a.computed||this.raise(a.key.start,"Classes may not have a static property named prototype"));return a.kind||(a.kind="method"),this.parseClassMethod(a,u,c),a.kind||"constructor"!==(a.key.name||a.key.value)||a.computed||this.raise(a.key.start,"Classes may not have a static field named constructor"),"get"===a.kind&&0!==a.value.params.length&&this.raiseRecoverable(a.value.start,"getter should have no params"),"set"===a.kind&&1!==a.value.params.length&&this.raiseRecoverable(a.value.start,"setter should have exactly one param"),"set"===a.kind&&"RestElement"===a.value.params[0].type&&this.raiseRecoverable(a.value.params[0].start,"Setter cannot use rest params"),a},t.prototype.parseClassMethod=function(t,n,r,a){return n||r||"method"!=t.kind||!t.static||this.options.ecmaVersion<8||this.type==i.parenL?e.prototype.parseClassMethod.apply(this,arguments):(s.call(this,t),delete t.kind,t=this.finishNode(t,"FieldDefinition"),this.semicolon(),t)},t.prototype.parseIdent=function(t,n){var r=e.prototype.parseIdent.call(this,t,n);return this._inStaticFieldValue&&"arguments"==r.name&&this.raise(r.start,"A static class field initializer may not contain arguments"),r},t}(a(e))}},5134:e=>{e.exports=function(){function e(t,n,r){function i(a,o){if(!n[a]){if(!t[a]){if(s)return s(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};t[a][0].call(c.exports,(function(e){return i(t[a][1][e]||e)}),c,c.exports,e,t,n,r)}return n[a].exports}for(var s=void 0,a=0;a<r.length;a++)i(r[a]);return i}return e}()({1:[function(e,t,n){var r=e("fs"),i=e("path"),s=e("./utils"),a=!1,o=e("../package.json").version,u="<",c=">",l="%",p="locals",h="ejs",d="(<%%|%%>|<%=|<%-|<%_|<%#|<%|%>|-%>|_%>)",f=["delimiter","scope","context","debug","compileDebug","client","_with","rmWhitespace","strict","filename","async"],m=f.concat("cache"),_=/^\uFEFF/,D=/^(?:[\$A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[\$0-9A-Z_a-z\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05EF-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u07FD\u0800-\u082D\u0840-\u085B\u0860-\u086A\u0870-\u0887\u0889-\u088E\u0897-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u09FE\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3C-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C5D\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDD\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1-\u0CF3\u0D00-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D81-\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECE\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1715\u171F-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u180F-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1ABF-\u1ACE\u1B00-\u1B4C\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CD0-\u1CD2\u1CD4-\u1CFA\u1D00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA827\uA82C\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF65-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD27\uDD30-\uDD39\uDD40-\uDD65\uDD69-\uDD6D\uDD6F-\uDD85\uDE80-\uDEA9\uDEAB\uDEAC\uDEB0\uDEB1\uDEC2-\uDEC4\uDEFC-\uDF1C\uDF27\uDF30-\uDF50\uDF70-\uDF85\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC00-\uDC46\uDC66-\uDC75\uDC7F-\uDCBA\uDCC2\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD44-\uDD47\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDC9-\uDDCC\uDDCE-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E-\uDE41\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3B-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7-\uDFC0\uDFC2\uDFC5\uDFC7-\uDFCA\uDFCC-\uDFD3\uDFE1\uDFE2]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC5E-\uDC61\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB8\uDEC0-\uDEC9\uDED0-\uDEE3\uDF00-\uDF1A\uDF1D-\uDF2B\uDF30-\uDF39\uDF40-\uDF46]|\uD806[\uDC00-\uDC3A\uDCA0-\uDCE9\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD35\uDD37\uDD38\uDD3B-\uDD43\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD7\uDDDA-\uDDE1\uDDE3\uDDE4\uDE00-\uDE3E\uDE47\uDE50-\uDE99\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0\uDFF0-\uDFF9]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD8E\uDD90\uDD91\uDD93-\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF6\uDF00-\uDF10\uDF12-\uDF3A\uDF3E-\uDF42\uDF50-\uDF5A\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC40-\uDC55\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD39]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDD70-\uDD79\uDE40-\uDE7F\uDF00-\uDF4A\uDF4F-\uDF87\uDF8F-\uDF9F\uDFE0\uDFE1\uDFE3\uDFE4\uDFF0\uDFF1]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD833[\uDCF0-\uDCF9\uDF00-\uDF2D\uDF30-\uDF46]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDC30-\uDC6D\uDC8F\uDD00-\uDD2C\uDD30-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAE\uDEC0-\uDEF9]|\uD839[\uDCD0-\uDCF9\uDDD0-\uDDFA\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4B\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF]|\uDB40[\uDD00-\uDDEF])*$/;function g(e,t){var i;if(t.some((function(t){return i=n.resolveInclude(e,t,!0),r.existsSync(i)})))return i}function v(e,t){var i,s,a=t.views,o=/^[A-Za-z]+:\\|^\//.exec(e);if(o&&o.length)e=e.replace(/^\/*/,""),i=Array.isArray(t.root)?g(e,t.root):n.resolveInclude(e,t.root||"/",!0);else if(t.filename&&(s=n.resolveInclude(e,t.filename),r.existsSync(s)&&(i=s)),!i&&Array.isArray(a)&&(i=g(e,a)),!i&&"function"!=typeof t.includer)throw new Error('Could not find the include file "'+t.escapeFunction(e)+'"');return i}function b(e,t){var r,i=e.filename,s=arguments.length>1;if(e.cache){if(!i)throw new Error("cache option requires a filename");if(r=n.cache.get(i))return r;s||(t=y(i).toString().replace(_,""))}else if(!s){if(!i)throw new Error("Internal EJS error: no file name or template provided");t=y(i).toString().replace(_,"")}return r=n.compile(t,e),e.cache&&n.cache.set(i,r),r}function E(e,t,r){var i;if(!r){if("function"==typeof n.promiseImpl)return new n.promiseImpl((function(n,r){try{n(i=b(e)(t))}catch(e){r(e)}}));throw new Error("Please provide a callback function")}try{i=b(e)(t)}catch(e){return r(e)}r(null,i)}function y(e){return n.fileLoader(e)}function x(e,t){var n=s.shallowCopy(s.createNullProtoObjWherePossible(),t);if(n.filename=v(e,n),"function"==typeof t.includer){var r=t.includer(e,n.filename);if(r&&(r.filename&&(n.filename=r.filename),r.template))return b(n,r.template)}return b(n)}function A(e,t,n,r,i){var s=t.split("\n"),a=Math.max(r-3,0),o=Math.min(s.length,r+3),u=i(n),c=s.slice(a,o).map((function(e,t){var n=t+a+1;return(n==r?" >> ":"    ")+n+"| "+e})).join("\n");throw e.path=u,e.message=(u||"ejs")+":"+r+"\n"+c+"\n\n"+e.message,e}function C(e){return e.replace(/;(\s*$)/,"$1")}function w(e,t){var r=s.hasOwnOnlyObject(t),i=s.createNullProtoObjWherePossible();this.templateText=e,this.mode=null,this.truncate=!1,this.currentLine=1,this.source="",i.client=r.client||!1,i.escapeFunction=r.escape||r.escapeFunction||s.escapeXML,i.compileDebug=!1!==r.compileDebug,i.debug=!!r.debug,i.filename=r.filename,i.openDelimiter=r.openDelimiter||n.openDelimiter||u,i.closeDelimiter=r.closeDelimiter||n.closeDelimiter||c,i.delimiter=r.delimiter||n.delimiter||l,i.strict=r.strict||!1,i.context=r.context,i.cache=r.cache||!1,i.rmWhitespace=r.rmWhitespace,i.root=r.root,i.includer=r.includer,i.outputFunctionName=r.outputFunctionName,i.localsName=r.localsName||n.localsName||p,i.views=r.views,i.async=r.async,i.destructuredLocals=r.destructuredLocals,i.legacyInclude=void 0===r.legacyInclude||!!r.legacyInclude,i.strict?i._with=!1:i._with=void 0===r._with||r._with,this.opts=i,this.regex=this.createRegex()}n.cache=s.cache,n.fileLoader=r.readFileSync,n.localsName=p,n.promiseImpl=new Function("return this;")().Promise,n.resolveInclude=function(e,t,n){var r=i.dirname,s=i.extname,a=(0,i.resolve)(n?t:r(t),e);return s(e)||(a+=".ejs"),a},n.compile=function(e,t){return t&&t.scope&&(a||(console.warn("`scope` option is deprecated and will be removed in EJS 3"),a=!0),t.context||(t.context=t.scope),delete t.scope),new w(e,t).compile()},n.render=function(e,t,n){var r=t||s.createNullProtoObjWherePossible(),i=n||s.createNullProtoObjWherePossible();return 2==arguments.length&&s.shallowCopyFromList(i,r,f),b(i,e)(r)},n.renderFile=function(){var e,t,n,r=Array.prototype.slice.call(arguments),i=r.shift(),a={filename:i};return"function"==typeof arguments[arguments.length-1]&&(e=r.pop()),r.length?(t=r.shift(),r.length?s.shallowCopy(a,r.pop()):(t.settings&&(t.settings.views&&(a.views=t.settings.views),t.settings["view cache"]&&(a.cache=!0),(n=t.settings["view options"])&&s.shallowCopy(a,n)),s.shallowCopyFromList(a,t,m)),a.filename=i):t=s.createNullProtoObjWherePossible(),E(a,t,e)},n.Template=w,n.clearCache=function(){n.cache.reset()},w.modes={EVAL:"eval",ESCAPED:"escaped",RAW:"raw",COMMENT:"comment",LITERAL:"literal"},w.prototype={createRegex:function(){var e=d,t=s.escapeRegExpChars(this.opts.delimiter),n=s.escapeRegExpChars(this.opts.openDelimiter),r=s.escapeRegExpChars(this.opts.closeDelimiter);return e=e.replace(/%/g,t).replace(/</g,n).replace(/>/g,r),new RegExp(e)},compile:function(){var e,t,n,r=this.opts,a="",o="",u=r.escapeFunction,c=r.filename?JSON.stringify(r.filename):"undefined";if(!this.source){if(this.generateSource(),a+='  var __output = "";\n  function __append(...args) { args.filter(x => x !== undefined && x !== null).forEach(s => __output += s) }\n',r.outputFunctionName){if(!D.test(r.outputFunctionName))throw new Error("outputFunctionName is not a valid JS identifier.");a+="  const "+r.outputFunctionName+" = __append;\n"}if(r.localsName&&!D.test(r.localsName))throw new Error("localsName is not a valid JS identifier.");if(r.destructuredLocals&&r.destructuredLocals.length){for(var l=" {\n  const __locals = ("+r.localsName+" || {}),\n  ",p=0;p<r.destructuredLocals.length;p++){var h=r.destructuredLocals[p];if(!D.test(h))throw new Error("destructuredLocals["+p+"] is not a valid JS identifier.");p>0&&(l+=",\n  "),l+=h+" = __locals."+h}a+=l+";\n"}!1!==r._with&&(a+="  with ("+r.localsName+" || {}) "),a+=" {\n",o+="  }\n",r.destructuredLocals&&r.destructuredLocals.length&&(o+="  }\n"),o+="  return __output;\n",this.source=a+this.source+o}e=r.compileDebug?"var __line = 1\n  , __lines = "+JSON.stringify(this.templateText)+"\n  , __filename = "+c+";\ntry {\n"+this.source+"} catch (e) {\n  rethrow(e, __lines, __filename, __line, escapeFn);\n}\n":this.source,r.client&&(e="escapeFn = escapeFn || "+u.toString()+";\n"+e,r.compileDebug&&(e="rethrow = rethrow || "+A.toString()+";\n"+e)),r.strict&&(e='"use strict";\n'+e),r.debug&&console.log(e),r.compileDebug&&r.filename&&(e=e+"\n//# sourceURL="+c+"\n");try{if(r.async)try{n=new Function("return (async function(){}).constructor;")()}catch(e){throw e instanceof SyntaxError?new Error("This environment does not support async/await"):e}else n=Function;t=new n(r.localsName+", escapeFn, include, rethrow",e)}catch(t){throw t.src=e,t instanceof SyntaxError&&(r.filename&&(t.message+=" in "+r.filename),t.message+=" while compiling ejs\n\n"),t}var d=r.client?t:function(e){var n=function(t,n){var i=s.shallowCopy(s.createNullProtoObjWherePossible(),e);return n&&(i=s.shallowCopy(i,n)),x(t,r)(i)};return t.apply(r.context,[e||s.createNullProtoObjWherePossible(),u,n,A])};if(r.filename&&"function"==typeof Object.defineProperty){var f=r.filename,m=i.basename(f,i.extname(f));try{Object.defineProperty(d,"name",{value:m,writable:!1,enumerable:!1,configurable:!0})}catch(e){}}return d},generateSource:function(){var e=this.opts,t=this.opts.delimiter,n=this.opts.openDelimiter,r=this.opts.closeDelimiter;e.rmWhitespace&&(this.templateText=this.templateText.replace(/[\r\n]+/g,"\n").replace(/^\s+|\s+$/gm,"")),this.templateText=this.templateText.replace(/[ \t]*<%_/gm,"<%_").replace(/_%>[ \t]*/gm,"_%>");for(var i=this.parseTemplateText(),s=[],a=0;a<i.length;){var o=i[a];if(o.startsWith(n+t)&&o!==n+t+t){for(var u=1,c=[],l=a+1;l<i.length;){var p=i[l];if(p.startsWith(n+t)&&p!==n+t+t)u++;else if(p.endsWith(t+r)&&p!==t+t+r&&0==--u){s.push(o),s.push(c.join("")),s.push(p),a=l;break}c.push(p),l++}if(0!==u)throw new Error('Could not find matching close tag for "'+o+'".')}else s.push(o);a++}var h=this;s.length&&s.forEach((function(e){h.scanLine(e)}))},parseTemplateText:function(){for(var e,t=this.templateText,n=this.regex,r=n.exec(t),i=[];r;)0!==(e=r.index)&&(i.push(t.substring(0,e)),t=t.slice(e)),i.push(r[0]),t=t.slice(r[0].length),r=n.exec(t);return t&&i.push(t),i},_addOutput:function(e){if(this.truncate&&(e=e.replace(/^(?:\r\n|\r|\n)/,""),this.truncate=!1),!e)return e;e=(e=(e=(e=e.replace(/\\/g,"\\\\")).replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace(/"/g,'\\"'),this.source+='    ; __append("'+e+'")\n'},scanLine:function(e){var t=this,n=this.opts.delimiter,r=this.opts.openDelimiter,i=this.opts.closeDelimiter,s=0;switch(s=e.split("\n").length-1,e){case r+n:case r+n+"_":this.mode=w.modes.EVAL;break;case r+n+"=":this.mode=w.modes.ESCAPED;break;case r+n+"-":this.mode=w.modes.RAW;break;case r+n+"#":this.mode=w.modes.COMMENT;break;case r+n+n:this.mode=w.modes.LITERAL,this.source+='    ; __append("'+e.replace(r+n+n,r+n)+'")\n';break;case n+n+i:this.mode=w.modes.LITERAL,this.source+='    ; __append("'+e.replace(n+n+i,n+i)+'")\n';break;case n+i:case"-"+n+i:case"_"+n+i:this.mode==w.modes.LITERAL&&this._addOutput(e),this.mode=null,this.truncate=0===e.indexOf("-")||0===e.indexOf("_");break;default:if(this.mode){switch(this.mode){case w.modes.EVAL:case w.modes.ESCAPED:case w.modes.RAW:e.lastIndexOf("//")>e.lastIndexOf("\n")&&(e+="\n")}switch(this.mode){case w.modes.EVAL:this.source+="    ; "+e+"\n";break;case w.modes.ESCAPED:this.source+="    ; __append(escapeFn("+C(e)+"))\n";break;case w.modes.RAW:this.source+="    ; __append("+C(e)+")\n";break;case w.modes.COMMENT:break;case w.modes.LITERAL:this._addOutput(e)}}else this._addOutput(e)}t.opts.compileDebug&&s&&(this.currentLine+=s,this.source+="    ; __line = "+this.currentLine+"\n")}},n.escapeXML=s.escapeXML,n.__express=n.renderFile,n.VERSION=o,n.name=h,"undefined"!=typeof window&&(window.ejs=n)},{"../package.json":6,"./utils":2,fs:3,path:4}],2:[function(e,t,n){var r=/[|\\{}()[\]^$+*?.]/g,i=Object.prototype.hasOwnProperty,s=function(e,t){return i.apply(e,[t])};n.escapeRegExpChars=function(e){return e?String(e).replace(r,"\\$&"):""};var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},o=/[&<>'"]/g;function u(e){return a[e]||e}var c='var _ENCODE_HTML_RULES = {\n      "&": "&amp;"\n    , "<": "&lt;"\n    , ">": "&gt;"\n    , \'"\': "&#34;"\n    , "\'": "&#39;"\n    }\n  , _MATCH_HTML = /[&<>\'"]/g;\nfunction encode_char(c) {\n  return _ENCODE_HTML_RULES[c] || c;\n};\n';function l(){return Function.prototype.toString.call(this)+";\n"+c}n.escapeXML=function(e){return null==e?"":String(e).replace(o,u)};try{"function"==typeof Object.defineProperty?Object.defineProperty(n.escapeXML,"toString",{value:l}):n.escapeXML.toString=l}catch(e){console.warn("Unable to set escapeXML.toString (is the Function prototype frozen?)")}n.shallowCopy=function(e,t){if(t=t||{},null!=e)for(var n in t)s(t,n)&&"__proto__"!==n&&"constructor"!==n&&(e[n]=t[n]);return e},n.shallowCopyFromList=function(e,t,n){if(n=n||[],t=t||{},null!=e)for(var r=0;r<n.length;r++){var i=n[r];if(void 0!==t[i]){if(!s(t,i))continue;if("__proto__"===i||"constructor"===i)continue;e[i]=t[i]}}return e},n.cache={_data:new Map,_capacity:64,set:function(e,t){for(this._data.has(e)&&this._data.delete(e),this._data.set(e,t);this._capacity>0&&this._data.size>this._capacity;){const e=this._data.keys().next().value;this._data.delete(e)}},get:function(e){if(!this._data.has(e))return;const t=this._data.get(e);return this._data.delete(e),this._data.set(e,t),t},remove:function(e){this._data.delete(e)},reset:function(){this._data.clear()}},n.hyphenToCamel=function(e){return e.replace(/-[a-z]/g,(function(e){return e[1].toUpperCase()}))},n.createNullProtoObjWherePossible="function"==typeof Object.create?function(){return Object.create(null)}:{__proto__:null}instanceof Object?function(){return{}}:function(){return{__proto__:null}},n.hasOwnOnlyObject=function(e){var t=n.createNullProtoObjWherePossible();for(var r in e)s(e,r)&&(t[r]=e[r]);return t}},{}],3:[function(e,t,n){},{}],4:[function(e,t,n){(function(e){function t(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function r(e){"string"!=typeof e&&(e+="");var t,n=0,r=-1,i=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!i){n=t+1;break}}else-1===r&&(i=!1,r=t+1);return-1===r?"":e.slice(n,r)}function i(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}n.resolve=function(){for(var n="",r=!1,s=arguments.length-1;s>=-1&&!r;s--){var a=s>=0?arguments[s]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(n=a+"/"+n,r="/"===a.charAt(0))}return(r?"/":"")+(n=t(i(n.split("/"),(function(e){return!!e})),!r).join("/"))||"."},n.normalize=function(e){var r=n.isAbsolute(e),a="/"===s(e,-1);return(e=t(i(e.split("/"),(function(e){return!!e})),!r).join("/"))||r||(e="."),e&&a&&(e+="/"),(r?"/":"")+e},n.isAbsolute=function(e){return"/"===e.charAt(0)},n.join=function(){var e=Array.prototype.slice.call(arguments,0);return n.normalize(i(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},n.relative=function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=n.resolve(e).substr(1),t=n.resolve(t).substr(1);for(var i=r(e.split("/")),s=r(t.split("/")),a=Math.min(i.length,s.length),o=a,u=0;u<a;u++)if(i[u]!==s[u]){o=u;break}var c=[];for(u=o;u<i.length;u++)c.push("..");return(c=c.concat(s.slice(o))).join("/")},n.sep="/",n.delimiter=":",n.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,r=-1,i=!0,s=e.length-1;s>=1;--s)if(47===(t=e.charCodeAt(s))){if(!i){r=s;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":e.slice(0,r)},n.basename=function(e,t){var n=r(e);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},n.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,n=0,r=-1,i=!0,s=0,a=e.length-1;a>=0;--a){var o=e.charCodeAt(a);if(47!==o)-1===r&&(i=!1,r=a+1),46===o?-1===t?t=a:1!==s&&(s=1):-1!==t&&(s=-1);else if(!i){n=a+1;break}}return-1===t||-1===r||0===s||1===s&&t===r-1&&t===n+1?"":e.slice(t,r)};var s=function(e,t,n){return e.substr(t,n)}}).call(this,e("_process"))},{_process:5}],5:[function(e,t,n){var r,i,s=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function u(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}function c(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{return i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var l,p=[],h=!1,d=-1;function f(){h&&l&&(h=!1,l.length?p=l.concat(p):d=-1,p.length&&m())}function m(){if(!h){var e=u(f);h=!0;for(var t=p.length;t;){for(l=p,p=[];++d<t;)l&&l[d].run();d=-1,t=p.length}l=null,h=!1,c(e)}}function _(e,t){this.fun=e,this.array=t}function D(){}s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new _(e,t)),1!==p.length||h||u(m)},_.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=D,s.addListener=D,s.once=D,s.off=D,s.removeListener=D,s.removeAllListeners=D,s.emit=D,s.prependListener=D,s.prependOnceListener=D,s.listeners=function(e){return[]},s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],6:[function(e,t,n){t.exports={name:"ejs",description:"Embedded JavaScript templates",keywords:["template","engine","ejs"],version:"3.1.9",author:"Matthew Eernisse <mde@fleegix.org> (http://fleegix.org)",license:"Apache-2.0",bin:{ejs:"./bin/cli.js"},main:"./lib/ejs.js",jsdelivr:"ejs.min.js",unpkg:"ejs.min.js",repository:{type:"git",url:"git://github.com/mde/ejs.git"},bugs:"https://github.com/mde/ejs/issues",homepage:"https://github.com/mde/ejs",dependencies:{jake:"^10.8.5"},devDependencies:{browserify:"^16.5.1",eslint:"^6.8.0","git-directory-deploy":"^1.5.1",jsdoc:"^4.0.2","lru-cache":"^4.0.1",mocha:"^10.2.0","uglify-js":"^3.3.16"},engines:{node:">=0.10.0"},scripts:{test:"npx jake test"}}},{}]},{},[1])(1)},5233:(module,__unused_webpack_exports,__webpack_require__)=>{var aparse=__webpack_require__(7921).parse;function parse(e,t){return t||(t={}),aparse(e,t)}function errorInfo(e,t,n){try{parse(e,n)}catch(n){return new ParseError(n,e,t)}}function ParseError(e,t,n){SyntaxError.call(this),this.message=e.message.replace(/\s+\(\d+:\d+\)$/,""),this.line=e.loc.line,this.column=e.loc.column+1,this.annotated="\n"+(n||"(anonymous file)")+":"+this.line+"\n"+t.split("\n")[this.line-1]+"\n"+Array(this.column).join(" ")+"^\nParseError: "+this.message}module.exports=function(src,file,opts){"string"!=typeof src&&(src=String(src));try{return void eval('throw "STOP"; (function () { '+src+"\n})()")}catch(e){if("STOP"===e)return;return"SyntaxError"!==e.constructor.name?e:errorInfo(src,file,opts)}},ParseError.prototype=Object.create(SyntaxError.prototype),ParseError.prototype.toString=function(){return this.annotated},ParseError.prototype.inspect=function(){return this.annotated}},7510:e=>{e.exports=function(){for(var e={},n=0;n<arguments.length;n++){var r=arguments[n];for(var i in r)t.call(r,i)&&(e[i]=r[i])}return e};var t=Object.prototype.hasOwnProperty},2395:e=>{e.exports=__WEBPACK_EXTERNAL_MODULE__libs_faker_mjs_f3becd00__},9306:(e,t,n)=>{var r=n(4901),i=n(6823),s=TypeError;e.exports=function(e){if(r(e))return e;throw new s(i(e)+" is not a function")}},3506:(e,t,n)=>{var r=n(3925),i=String,s=TypeError;e.exports=function(e){if(r(e))return e;throw new s("Can't set "+i(e)+" as a prototype")}},6469:(e,t,n)=>{var r=n(8227),i=n(2360),s=n(4913).f,a=r("unscopables"),o=Array.prototype;void 0===o[a]&&s(o,a,{configurable:!0,value:i(null)}),e.exports=function(e){o[a][e]=!0}},7829:(e,t,n)=>{var r=n(8183).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},8551:(e,t,n)=>{var r=n(34),i=String,s=TypeError;e.exports=function(e){if(r(e))return e;throw new s(i(e)+" is not an object")}},9617:(e,t,n)=>{var r=n(5397),i=n(5610),s=n(6198),a=function(e){return function(t,n,a){var o=r(t),u=s(o);if(0===u)return!e&&-1;var c,l=i(a,u);if(e&&n!=n){for(;u>l;)if((c=o[l++])!=c)return!0}else for(;u>l;l++)if((e||l in o)&&o[l]===n)return e||l||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},4598:(e,t,n)=>{var r=n(9039);e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){return 1},1)}))}},7680:(e,t,n)=>{var r=n(9504);e.exports=r([].slice)},4488:(e,t,n)=>{var r=n(7680),i=Math.floor,s=function(e,t){var n=e.length;if(n<8)for(var a,o,u=1;u<n;){for(o=u,a=e[u];o&&t(e[o-1],a)>0;)e[o]=e[--o];o!==u++&&(e[o]=a)}else for(var c=i(n/2),l=s(r(e,0,c),t),p=s(r(e,c),t),h=l.length,d=p.length,f=0,m=0;f<h||m<d;)e[f+m]=f<h&&m<d?t(l[f],p[m])<=0?l[f++]:p[m++]:f<h?l[f++]:p[m++];return e};e.exports=s},2195:(e,t,n)=>{var r=n(9504),i=r({}.toString),s=r("".slice);e.exports=function(e){return s(i(e),8,-1)}},6955:(e,t,n)=>{var r=n(2140),i=n(4901),s=n(2195),a=n(8227)("toStringTag"),o=Object,u="Arguments"===s(function(){return arguments}());e.exports=r?s:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=o(e),a))?n:u?s(t):"Object"===(r=s(t))&&i(t.callee)?"Arguments":r}},7740:(e,t,n)=>{var r=n(9297),i=n(5031),s=n(7347),a=n(4913);e.exports=function(e,t,n){for(var o=i(t),u=a.f,c=s.f,l=0;l<o.length;l++){var p=o[l];r(e,p)||n&&r(n,p)||u(e,p,c(t,p))}}},2211:(e,t,n)=>{var r=n(9039);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},2529:e=>{e.exports=function(e,t){return{value:e,done:t}}},6699:(e,t,n)=>{var r=n(3724),i=n(4913),s=n(6980);e.exports=r?function(e,t,n){return i.f(e,t,s(1,n))}:function(e,t,n){return e[t]=n,e}},6980:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},2106:(e,t,n)=>{var r=n(283),i=n(4913);e.exports=function(e,t,n){return n.get&&r(n.get,t,{getter:!0}),n.set&&r(n.set,t,{setter:!0}),i.f(e,t,n)}},6840:(e,t,n)=>{var r=n(4901),i=n(4913),s=n(283),a=n(9433);e.exports=function(e,t,n,o){o||(o={});var u=o.enumerable,c=void 0!==o.name?o.name:t;if(r(n)&&s(n,c,o),o.global)u?e[t]=n:a(t,n);else{try{o.unsafe?e[t]&&(u=!0):delete e[t]}catch(e){}u?e[t]=n:i.f(e,t,{value:n,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return e}},9433:(e,t,n)=>{var r=n(4576),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},4606:(e,t,n)=>{var r=n(6823),i=TypeError;e.exports=function(e,t){if(!delete e[t])throw new i("Cannot delete property "+r(t)+" of "+r(e))}},3724:(e,t,n)=>{var r=n(9039);e.exports=!r((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4055:(e,t,n)=>{var r=n(4576),i=n(34),s=r.document,a=i(s)&&i(s.createElement);e.exports=function(e){return a?s.createElement(e):{}}},7400:e=>{e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},9296:(e,t,n)=>{var r=n(4055)("span").classList,i=r&&r.constructor&&r.constructor.prototype;e.exports=i===Object.prototype?void 0:i},8727:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},3709:(e,t,n)=>{var r=n(2839).match(/firefox\/(\d+)/i);e.exports=!!r&&+r[1]},3763:(e,t,n)=>{var r=n(2839);e.exports=/MSIE|Trident/.test(r)},2839:(e,t,n)=>{var r=n(4576).navigator,i=r&&r.userAgent;e.exports=i?String(i):""},9519:(e,t,n)=>{var r,i,s=n(4576),a=n(2839),o=s.process,u=s.Deno,c=o&&o.versions||u&&u.version,l=c&&c.v8;l&&(i=(r=l.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},3607:(e,t,n)=>{var r=n(2839).match(/AppleWebKit\/(\d+)\./);e.exports=!!r&&+r[1]},6518:(e,t,n)=>{var r=n(4576),i=n(7347).f,s=n(6699),a=n(6840),o=n(9433),u=n(7740),c=n(2796);e.exports=function(e,t){var n,l,p,h,d,f=e.target,m=e.global,_=e.stat;if(n=m?r:_?r[f]||o(f,{}):r[f]&&r[f].prototype)for(l in t){if(h=t[l],p=e.dontCallGetSet?(d=i(n,l))&&d.value:n[l],!c(m?l:f+(_?".":"#")+l,e.forced)&&void 0!==p){if(typeof h==typeof p)continue;u(h,p)}(e.sham||p&&p.sham)&&s(h,"sham",!0),a(n,l,h,e)}}},9039:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},9228:(e,t,n)=>{n(7495);var r=n(9565),i=n(6840),s=n(7323),a=n(9039),o=n(8227),u=n(6699),c=o("species"),l=RegExp.prototype;e.exports=function(e,t,n,p){var h=o(e),d=!a((function(){var t={};return t[h]=function(){return 7},7!==""[e](t)})),f=d&&!a((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[c]=function(){return n},n.flags="",n[h]=/./[h]),n.exec=function(){return t=!0,null},n[h](""),!t}));if(!d||!f||n){var m=/./[h],_=t(h,""[e],(function(e,t,n,i,a){var o=t.exec;return o===s||o===l.exec?d&&!a?{done:!0,value:r(m,t,n,i)}:{done:!0,value:r(e,n,t,i)}:{done:!1}}));i(String.prototype,e,_[0]),i(l,h,_[1])}p&&u(l[h],"sham",!0)}},8745:(e,t,n)=>{var r=n(616),i=Function.prototype,s=i.apply,a=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?a.bind(s):function(){return a.apply(s,arguments)})},616:(e,t,n)=>{var r=n(9039);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},9565:(e,t,n)=>{var r=n(616),i=Function.prototype.call;e.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},350:(e,t,n)=>{var r=n(3724),i=n(9297),s=Function.prototype,a=r&&Object.getOwnPropertyDescriptor,o=i(s,"name"),u=o&&"something"===function(){}.name,c=o&&(!r||r&&a(s,"name").configurable);e.exports={EXISTS:o,PROPER:u,CONFIGURABLE:c}},6706:(e,t,n)=>{var r=n(9504),i=n(9306);e.exports=function(e,t,n){try{return r(i(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(e){}}},9504:(e,t,n)=>{var r=n(616),i=Function.prototype,s=i.call,a=r&&i.bind.bind(s,s);e.exports=r?a:function(e){return function(){return s.apply(e,arguments)}}},7751:(e,t,n)=>{var r=n(4576),i=n(4901);e.exports=function(e,t){return arguments.length<2?(n=r[e],i(n)?n:void 0):r[e]&&r[e][t];var n}},5966:(e,t,n)=>{var r=n(9306),i=n(4117);e.exports=function(e,t){var n=e[t];return i(n)?void 0:r(n)}},2478:(e,t,n)=>{var r=n(9504),i=n(8981),s=Math.floor,a=r("".charAt),o=r("".replace),u=r("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,l=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,r,p,h){var d=n+e.length,f=r.length,m=l;return void 0!==p&&(p=i(p),m=c),o(h,m,(function(i,o){var c;switch(a(o,0)){case"$":return"$";case"&":return e;case"`":return u(t,0,n);case"'":return u(t,d);case"<":c=p[u(o,1,-1)];break;default:var l=+o;if(0===l)return i;if(l>f){var h=s(l/10);return 0===h?i:h<=f?void 0===r[h-1]?a(o,1):r[h-1]+a(o,1):i}c=r[l-1]}return void 0===c?"":c}))}},4576:function(e,t,n){var r=function(e){return e&&e.Math===Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},9297:(e,t,n)=>{var r=n(9504),i=n(8981),s=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return s(i(e),t)}},421:e=>{e.exports={}},397:(e,t,n)=>{var r=n(7751);e.exports=r("document","documentElement")},5917:(e,t,n)=>{var r=n(3724),i=n(9039),s=n(4055);e.exports=!r&&!i((function(){return 7!==Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},7055:(e,t,n)=>{var r=n(9504),i=n(9039),s=n(2195),a=Object,o=r("".split);e.exports=i((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"===s(e)?o(e,""):a(e)}:a},3167:(e,t,n)=>{var r=n(4901),i=n(34),s=n(2967);e.exports=function(e,t,n){var a,o;return s&&r(a=t.constructor)&&a!==n&&i(o=a.prototype)&&o!==n.prototype&&s(e,o),e}},3706:(e,t,n)=>{var r=n(9504),i=n(4901),s=n(7629),a=r(Function.toString);i(s.inspectSource)||(s.inspectSource=function(e){return a(e)}),e.exports=s.inspectSource},1181:(e,t,n)=>{var r,i,s,a=n(8622),o=n(4576),u=n(34),c=n(6699),l=n(9297),p=n(7629),h=n(6119),d=n(421),f="Object already initialized",m=o.TypeError,_=o.WeakMap;if(a||p.state){var D=p.state||(p.state=new _);D.get=D.get,D.has=D.has,D.set=D.set,r=function(e,t){if(D.has(e))throw new m(f);return t.facade=e,D.set(e,t),t},i=function(e){return D.get(e)||{}},s=function(e){return D.has(e)}}else{var g=h("state");d[g]=!0,r=function(e,t){if(l(e,g))throw new m(f);return t.facade=e,c(e,g,t),t},i=function(e){return l(e,g)?e[g]:{}},s=function(e){return l(e,g)}}e.exports={set:r,get:i,has:s,enforce:function(e){return s(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!u(t)||(n=i(t)).type!==e)throw new m("Incompatible receiver, "+e+" required");return n}}}},4901:e=>{var t="object"==typeof document&&document.all;e.exports=void 0===t&&void 0!==t?function(e){return"function"==typeof e||e===t}:function(e){return"function"==typeof e}},2796:(e,t,n)=>{var r=n(9039),i=n(4901),s=/#|\.prototype\./,a=function(e,t){var n=u[o(e)];return n===l||n!==c&&(i(t)?r(t):!!t)},o=a.normalize=function(e){return String(e).replace(s,".").toLowerCase()},u=a.data={},c=a.NATIVE="N",l=a.POLYFILL="P";e.exports=a},4117:e=>{e.exports=function(e){return null==e}},34:(e,t,n)=>{var r=n(4901);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},3925:(e,t,n)=>{var r=n(34);e.exports=function(e){return r(e)||null===e}},6395:e=>{e.exports=!1},788:(e,t,n)=>{var r=n(34),i=n(2195),s=n(8227)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[s])?!!t:"RegExp"===i(e))}},757:(e,t,n)=>{var r=n(7751),i=n(4901),s=n(1625),a=n(7040),o=Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return i(t)&&s(t.prototype,o(e))}},3994:(e,t,n)=>{var r=n(7657).IteratorPrototype,i=n(2360),s=n(6980),a=n(687),o=n(6269),u=function(){return this};e.exports=function(e,t,n,c){var l=t+" Iterator";return e.prototype=i(r,{next:s(+!c,n)}),a(e,l,!1,!0),o[l]=u,e}},1088:(e,t,n)=>{var r=n(6518),i=n(9565),s=n(6395),a=n(350),o=n(4901),u=n(3994),c=n(2787),l=n(2967),p=n(687),h=n(6699),d=n(6840),f=n(8227),m=n(6269),_=n(7657),D=a.PROPER,g=a.CONFIGURABLE,v=_.IteratorPrototype,b=_.BUGGY_SAFARI_ITERATORS,E=f("iterator"),y="keys",x="values",A="entries",C=function(){return this};e.exports=function(e,t,n,a,f,_,w){u(n,t,a);var F,S,k,P=function(e){if(e===f&&I)return I;if(!b&&e&&e in O)return O[e];switch(e){case y:case x:case A:return function(){return new n(this,e)}}return function(){return new n(this)}},T=t+" Iterator",B=!1,O=e.prototype,N=O[E]||O["@@iterator"]||f&&O[f],I=!b&&N||P(f),L="Array"===t&&O.entries||N;if(L&&(F=c(L.call(new e)))!==Object.prototype&&F.next&&(s||c(F)===v||(l?l(F,v):o(F[E])||d(F,E,C)),p(F,T,!0,!0),s&&(m[T]=C)),D&&f===x&&N&&N.name!==x&&(!s&&g?h(O,"name",x):(B=!0,I=function(){return i(N,this)})),f)if(S={values:P(x),keys:_?I:P(y),entries:P(A)},w)for(k in S)(b||B||!(k in O))&&d(O,k,S[k]);else r({target:t,proto:!0,forced:b||B},S);return s&&!w||O[E]===I||d(O,E,I,{name:f}),m[t]=I,S}},7657:(e,t,n)=>{var r,i,s,a=n(9039),o=n(4901),u=n(34),c=n(2360),l=n(2787),p=n(6840),h=n(8227),d=n(6395),f=h("iterator"),m=!1;[].keys&&("next"in(s=[].keys())?(i=l(l(s)))!==Object.prototype&&(r=i):m=!0),!u(r)||a((function(){var e={};return r[f].call(e)!==e}))?r={}:d&&(r=c(r)),o(r[f])||p(r,f,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:m}},6269:e=>{e.exports={}},6198:(e,t,n)=>{var r=n(8014);e.exports=function(e){return r(e.length)}},283:(e,t,n)=>{var r=n(9504),i=n(9039),s=n(4901),a=n(9297),o=n(3724),u=n(350).CONFIGURABLE,c=n(3706),l=n(1181),p=l.enforce,h=l.get,d=String,f=Object.defineProperty,m=r("".slice),_=r("".replace),D=r([].join),g=o&&!i((function(){return 8!==f((function(){}),"length",{value:8}).length})),v=String(String).split("String"),b=e.exports=function(e,t,n){"Symbol("===m(d(t),0,7)&&(t="["+_(d(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!a(e,"name")||u&&e.name!==t)&&(o?f(e,"name",{value:t,configurable:!0}):e.name=t),g&&n&&a(n,"arity")&&e.length!==n.arity&&f(e,"length",{value:n.arity});try{n&&a(n,"constructor")&&n.constructor?o&&f(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=p(e);return a(r,"source")||(r.source=D(v,"string"==typeof t?t:"")),e};Function.prototype.toString=b((function(){return s(this)&&h(this).source||c(this)}),"toString")},741:e=>{var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},2360:(e,t,n)=>{var r,i=n(8551),s=n(6801),a=n(8727),o=n(421),u=n(397),c=n(4055),l=n(6119),p="prototype",h="script",d=l("IE_PROTO"),f=function(){},m=function(e){return"<"+h+">"+e+"</"+h+">"},_=function(e){e.write(m("")),e.close();var t=e.parentWindow.Object;return e=null,t},D=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}var e,t,n;D="undefined"!=typeof document?document.domain&&r?_(r):(t=c("iframe"),n="java"+h+":",t.style.display="none",u.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(m("document.F=Object")),e.close(),e.F):_(r);for(var i=a.length;i--;)delete D[p][a[i]];return D()};o[d]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(f[p]=i(e),n=new f,f[p]=null,n[d]=e):n=D(),void 0===t?n:s.f(n,t)}},6801:(e,t,n)=>{var r=n(3724),i=n(8686),s=n(4913),a=n(8551),o=n(5397),u=n(1072);t.f=r&&!i?Object.defineProperties:function(e,t){a(e);for(var n,r=o(t),i=u(t),c=i.length,l=0;c>l;)s.f(e,n=i[l++],r[n]);return e}},4913:(e,t,n)=>{var r=n(3724),i=n(5917),s=n(8686),a=n(8551),o=n(6969),u=TypeError,c=Object.defineProperty,l=Object.getOwnPropertyDescriptor,p="enumerable",h="configurable",d="writable";t.f=r?s?function(e,t,n){if(a(e),t=o(t),a(n),"function"==typeof e&&"prototype"===t&&"value"in n&&d in n&&!n[d]){var r=l(e,t);r&&r[d]&&(e[t]=n.value,n={configurable:h in n?n[h]:r[h],enumerable:p in n?n[p]:r[p],writable:!1})}return c(e,t,n)}:c:function(e,t,n){if(a(e),t=o(t),a(n),i)try{return c(e,t,n)}catch(e){}if("get"in n||"set"in n)throw new u("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},7347:(e,t,n)=>{var r=n(3724),i=n(9565),s=n(8773),a=n(6980),o=n(5397),u=n(6969),c=n(9297),l=n(5917),p=Object.getOwnPropertyDescriptor;t.f=r?p:function(e,t){if(e=o(e),t=u(t),l)try{return p(e,t)}catch(e){}if(c(e,t))return a(!i(s.f,e,t),e[t])}},8480:(e,t,n)=>{var r=n(1828),i=n(8727).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},3717:(e,t)=>{t.f=Object.getOwnPropertySymbols},2787:(e,t,n)=>{var r=n(9297),i=n(4901),s=n(8981),a=n(6119),o=n(2211),u=a("IE_PROTO"),c=Object,l=c.prototype;e.exports=o?c.getPrototypeOf:function(e){var t=s(e);if(r(t,u))return t[u];var n=t.constructor;return i(n)&&t instanceof n?n.prototype:t instanceof c?l:null}},1625:(e,t,n)=>{var r=n(9504);e.exports=r({}.isPrototypeOf)},1828:(e,t,n)=>{var r=n(9504),i=n(9297),s=n(5397),a=n(9617).indexOf,o=n(421),u=r([].push);e.exports=function(e,t){var n,r=s(e),c=0,l=[];for(n in r)!i(o,n)&&i(r,n)&&u(l,n);for(;t.length>c;)i(r,n=t[c++])&&(~a(l,n)||u(l,n));return l}},1072:(e,t,n)=>{var r=n(1828),i=n(8727);e.exports=Object.keys||function(e){return r(e,i)}},8773:(e,t)=>{var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},2967:(e,t,n)=>{var r=n(6706),i=n(34),s=n(7750),a=n(3506);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.prototype,"__proto__","set"))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return s(n),a(r),i(n)?(t?e(n,r):n.__proto__=r,n):n}}():void 0)},4270:(e,t,n)=>{var r=n(9565),i=n(4901),s=n(34),a=TypeError;e.exports=function(e,t){var n,o;if("string"===t&&i(n=e.toString)&&!s(o=r(n,e)))return o;if(i(n=e.valueOf)&&!s(o=r(n,e)))return o;if("string"!==t&&i(n=e.toString)&&!s(o=r(n,e)))return o;throw new a("Can't convert object to primitive value")}},5031:(e,t,n)=>{var r=n(7751),i=n(9504),s=n(8480),a=n(3717),o=n(8551),u=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=s.f(o(e)),n=a.f;return n?u(t,n(e)):t}},1056:(e,t,n)=>{var r=n(4913).f;e.exports=function(e,t,n){n in e||r(e,n,{configurable:!0,get:function(){return t[n]},set:function(e){t[n]=e}})}},6682:(e,t,n)=>{var r=n(9565),i=n(8551),s=n(4901),a=n(2195),o=n(7323),u=TypeError;e.exports=function(e,t){var n=e.exec;if(s(n)){var c=r(n,e,t);return null!==c&&i(c),c}if("RegExp"===a(e))return r(o,e,t);throw new u("RegExp#exec called on incompatible receiver")}},7323:(e,t,n)=>{var r,i,s=n(9565),a=n(9504),o=n(655),u=n(7979),c=n(8429),l=n(5745),p=n(2360),h=n(1181).get,d=n(3635),f=n(8814),m=l("native-string-replace",String.prototype.replace),_=RegExp.prototype.exec,D=_,g=a("".charAt),v=a("".indexOf),b=a("".replace),E=a("".slice),y=(i=/b*/g,s(_,r=/a/,"a"),s(_,i,"a"),0!==r.lastIndex||0!==i.lastIndex),x=c.BROKEN_CARET,A=void 0!==/()??/.exec("")[1];(y||A||x||d||f)&&(D=function(e){var t,n,r,i,a,c,l,d=this,f=h(d),C=o(e),w=f.raw;if(w)return w.lastIndex=d.lastIndex,t=s(D,w,C),d.lastIndex=w.lastIndex,t;var F=f.groups,S=x&&d.sticky,k=s(u,d),P=d.source,T=0,B=C;if(S&&(k=b(k,"y",""),-1===v(k,"g")&&(k+="g"),B=E(C,d.lastIndex),d.lastIndex>0&&(!d.multiline||d.multiline&&"\n"!==g(C,d.lastIndex-1))&&(P="(?: "+P+")",B=" "+B,T++),n=new RegExp("^(?:"+P+")",k)),A&&(n=new RegExp("^"+P+"$(?!\\s)",k)),y&&(r=d.lastIndex),i=s(_,S?n:d,B),S?i?(i.input=E(i.input,T),i[0]=E(i[0],T),i.index=d.lastIndex,d.lastIndex+=i[0].length):d.lastIndex=0:y&&i&&(d.lastIndex=d.global?i.index+i[0].length:r),A&&i&&i.length>1&&s(m,i[0],n,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(i[a]=void 0)})),i&&F)for(i.groups=c=p(null),a=0;a<F.length;a++)c[(l=F[a])[0]]=i[l[1]];return i}),e.exports=D},7979:(e,t,n)=>{var r=n(8551);e.exports=function(){var e=r(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t}},1034:(e,t,n)=>{var r=n(9565),i=n(9297),s=n(1625),a=n(7979),o=RegExp.prototype;e.exports=function(e){var t=e.flags;return void 0!==t||"flags"in o||i(e,"flags")||!s(o,e)?t:r(a,e)}},8429:(e,t,n)=>{var r=n(9039),i=n(4576).RegExp,s=r((function(){var e=i("a","y");return e.lastIndex=2,null!==e.exec("abcd")})),a=s||r((function(){return!i("a","y").sticky})),o=s||r((function(){var e=i("^r","gy");return e.lastIndex=2,null!==e.exec("str")}));e.exports={BROKEN_CARET:o,MISSED_STICKY:a,UNSUPPORTED_Y:s}},3635:(e,t,n)=>{var r=n(9039),i=n(4576).RegExp;e.exports=r((function(){var e=i(".","s");return!(e.dotAll&&e.test("\n")&&"s"===e.flags)}))},8814:(e,t,n)=>{var r=n(9039),i=n(4576).RegExp;e.exports=r((function(){var e=i("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},7750:(e,t,n)=>{var r=n(4117),i=TypeError;e.exports=function(e){if(r(e))throw new i("Can't call method on "+e);return e}},7633:(e,t,n)=>{var r=n(7751),i=n(2106),s=n(8227),a=n(3724),o=s("species");e.exports=function(e){var t=r(e);a&&t&&!t[o]&&i(t,o,{configurable:!0,get:function(){return this}})}},687:(e,t,n)=>{var r=n(4913).f,i=n(9297),s=n(8227)("toStringTag");e.exports=function(e,t,n){e&&!n&&(e=e.prototype),e&&!i(e,s)&&r(e,s,{configurable:!0,value:t})}},6119:(e,t,n)=>{var r=n(5745),i=n(3392),s=r("keys");e.exports=function(e){return s[e]||(s[e]=i(e))}},7629:(e,t,n)=>{var r=n(6395),i=n(4576),s=n(9433),a="__core-js_shared__",o=e.exports=i[a]||s(a,{});(o.versions||(o.versions=[])).push({version:"3.40.0",mode:r?"pure":"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.40.0/LICENSE",source:"https://github.com/zloirock/core-js"})},5745:(e,t,n)=>{var r=n(7629);e.exports=function(e,t){return r[e]||(r[e]=t||{})}},8183:(e,t,n)=>{var r=n(9504),i=n(1291),s=n(655),a=n(7750),o=r("".charAt),u=r("".charCodeAt),c=r("".slice),l=function(e){return function(t,n){var r,l,p=s(a(t)),h=i(n),d=p.length;return h<0||h>=d?e?"":void 0:(r=u(p,h))<55296||r>56319||h+1===d||(l=u(p,h+1))<56320||l>57343?e?o(p,h):r:e?c(p,h,h+2):l-56320+(r-55296<<10)+65536}};e.exports={codeAt:l(!1),charAt:l(!0)}},706:(e,t,n)=>{var r=n(350).PROPER,i=n(9039),s=n(7452);e.exports=function(e){return i((function(){return!!s[e]()||""!==""[e]()||r&&s[e].name!==e}))}},3802:(e,t,n)=>{var r=n(9504),i=n(7750),s=n(655),a=n(7452),o=r("".replace),u=RegExp("^["+a+"]+"),c=RegExp("(^|[^"+a+"])["+a+"]+$"),l=function(e){return function(t){var n=s(i(t));return 1&e&&(n=o(n,u,"")),2&e&&(n=o(n,c,"$1")),n}};e.exports={start:l(1),end:l(2),trim:l(3)}},4495:(e,t,n)=>{var r=n(9519),i=n(9039),s=n(4576).String;e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol("symbol detection");return!s(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},5610:(e,t,n)=>{var r=n(1291),i=Math.max,s=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):s(n,t)}},5397:(e,t,n)=>{var r=n(7055),i=n(7750);e.exports=function(e){return r(i(e))}},1291:(e,t,n)=>{var r=n(741);e.exports=function(e){var t=+e;return t!=t||0===t?0:r(t)}},8014:(e,t,n)=>{var r=n(1291),i=Math.min;e.exports=function(e){var t=r(e);return t>0?i(t,9007199254740991):0}},8981:(e,t,n)=>{var r=n(7750),i=Object;e.exports=function(e){return i(r(e))}},2777:(e,t,n)=>{var r=n(9565),i=n(34),s=n(757),a=n(5966),o=n(4270),u=n(8227),c=TypeError,l=u("toPrimitive");e.exports=function(e,t){if(!i(e)||s(e))return e;var n,u=a(e,l);if(u){if(void 0===t&&(t="default"),n=r(u,e,t),!i(n)||s(n))return n;throw new c("Can't convert object to primitive value")}return void 0===t&&(t="number"),o(e,t)}},6969:(e,t,n)=>{var r=n(2777),i=n(757);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},2140:(e,t,n)=>{var r={};r[n(8227)("toStringTag")]="z",e.exports="[object z]"===String(r)},655:(e,t,n)=>{var r=n(6955),i=String;e.exports=function(e){if("Symbol"===r(e))throw new TypeError("Cannot convert a Symbol value to a string");return i(e)}},6823:e=>{var t=String;e.exports=function(e){try{return t(e)}catch(e){return"Object"}}},3392:(e,t,n)=>{var r=n(9504),i=0,s=Math.random(),a=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++i+s,36)}},7040:(e,t,n)=>{var r=n(4495);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},8686:(e,t,n)=>{var r=n(3724),i=n(9039);e.exports=r&&i((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},8622:(e,t,n)=>{var r=n(4576),i=n(4901),s=r.WeakMap;e.exports=i(s)&&/native code/.test(String(s))},8227:(e,t,n)=>{var r=n(4576),i=n(5745),s=n(9297),a=n(3392),o=n(4495),u=n(7040),c=r.Symbol,l=i("wks"),p=u?c.for||c:c&&c.withoutSetter||a;e.exports=function(e){return s(l,e)||(l[e]=o&&s(c,e)?c[e]:p("Symbol."+e)),l[e]}},7452:e=>{e.exports="\t\n\v\f\r \u2028\u2029\ufeff"},3792:(e,t,n)=>{var r=n(5397),i=n(6469),s=n(6269),a=n(1181),o=n(4913).f,u=n(1088),c=n(2529),l=n(6395),p=n(3724),h="Array Iterator",d=a.set,f=a.getterFor(h);e.exports=u(Array,"Array",(function(e,t){d(this,{type:h,target:r(e),index:0,kind:t})}),(function(){var e=f(this),t=e.target,n=e.index++;if(!t||n>=t.length)return e.target=null,c(void 0,!0);switch(e.kind){case"keys":return c(n,!1);case"values":return c(t[n],!1)}return c([n,t[n]],!1)}),"values");var m=s.Arguments=s.Array;if(i("keys"),i("values"),i("entries"),!l&&p&&"values"!==m.name)try{o(m,"name",{value:"values"})}catch(e){}},6910:(e,t,n)=>{var r=n(6518),i=n(9504),s=n(9306),a=n(8981),o=n(6198),u=n(4606),c=n(655),l=n(9039),p=n(4488),h=n(4598),d=n(3709),f=n(3763),m=n(9519),_=n(3607),D=[],g=i(D.sort),v=i(D.push),b=l((function(){D.sort(void 0)})),E=l((function(){D.sort(null)})),y=h("sort"),x=!l((function(){if(m)return m<70;if(!(d&&d>3)){if(f)return!0;if(_)return _<603;var e,t,n,r,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)D.push({k:t+r,v:n})}for(D.sort((function(e,t){return t.v-e.v})),r=0;r<D.length;r++)t=D[r].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}}));r({target:"Array",proto:!0,forced:b||!E||!y||!x},{sort:function(e){void 0!==e&&s(e);var t=a(this);if(x)return void 0===e?g(t):g(t,e);var n,r,i=[],l=o(t);for(r=0;r<l;r++)r in t&&v(i,t[r]);for(p(i,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:c(t)>c(n)?1:-1}}(e)),n=o(i),r=0;r<n;)t[r]=i[r++];for(;r<l;)u(t,r++);return t}})},5081:(e,t,n)=>{var r=n(6518),i=n(4576);r({global:!0,forced:i.globalThis!==i},{globalThis:i})},4864:(e,t,n)=>{var r=n(3724),i=n(4576),s=n(9504),a=n(2796),o=n(3167),u=n(6699),c=n(2360),l=n(8480).f,p=n(1625),h=n(788),d=n(655),f=n(1034),m=n(8429),_=n(1056),D=n(6840),g=n(9039),v=n(9297),b=n(1181).enforce,E=n(7633),y=n(8227),x=n(3635),A=n(8814),C=y("match"),w=i.RegExp,F=w.prototype,S=i.SyntaxError,k=s(F.exec),P=s("".charAt),T=s("".replace),B=s("".indexOf),O=s("".slice),N=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,I=/a/g,L=/a/g,R=new w(I)!==I,j=m.MISSED_STICKY,M=m.UNSUPPORTED_Y,V=r&&(!R||j||x||A||g((function(){return L[C]=!1,w(I)!==I||w(L)===L||"/a/i"!==String(w(I,"i"))})));if(a("RegExp",V)){for(var U=function(e,t){var n,r,i,s,a,l,m=p(F,this),_=h(e),D=void 0===t,g=[],E=e;if(!m&&_&&D&&e.constructor===U)return e;if((_||p(F,e))&&(e=e.source,D&&(t=f(E))),e=void 0===e?"":d(e),t=void 0===t?"":d(t),E=e,x&&"dotAll"in I&&(r=!!t&&B(t,"s")>-1)&&(t=T(t,/s/g,"")),n=t,j&&"sticky"in I&&(i=!!t&&B(t,"y")>-1)&&M&&(t=T(t,/y/g,"")),A&&(s=function(e){for(var t,n=e.length,r=0,i="",s=[],a=c(null),o=!1,u=!1,l=0,p="";r<=n;r++){if("\\"===(t=P(e,r)))t+=P(e,++r);else if("]"===t)o=!1;else if(!o)switch(!0){case"["===t:o=!0;break;case"("===t:if(i+=t,"?:"===O(e,r+1,r+3))continue;k(N,O(e,r+1))&&(r+=2,u=!0),l++;continue;case">"===t&&u:if(""===p||v(a,p))throw new S("Invalid capture group name");a[p]=!0,s[s.length]=[p,l],u=!1,p="";continue}u?p+=t:i+=t}return[i,s]}(e),e=s[0],g=s[1]),a=o(w(e,t),m?this:F,U),(r||i||g.length)&&(l=b(a),r&&(l.dotAll=!0,l.raw=U(function(e){for(var t,n=e.length,r=0,i="",s=!1;r<=n;r++)"\\"!==(t=P(e,r))?s||"."!==t?("["===t?s=!0:"]"===t&&(s=!1),i+=t):i+="[\\s\\S]":i+=t+P(e,++r);return i}(e),n)),i&&(l.sticky=!0),g.length&&(l.groups=g)),e!==E)try{u(a,"source",""===E?"(?:)":E)}catch(e){}return a},W=l(w),q=0;W.length>q;)_(U,w,W[q++]);F.constructor=U,U.prototype=F,D(i,"RegExp",U,{constructor:!0})}E("RegExp")},7495:(e,t,n)=>{var r=n(6518),i=n(7323);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},9479:(e,t,n)=>{var r=n(4576),i=n(3724),s=n(2106),a=n(7979),o=n(9039),u=r.RegExp,c=u.prototype;i&&o((function(){var e=!0;try{u(".","d")}catch(t){e=!1}var t={},n="",r=e?"dgimsy":"gimsy",i=function(e,r){Object.defineProperty(t,e,{get:function(){return n+=r,!0}})},s={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var a in e&&(s.hasIndices="d"),s)i(a,s[a]);return Object.getOwnPropertyDescriptor(c,"flags").get.call(t)!==r||n!==r}))&&s(c,"flags",{configurable:!0,get:a})},9978:(e,t,n)=>{var r=n(6518),i=n(9565),s=n(9504),a=n(7750),o=n(4901),u=n(4117),c=n(788),l=n(655),p=n(5966),h=n(1034),d=n(2478),f=n(8227),m=n(6395),_=f("replace"),D=TypeError,g=s("".indexOf),v=s("".replace),b=s("".slice),E=Math.max;r({target:"String",proto:!0},{replaceAll:function(e,t){var n,r,s,f,y,x,A,C,w,F,S=a(this),k=0,P="";if(!u(e)){if((n=c(e))&&(r=l(a(h(e))),!~g(r,"g")))throw new D("`.replaceAll` does not allow non-global regexes");if(s=p(e,_))return i(s,e,S,t);if(m&&n)return v(l(S),e,t)}for(f=l(S),y=l(e),(x=o(t))||(t=l(t)),A=y.length,C=E(1,A),w=g(f,y);-1!==w;)F=x?l(t(y,w,f)):d(y,f,w,[],void 0,t),P+=b(f,k,w)+F,k=w+A,w=w+C>f.length?-1:g(f,y,w+C);return k<f.length&&(P+=b(f,k)),P}})},5440:(e,t,n)=>{var r=n(8745),i=n(9565),s=n(9504),a=n(9228),o=n(9039),u=n(8551),c=n(4901),l=n(4117),p=n(1291),h=n(8014),d=n(655),f=n(7750),m=n(7829),_=n(5966),D=n(2478),g=n(6682),v=n(8227)("replace"),b=Math.max,E=Math.min,y=s([].concat),x=s([].push),A=s("".indexOf),C=s("".slice),w="$0"==="a".replace(/./,"$0"),F=!!/./[v]&&""===/./[v]("a","$0");a("replace",(function(e,t,n){var s=F?"$":"$0";return[function(e,n){var r=f(this),s=l(e)?void 0:_(e,v);return s?i(s,e,r,n):i(t,d(r),e,n)},function(e,i){var a=u(this),o=d(e);if("string"==typeof i&&-1===A(i,s)&&-1===A(i,"$<")){var l=n(t,a,o,i);if(l.done)return l.value}var f=c(i);f||(i=d(i));var _,v=a.global;v&&(_=a.unicode,a.lastIndex=0);for(var w,F=[];null!==(w=g(a,o))&&(x(F,w),v);){""===d(w[0])&&(a.lastIndex=m(o,h(a.lastIndex),_))}for(var S,k="",P=0,T=0;T<F.length;T++){for(var B,O=d((w=F[T])[0]),N=b(E(p(w.index),o.length),0),I=[],L=1;L<w.length;L++)x(I,void 0===(S=w[L])?S:String(S));var R=w.groups;if(f){var j=y([O],I,N,o);void 0!==R&&x(j,R),B=d(r(i,void 0,j))}else B=D(O,o,N,I,R,i);N>=P&&(k+=C(o,P,N)+B,P=N+O.length)}return k+C(o,P)}]}),!!o((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!w||F)},2762:(e,t,n)=>{var r=n(6518),i=n(3802).trim;r({target:"String",proto:!0,forced:n(706)("trim")},{trim:function(){return i(this)}})},9463:(e,t,n)=>{var r=n(6518),i=n(3724),s=n(4576),a=n(9504),o=n(9297),u=n(4901),c=n(1625),l=n(655),p=n(2106),h=n(7740),d=s.Symbol,f=d&&d.prototype;if(i&&u(d)&&(!("description"in f)||void 0!==d().description)){var m={},_=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:l(arguments[0]),t=c(f,this)?new d(e):void 0===e?d():d(e);return""===e&&(m[t]=!0),t};h(_,d),_.prototype=f,f.constructor=_;var D="Symbol(description detection)"===String(d("description detection")),g=a(f.valueOf),v=a(f.toString),b=/^Symbol\((.*)\)[^)]+$/,E=a("".replace),y=a("".slice);p(f,"description",{configurable:!0,get:function(){var e=g(this);if(o(m,e))return"";var t=v(e),n=D?y(t,7,-1):E(t,b,"$1");return""===n?void 0:n}}),r({global:!0,constructor:!0,forced:!0},{Symbol:_})}},2480:(e,t,n)=>{n(5081)},2041:(e,t,n)=>{n(9978)},2953:(e,t,n)=>{var r=n(4576),i=n(7400),s=n(9296),a=n(3792),o=n(6699),u=n(687),c=n(8227)("iterator"),l=a.values,p=function(e,t){if(e){if(e[c]!==l)try{o(e,c,l)}catch(t){e[c]=l}if(u(e,t,!0),i[t])for(var n in a)if(e[n]!==a[n])try{o(e,n,a[n])}catch(t){e[n]=a[n]}}};for(var h in i)p(r[h]&&r[h].prototype,h);p(s,"DOMTokenList")},3270:(e,t,n)=>{n.r(t),n.d(t,{Node:()=>re,Parser:()=>V,Position:()=>N,SourceLocation:()=>I,TokContext:()=>ae,Token:()=>ke,TokenType:()=>_,defaultOptions:()=>R,getLineInfo:()=>L,isIdentifierChar:()=>m,isIdentifierStart:()=>f,isNewLine:()=>C,keywordTypes:()=>b,lineBreak:()=>x,lineBreakG:()=>A,nonASCIIwhitespace:()=>w,parse:()=>Ie,parseExpressionAt:()=>Le,tokContexts:()=>oe,tokTypes:()=>y,tokenizer:()=>Re,version:()=>Ne});var r={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},i="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",s={5:i,"5module":i+" export import",6:i+" const class extends export import super"},a=/^in(stanceof)?$/,o="---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",u="----------------------------------------------------------------------------------------------------------------------------------------------------",c=new RegExp("["+o+"]"),l=new RegExp("["+o+u+"]");o=u=null;var p=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,107,20,28,22,13,52,76,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,190,0,80,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8952,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42717,35,4148,12,221,3,5761,15,7472,3104,541,1507,4938],h=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,154,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,4759,9,787719,239];function d(e,t){for(var n=65536,r=0;r<t.length;r+=2){if((n+=t[r])>e)return!1;if((n+=t[r+1])>=e)return!0}}function f(e,t){return e<65?36===e:e<91||(e<97?95===e:e<123||(e<=65535?e>=170&&c.test(String.fromCharCode(e)):!1!==t&&d(e,p)))}function m(e,t){return e<48?36===e:e<58||!(e<65)&&(e<91||(e<97?95===e:e<123||(e<=65535?e>=170&&l.test(String.fromCharCode(e)):!1!==t&&(d(e,p)||d(e,h)))))}var _=function(e,t){void 0===t&&(t={}),this.label=e,this.keyword=t.keyword,this.beforeExpr=!!t.beforeExpr,this.startsExpr=!!t.startsExpr,this.isLoop=!!t.isLoop,this.isAssign=!!t.isAssign,this.prefix=!!t.prefix,this.postfix=!!t.postfix,this.binop=t.binop||null,this.updateContext=null};function D(e,t){return new _(e,{beforeExpr:!0,binop:t})}var g={beforeExpr:!0},v={startsExpr:!0},b={};function E(e,t){return void 0===t&&(t={}),t.keyword=e,b[e]=new _(e,t)}var y={num:new _("num",v),regexp:new _("regexp",v),string:new _("string",v),name:new _("name",v),eof:new _("eof"),bracketL:new _("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new _("]"),braceL:new _("{",{beforeExpr:!0,startsExpr:!0}),braceR:new _("}"),parenL:new _("(",{beforeExpr:!0,startsExpr:!0}),parenR:new _(")"),comma:new _(",",g),semi:new _(";",g),colon:new _(":",g),dot:new _("."),question:new _("?",g),questionDot:new _("?."),arrow:new _("=>",g),template:new _("template"),invalidTemplate:new _("invalidTemplate"),ellipsis:new _("...",g),backQuote:new _("`",v),dollarBraceL:new _("${",{beforeExpr:!0,startsExpr:!0}),eq:new _("=",{beforeExpr:!0,isAssign:!0}),assign:new _("_=",{beforeExpr:!0,isAssign:!0}),incDec:new _("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new _("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:D("||",1),logicalAND:D("&&",2),bitwiseOR:D("|",3),bitwiseXOR:D("^",4),bitwiseAND:D("&",5),equality:D("==/!=/===/!==",6),relational:D("</>/<=/>=",7),bitShift:D("<</>>/>>>",8),plusMin:new _("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:D("%",10),star:D("*",10),slash:D("/",10),starstar:new _("**",{beforeExpr:!0}),coalesce:D("??",1),_break:E("break"),_case:E("case",g),_catch:E("catch"),_continue:E("continue"),_debugger:E("debugger"),_default:E("default",g),_do:E("do",{isLoop:!0,beforeExpr:!0}),_else:E("else",g),_finally:E("finally"),_for:E("for",{isLoop:!0}),_function:E("function",v),_if:E("if"),_return:E("return",g),_switch:E("switch"),_throw:E("throw",g),_try:E("try"),_var:E("var"),_const:E("const"),_while:E("while",{isLoop:!0}),_with:E("with"),_new:E("new",{beforeExpr:!0,startsExpr:!0}),_this:E("this",v),_super:E("super",v),_class:E("class",v),_extends:E("extends",g),_export:E("export"),_import:E("import",v),_null:E("null",v),_true:E("true",v),_false:E("false",v),_in:E("in",{beforeExpr:!0,binop:7}),_instanceof:E("instanceof",{beforeExpr:!0,binop:7}),_typeof:E("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:E("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:E("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},x=/\r\n?|\n|\u2028|\u2029/,A=new RegExp(x.source,"g");function C(e,t){return 10===e||13===e||!t&&(8232===e||8233===e)}var w=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,F=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,S=Object.prototype,k=S.hasOwnProperty,P=S.toString;function T(e,t){return k.call(e,t)}var B=Array.isArray||function(e){return"[object Array]"===P.call(e)};function O(e){return new RegExp("^(?:"+e.replace(/ /g,"|")+")$")}var N=function(e,t){this.line=e,this.column=t};N.prototype.offset=function(e){return new N(this.line,this.column+e)};var I=function(e,t,n){this.start=t,this.end=n,null!==e.sourceFile&&(this.source=e.sourceFile)};function L(e,t){for(var n=1,r=0;;){A.lastIndex=r;var i=A.exec(e);if(!(i&&i.index<t))return new N(n,t-r);++n,r=i.index+i[0].length}}var R={ecmaVersion:10,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function j(e){var t={};for(var n in R)t[n]=e&&T(e,n)?e[n]:R[n];if(t.ecmaVersion>=2015&&(t.ecmaVersion-=2009),null==t.allowReserved&&(t.allowReserved=t.ecmaVersion<5),B(t.onToken)){var r=t.onToken;t.onToken=function(e){return r.push(e)}}return B(t.onComment)&&(t.onComment=function(e,t){return function(n,r,i,s,a,o){var u={type:n?"Block":"Line",value:r,start:i,end:s};e.locations&&(u.loc=new I(this,a,o)),e.ranges&&(u.range=[i,s]),t.push(u)}}(t,t.onComment)),t}function M(e,t){return 2|(e?4:0)|(t?8:0)}var V=function(e,t,n){this.options=e=j(e),this.sourceFile=e.sourceFile,this.keywords=O(s[e.ecmaVersion>=6?6:"module"===e.sourceType?"5module":5]);var i="";if(!0!==e.allowReserved){for(var a=e.ecmaVersion;!(i=r[a]);a--);"module"===e.sourceType&&(i+=" await")}this.reservedWords=O(i);var o=(i?i+" ":"")+r.strict;this.reservedWordsStrict=O(o),this.reservedWordsStrictBind=O(o+" "+r.strictBind),this.input=String(t),this.containsEsc=!1,n?(this.pos=n,this.lineStart=this.input.lastIndexOf("\n",n-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(x).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=y.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule="module"===e.sourceType,this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},0===this.pos&&e.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(1),this.regexpState=null},U={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};V.prototype.parse=function(){var e=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(e)},U.inFunction.get=function(){return(2&this.currentVarScope().flags)>0},U.inGenerator.get=function(){return(8&this.currentVarScope().flags)>0},U.inAsync.get=function(){return(4&this.currentVarScope().flags)>0},U.allowSuper.get=function(){return(64&this.currentThisScope().flags)>0},U.allowDirectSuper.get=function(){return(128&this.currentThisScope().flags)>0},U.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},V.prototype.inNonArrowFunction=function(){return(2&this.currentThisScope().flags)>0},V.extend=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];for(var n=this,r=0;r<e.length;r++)n=e[r](n);return n},V.parse=function(e,t){return new this(t,e).parse()},V.parseExpressionAt=function(e,t,n){var r=new this(n,e,t);return r.nextToken(),r.parseExpression()},V.tokenizer=function(e,t){return new this(t,e)},Object.defineProperties(V.prototype,U);var W=V.prototype,q=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;function G(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}W.strictDirective=function(e){for(;;){F.lastIndex=e,e+=F.exec(this.input)[0].length;var t=q.exec(this.input.slice(e));if(!t)return!1;if("use strict"===(t[1]||t[2])){F.lastIndex=e+t[0].length;var n=F.exec(this.input),r=n.index+n[0].length,i=this.input.charAt(r);return";"===i||"}"===i||x.test(n[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(i)||"!"===i&&"="===this.input.charAt(r+1))}e+=t[0].length,F.lastIndex=e,e+=F.exec(this.input)[0].length,";"===this.input[e]&&e++}},W.eat=function(e){return this.type===e&&(this.next(),!0)},W.isContextual=function(e){return this.type===y.name&&this.value===e&&!this.containsEsc},W.eatContextual=function(e){return!!this.isContextual(e)&&(this.next(),!0)},W.expectContextual=function(e){this.eatContextual(e)||this.unexpected()},W.canInsertSemicolon=function(){return this.type===y.eof||this.type===y.braceR||x.test(this.input.slice(this.lastTokEnd,this.start))},W.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},W.semicolon=function(){this.eat(y.semi)||this.insertSemicolon()||this.unexpected()},W.afterTrailingComma=function(e,t){if(this.type===e)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),t||this.next(),!0},W.expect=function(e){this.eat(e)||this.unexpected()},W.unexpected=function(e){this.raise(null!=e?e:this.start,"Unexpected token")},W.checkPatternErrors=function(e,t){if(e){e.trailingComma>-1&&this.raiseRecoverable(e.trailingComma,"Comma is not permitted after the rest element");var n=t?e.parenthesizedAssign:e.parenthesizedBind;n>-1&&this.raiseRecoverable(n,"Parenthesized pattern")}},W.checkExpressionErrors=function(e,t){if(!e)return!1;var n=e.shorthandAssign,r=e.doubleProto;if(!t)return n>=0||r>=0;n>=0&&this.raise(n,"Shorthand property assignments are valid only in destructuring patterns"),r>=0&&this.raiseRecoverable(r,"Redefinition of __proto__ property")},W.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},W.isSimpleAssignTarget=function(e){return"ParenthesizedExpression"===e.type?this.isSimpleAssignTarget(e.expression):"Identifier"===e.type||"MemberExpression"===e.type};var K=V.prototype;K.parseTopLevel=function(e){var t={};for(e.body||(e.body=[]);this.type!==y.eof;){var n=this.parseStatement(null,!0,t);e.body.push(n)}if(this.inModule)for(var r=0,i=Object.keys(this.undefinedExports);r<i.length;r+=1){var s=i[r];this.raiseRecoverable(this.undefinedExports[s].start,"Export '"+s+"' is not defined")}return this.adaptDirectivePrologue(e.body),this.next(),e.sourceType=this.options.sourceType,this.finishNode(e,"Program")};var z={kind:"loop"},X={kind:"switch"};K.isLet=function(e){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;F.lastIndex=this.pos;var t=F.exec(this.input),n=this.pos+t[0].length,r=this.input.charCodeAt(n);if(91===r)return!0;if(e)return!1;if(123===r)return!0;if(f(r,!0)){for(var i=n+1;m(this.input.charCodeAt(i),!0);)++i;var s=this.input.slice(n,i);if(!a.test(s))return!0}return!1},K.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;F.lastIndex=this.pos;var e=F.exec(this.input),t=this.pos+e[0].length;return!(x.test(this.input.slice(this.pos,t))||"function"!==this.input.slice(t,t+8)||t+8!==this.input.length&&m(this.input.charAt(t+8)))},K.parseStatement=function(e,t,n){var r,i=this.type,s=this.startNode();switch(this.isLet(e)&&(i=y._var,r="let"),i){case y._break:case y._continue:return this.parseBreakContinueStatement(s,i.keyword);case y._debugger:return this.parseDebuggerStatement(s);case y._do:return this.parseDoStatement(s);case y._for:return this.parseForStatement(s);case y._function:return e&&(this.strict||"if"!==e&&"label"!==e)&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(s,!1,!e);case y._class:return e&&this.unexpected(),this.parseClass(s,!0);case y._if:return this.parseIfStatement(s);case y._return:return this.parseReturnStatement(s);case y._switch:return this.parseSwitchStatement(s);case y._throw:return this.parseThrowStatement(s);case y._try:return this.parseTryStatement(s);case y._const:case y._var:return r=r||this.value,e&&"var"!==r&&this.unexpected(),this.parseVarStatement(s,r);case y._while:return this.parseWhileStatement(s);case y._with:return this.parseWithStatement(s);case y.braceL:return this.parseBlock(!0,s);case y.semi:return this.parseEmptyStatement(s);case y._export:case y._import:if(this.options.ecmaVersion>10&&i===y._import){F.lastIndex=this.pos;var a=F.exec(this.input),o=this.pos+a[0].length,u=this.input.charCodeAt(o);if(40===u||46===u)return this.parseExpressionStatement(s,this.parseExpression())}return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),i===y._import?this.parseImport(s):this.parseExport(s,n);default:if(this.isAsyncFunction())return e&&this.unexpected(),this.next(),this.parseFunctionStatement(s,!0,!e);var c=this.value,l=this.parseExpression();return i===y.name&&"Identifier"===l.type&&this.eat(y.colon)?this.parseLabeledStatement(s,c,l,e):this.parseExpressionStatement(s,l)}},K.parseBreakContinueStatement=function(e,t){var n="break"===t;this.next(),this.eat(y.semi)||this.insertSemicolon()?e.label=null:this.type!==y.name?this.unexpected():(e.label=this.parseIdent(),this.semicolon());for(var r=0;r<this.labels.length;++r){var i=this.labels[r];if(null==e.label||i.name===e.label.name){if(null!=i.kind&&(n||"loop"===i.kind))break;if(e.label&&n)break}}return r===this.labels.length&&this.raise(e.start,"Unsyntactic "+t),this.finishNode(e,n?"BreakStatement":"ContinueStatement")},K.parseDebuggerStatement=function(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")},K.parseDoStatement=function(e){return this.next(),this.labels.push(z),e.body=this.parseStatement("do"),this.labels.pop(),this.expect(y._while),e.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(y.semi):this.semicolon(),this.finishNode(e,"DoWhileStatement")},K.parseForStatement=function(e){this.next();var t=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(z),this.enterScope(0),this.expect(y.parenL),this.type===y.semi)return t>-1&&this.unexpected(t),this.parseFor(e,null);var n=this.isLet();if(this.type===y._var||this.type===y._const||n){var r=this.startNode(),i=n?"let":this.value;return this.next(),this.parseVar(r,!0,i),this.finishNode(r,"VariableDeclaration"),(this.type===y._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&1===r.declarations.length?(this.options.ecmaVersion>=9&&(this.type===y._in?t>-1&&this.unexpected(t):e.await=t>-1),this.parseForIn(e,r)):(t>-1&&this.unexpected(t),this.parseFor(e,r))}var s=new G,a=this.parseExpression(!0,s);return this.type===y._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===y._in?t>-1&&this.unexpected(t):e.await=t>-1),this.toAssignable(a,!1,s),this.checkLVal(a),this.parseForIn(e,a)):(this.checkExpressionErrors(s,!0),t>-1&&this.unexpected(t),this.parseFor(e,a))},K.parseFunctionStatement=function(e,t,n){return this.next(),this.parseFunction(e,$|(n?0:J),!1,t)},K.parseIfStatement=function(e){return this.next(),e.test=this.parseParenExpression(),e.consequent=this.parseStatement("if"),e.alternate=this.eat(y._else)?this.parseStatement("if"):null,this.finishNode(e,"IfStatement")},K.parseReturnStatement=function(e){return this.inFunction||this.options.allowReturnOutsideFunction||this.raise(this.start,"'return' outside of function"),this.next(),this.eat(y.semi)||this.insertSemicolon()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")},K.parseSwitchStatement=function(e){var t;this.next(),e.discriminant=this.parseParenExpression(),e.cases=[],this.expect(y.braceL),this.labels.push(X),this.enterScope(0);for(var n=!1;this.type!==y.braceR;)if(this.type===y._case||this.type===y._default){var r=this.type===y._case;t&&this.finishNode(t,"SwitchCase"),e.cases.push(t=this.startNode()),t.consequent=[],this.next(),r?t.test=this.parseExpression():(n&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),n=!0,t.test=null),this.expect(y.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(null));return this.exitScope(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(e,"SwitchStatement")},K.parseThrowStatement=function(e){return this.next(),x.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")};var H=[];K.parseTryStatement=function(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.type===y._catch){var t=this.startNode();if(this.next(),this.eat(y.parenL)){t.param=this.parseBindingAtom();var n="Identifier"===t.param.type;this.enterScope(n?32:0),this.checkLVal(t.param,n?4:2),this.expect(y.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),t.param=null,this.enterScope(0);t.body=this.parseBlock(!1),this.exitScope(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(y._finally)?this.parseBlock():null,e.handler||e.finalizer||this.raise(e.start,"Missing catch or finally clause"),this.finishNode(e,"TryStatement")},K.parseVarStatement=function(e,t){return this.next(),this.parseVar(e,!1,t),this.semicolon(),this.finishNode(e,"VariableDeclaration")},K.parseWhileStatement=function(e){return this.next(),e.test=this.parseParenExpression(),this.labels.push(z),e.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(e,"WhileStatement")},K.parseWithStatement=function(e){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),e.object=this.parseParenExpression(),e.body=this.parseStatement("with"),this.finishNode(e,"WithStatement")},K.parseEmptyStatement=function(e){return this.next(),this.finishNode(e,"EmptyStatement")},K.parseLabeledStatement=function(e,t,n,r){for(var i=0,s=this.labels;i<s.length;i+=1){s[i].name===t&&this.raise(n.start,"Label '"+t+"' is already declared")}for(var a=this.type.isLoop?"loop":this.type===y._switch?"switch":null,o=this.labels.length-1;o>=0;o--){var u=this.labels[o];if(u.statementStart!==e.start)break;u.statementStart=this.start,u.kind=a}return this.labels.push({name:t,kind:a,statementStart:this.start}),e.body=this.parseStatement(r?-1===r.indexOf("label")?r+"label":r:"label"),this.labels.pop(),e.label=n,this.finishNode(e,"LabeledStatement")},K.parseExpressionStatement=function(e,t){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")},K.parseBlock=function(e,t,n){for(void 0===e&&(e=!0),void 0===t&&(t=this.startNode()),t.body=[],this.expect(y.braceL),e&&this.enterScope(0);this.type!==y.braceR;){var r=this.parseStatement(null);t.body.push(r)}return n&&(this.strict=!1),this.next(),e&&this.exitScope(),this.finishNode(t,"BlockStatement")},K.parseFor=function(e,t){return e.init=t,this.expect(y.semi),e.test=this.type===y.semi?null:this.parseExpression(),this.expect(y.semi),e.update=this.type===y.parenR?null:this.parseExpression(),this.expect(y.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,"ForStatement")},K.parseForIn=function(e,t){var n=this.type===y._in;return this.next(),"VariableDeclaration"===t.type&&null!=t.declarations[0].init&&(!n||this.options.ecmaVersion<8||this.strict||"var"!==t.kind||"Identifier"!==t.declarations[0].id.type)?this.raise(t.start,(n?"for-in":"for-of")+" loop variable declaration may not have an initializer"):"AssignmentPattern"===t.type&&this.raise(t.start,"Invalid left-hand side in for-loop"),e.left=t,e.right=n?this.parseExpression():this.parseMaybeAssign(),this.expect(y.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,n?"ForInStatement":"ForOfStatement")},K.parseVar=function(e,t,n){for(e.declarations=[],e.kind=n;;){var r=this.startNode();if(this.parseVarId(r,n),this.eat(y.eq)?r.init=this.parseMaybeAssign(t):"const"!==n||this.type===y._in||this.options.ecmaVersion>=6&&this.isContextual("of")?"Identifier"===r.id.type||t&&(this.type===y._in||this.isContextual("of"))?r.init=null:this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):this.unexpected(),e.declarations.push(this.finishNode(r,"VariableDeclarator")),!this.eat(y.comma))break}return e},K.parseVarId=function(e,t){e.id=this.parseBindingAtom(),this.checkLVal(e.id,"var"===t?1:2,!1)};var $=1,J=2;K.parseFunction=function(e,t,n,r){this.initFunction(e),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!r)&&(this.type===y.star&&t&J&&this.unexpected(),e.generator=this.eat(y.star)),this.options.ecmaVersion>=8&&(e.async=!!r),t&$&&(e.id=4&t&&this.type!==y.name?null:this.parseIdent(),!e.id||t&J||this.checkLVal(e.id,this.strict||e.generator||e.async?this.treatFunctionsAsVar?1:2:3));var i=this.yieldPos,s=this.awaitPos,a=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(M(e.async,e.generator)),t&$||(e.id=this.type===y.name?this.parseIdent():null),this.parseFunctionParams(e),this.parseFunctionBody(e,n,!1),this.yieldPos=i,this.awaitPos=s,this.awaitIdentPos=a,this.finishNode(e,t&$?"FunctionDeclaration":"FunctionExpression")},K.parseFunctionParams=function(e){this.expect(y.parenL),e.params=this.parseBindingList(y.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},K.parseClass=function(e,t){this.next();var n=this.strict;this.strict=!0,this.parseClassId(e,t),this.parseClassSuper(e);var r=this.startNode(),i=!1;for(r.body=[],this.expect(y.braceL);this.type!==y.braceR;){var s=this.parseClassElement(null!==e.superClass);s&&(r.body.push(s),"MethodDefinition"===s.type&&"constructor"===s.kind&&(i&&this.raise(s.start,"Duplicate constructor in the same class"),i=!0))}return this.strict=n,this.next(),e.body=this.finishNode(r,"ClassBody"),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")},K.parseClassElement=function(e){var t=this;if(this.eat(y.semi))return null;var n=this.startNode(),r=function(e,r){void 0===r&&(r=!1);var i=t.start,s=t.startLoc;return!!t.eatContextual(e)&&(!(t.type===y.parenL||r&&t.canInsertSemicolon())||(n.key&&t.unexpected(),n.computed=!1,n.key=t.startNodeAt(i,s),n.key.name=e,t.finishNode(n.key,"Identifier"),!1))};n.kind="method",n.static=r("static");var i=this.eat(y.star),s=!1;i||(this.options.ecmaVersion>=8&&r("async",!0)?(s=!0,i=this.options.ecmaVersion>=9&&this.eat(y.star)):r("get")?n.kind="get":r("set")&&(n.kind="set")),n.key||this.parsePropertyName(n);var a=n.key,o=!1;return n.computed||n.static||!("Identifier"===a.type&&"constructor"===a.name||"Literal"===a.type&&"constructor"===a.value)?n.static&&"Identifier"===a.type&&"prototype"===a.name&&this.raise(a.start,"Classes may not have a static property named prototype"):("method"!==n.kind&&this.raise(a.start,"Constructor can't have get/set modifier"),i&&this.raise(a.start,"Constructor can't be a generator"),s&&this.raise(a.start,"Constructor can't be an async method"),n.kind="constructor",o=e),this.parseClassMethod(n,i,s,o),"get"===n.kind&&0!==n.value.params.length&&this.raiseRecoverable(n.value.start,"getter should have no params"),"set"===n.kind&&1!==n.value.params.length&&this.raiseRecoverable(n.value.start,"setter should have exactly one param"),"set"===n.kind&&"RestElement"===n.value.params[0].type&&this.raiseRecoverable(n.value.params[0].start,"Setter cannot use rest params"),n},K.parseClassMethod=function(e,t,n,r){return e.value=this.parseMethod(t,n,r),this.finishNode(e,"MethodDefinition")},K.parseClassId=function(e,t){this.type===y.name?(e.id=this.parseIdent(),t&&this.checkLVal(e.id,2,!1)):(!0===t&&this.unexpected(),e.id=null)},K.parseClassSuper=function(e){e.superClass=this.eat(y._extends)?this.parseExprSubscripts():null},K.parseExport=function(e,t){if(this.next(),this.eat(y.star))return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(e.exported=this.parseIdent(!0),this.checkExport(t,e.exported.name,this.lastTokStart)):e.exported=null),this.expectContextual("from"),this.type!==y.string&&this.unexpected(),e.source=this.parseExprAtom(),this.semicolon(),this.finishNode(e,"ExportAllDeclaration");if(this.eat(y._default)){var n;if(this.checkExport(t,"default",this.lastTokStart),this.type===y._function||(n=this.isAsyncFunction())){var r=this.startNode();this.next(),n&&this.next(),e.declaration=this.parseFunction(r,4|$,!1,n)}else if(this.type===y._class){var i=this.startNode();e.declaration=this.parseClass(i,"nullableID")}else e.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(e,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())e.declaration=this.parseStatement(null),"VariableDeclaration"===e.declaration.type?this.checkVariableExport(t,e.declaration.declarations):this.checkExport(t,e.declaration.id.name,e.declaration.id.start),e.specifiers=[],e.source=null;else{if(e.declaration=null,e.specifiers=this.parseExportSpecifiers(t),this.eatContextual("from"))this.type!==y.string&&this.unexpected(),e.source=this.parseExprAtom();else{for(var s=0,a=e.specifiers;s<a.length;s+=1){var o=a[s];this.checkUnreserved(o.local),this.checkLocalExport(o.local)}e.source=null}this.semicolon()}return this.finishNode(e,"ExportNamedDeclaration")},K.checkExport=function(e,t,n){e&&(T(e,t)&&this.raiseRecoverable(n,"Duplicate export '"+t+"'"),e[t]=!0)},K.checkPatternExport=function(e,t){var n=t.type;if("Identifier"===n)this.checkExport(e,t.name,t.start);else if("ObjectPattern"===n)for(var r=0,i=t.properties;r<i.length;r+=1){var s=i[r];this.checkPatternExport(e,s)}else if("ArrayPattern"===n)for(var a=0,o=t.elements;a<o.length;a+=1){var u=o[a];u&&this.checkPatternExport(e,u)}else"Property"===n?this.checkPatternExport(e,t.value):"AssignmentPattern"===n?this.checkPatternExport(e,t.left):"RestElement"===n?this.checkPatternExport(e,t.argument):"ParenthesizedExpression"===n&&this.checkPatternExport(e,t.expression)},K.checkVariableExport=function(e,t){if(e)for(var n=0,r=t;n<r.length;n+=1){var i=r[n];this.checkPatternExport(e,i.id)}},K.shouldParseExportStatement=function(){return"var"===this.type.keyword||"const"===this.type.keyword||"class"===this.type.keyword||"function"===this.type.keyword||this.isLet()||this.isAsyncFunction()},K.parseExportSpecifiers=function(e){var t=[],n=!0;for(this.expect(y.braceL);!this.eat(y.braceR);){if(n)n=!1;else if(this.expect(y.comma),this.afterTrailingComma(y.braceR))break;var r=this.startNode();r.local=this.parseIdent(!0),r.exported=this.eatContextual("as")?this.parseIdent(!0):r.local,this.checkExport(e,r.exported.name,r.exported.start),t.push(this.finishNode(r,"ExportSpecifier"))}return t},K.parseImport=function(e){return this.next(),this.type===y.string?(e.specifiers=H,e.source=this.parseExprAtom()):(e.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),e.source=this.type===y.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(e,"ImportDeclaration")},K.parseImportSpecifiers=function(){var e=[],t=!0;if(this.type===y.name){var n=this.startNode();if(n.local=this.parseIdent(),this.checkLVal(n.local,2),e.push(this.finishNode(n,"ImportDefaultSpecifier")),!this.eat(y.comma))return e}if(this.type===y.star){var r=this.startNode();return this.next(),this.expectContextual("as"),r.local=this.parseIdent(),this.checkLVal(r.local,2),e.push(this.finishNode(r,"ImportNamespaceSpecifier")),e}for(this.expect(y.braceL);!this.eat(y.braceR);){if(t)t=!1;else if(this.expect(y.comma),this.afterTrailingComma(y.braceR))break;var i=this.startNode();i.imported=this.parseIdent(!0),this.eatContextual("as")?i.local=this.parseIdent():(this.checkUnreserved(i.imported),i.local=i.imported),this.checkLVal(i.local,2),e.push(this.finishNode(i,"ImportSpecifier"))}return e},K.adaptDirectivePrologue=function(e){for(var t=0;t<e.length&&this.isDirectiveCandidate(e[t]);++t)e[t].directive=e[t].expression.raw.slice(1,-1)},K.isDirectiveCandidate=function(e){return"ExpressionStatement"===e.type&&"Literal"===e.expression.type&&"string"==typeof e.expression.value&&('"'===this.input[e.start]||"'"===this.input[e.start])};var Y=V.prototype;Y.toAssignable=function(e,t,n){if(this.options.ecmaVersion>=6&&e)switch(e.type){case"Identifier":this.inAsync&&"await"===e.name&&this.raise(e.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":e.type="ObjectPattern",n&&this.checkPatternErrors(n,!0);for(var r=0,i=e.properties;r<i.length;r+=1){var s=i[r];this.toAssignable(s,t),"RestElement"!==s.type||"ArrayPattern"!==s.argument.type&&"ObjectPattern"!==s.argument.type||this.raise(s.argument.start,"Unexpected token")}break;case"Property":"init"!==e.kind&&this.raise(e.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(e.value,t);break;case"ArrayExpression":e.type="ArrayPattern",n&&this.checkPatternErrors(n,!0),this.toAssignableList(e.elements,t);break;case"SpreadElement":e.type="RestElement",this.toAssignable(e.argument,t),"AssignmentPattern"===e.argument.type&&this.raise(e.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":"="!==e.operator&&this.raise(e.left.end,"Only '=' operator can be used for specifying default value."),e.type="AssignmentPattern",delete e.operator,this.toAssignable(e.left,t);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(e.expression,t,n);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!t)break;default:this.raise(e.start,"Assigning to rvalue")}else n&&this.checkPatternErrors(n,!0);return e},Y.toAssignableList=function(e,t){for(var n=e.length,r=0;r<n;r++){var i=e[r];i&&this.toAssignable(i,t)}if(n){var s=e[n-1];6===this.options.ecmaVersion&&t&&s&&"RestElement"===s.type&&"Identifier"!==s.argument.type&&this.unexpected(s.argument.start)}return e},Y.parseSpread=function(e){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(!1,e),this.finishNode(t,"SpreadElement")},Y.parseRestBinding=function(){var e=this.startNode();return this.next(),6===this.options.ecmaVersion&&this.type!==y.name&&this.unexpected(),e.argument=this.parseBindingAtom(),this.finishNode(e,"RestElement")},Y.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case y.bracketL:var e=this.startNode();return this.next(),e.elements=this.parseBindingList(y.bracketR,!0,!0),this.finishNode(e,"ArrayPattern");case y.braceL:return this.parseObj(!0)}return this.parseIdent()},Y.parseBindingList=function(e,t,n){for(var r=[],i=!0;!this.eat(e);)if(i?i=!1:this.expect(y.comma),t&&this.type===y.comma)r.push(null);else{if(n&&this.afterTrailingComma(e))break;if(this.type===y.ellipsis){var s=this.parseRestBinding();this.parseBindingListItem(s),r.push(s),this.type===y.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(e);break}var a=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(a),r.push(a)}return r},Y.parseBindingListItem=function(e){return e},Y.parseMaybeDefault=function(e,t,n){if(n=n||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(y.eq))return n;var r=this.startNodeAt(e,t);return r.left=n,r.right=this.parseMaybeAssign(),this.finishNode(r,"AssignmentPattern")},Y.checkLVal=function(e,t,n){switch(void 0===t&&(t=0),e.type){case"Identifier":2===t&&"let"===e.name&&this.raiseRecoverable(e.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(e.name)&&this.raiseRecoverable(e.start,(t?"Binding ":"Assigning to ")+e.name+" in strict mode"),n&&(T(n,e.name)&&this.raiseRecoverable(e.start,"Argument name clash"),n[e.name]=!0),0!==t&&5!==t&&this.declareName(e.name,t,e.start);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":t&&this.raiseRecoverable(e.start,"Binding member expression");break;case"ObjectPattern":for(var r=0,i=e.properties;r<i.length;r+=1){var s=i[r];this.checkLVal(s,t,n)}break;case"Property":this.checkLVal(e.value,t,n);break;case"ArrayPattern":for(var a=0,o=e.elements;a<o.length;a+=1){var u=o[a];u&&this.checkLVal(u,t,n)}break;case"AssignmentPattern":this.checkLVal(e.left,t,n);break;case"RestElement":this.checkLVal(e.argument,t,n);break;case"ParenthesizedExpression":this.checkLVal(e.expression,t,n);break;default:this.raise(e.start,(t?"Binding":"Assigning to")+" rvalue")}};var Q=V.prototype;Q.checkPropClash=function(e,t,n){if(!(this.options.ecmaVersion>=9&&"SpreadElement"===e.type||this.options.ecmaVersion>=6&&(e.computed||e.method||e.shorthand))){var r,i=e.key;switch(i.type){case"Identifier":r=i.name;break;case"Literal":r=String(i.value);break;default:return}var s=e.kind;if(this.options.ecmaVersion>=6)"__proto__"===r&&"init"===s&&(t.proto&&(n?n.doubleProto<0&&(n.doubleProto=i.start):this.raiseRecoverable(i.start,"Redefinition of __proto__ property")),t.proto=!0);else{var a=t[r="$"+r];if(a)("init"===s?this.strict&&a.init||a.get||a.set:a.init||a[s])&&this.raiseRecoverable(i.start,"Redefinition of property");else a=t[r]={init:!1,get:!1,set:!1};a[s]=!0}}},Q.parseExpression=function(e,t){var n=this.start,r=this.startLoc,i=this.parseMaybeAssign(e,t);if(this.type===y.comma){var s=this.startNodeAt(n,r);for(s.expressions=[i];this.eat(y.comma);)s.expressions.push(this.parseMaybeAssign(e,t));return this.finishNode(s,"SequenceExpression")}return i},Q.parseMaybeAssign=function(e,t,n){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(e);this.exprAllowed=!1}var r=!1,i=-1,s=-1;t?(i=t.parenthesizedAssign,s=t.trailingComma,t.parenthesizedAssign=t.trailingComma=-1):(t=new G,r=!0);var a=this.start,o=this.startLoc;this.type!==y.parenL&&this.type!==y.name||(this.potentialArrowAt=this.start);var u=this.parseMaybeConditional(e,t);if(n&&(u=n.call(this,u,a,o)),this.type.isAssign){var c=this.startNodeAt(a,o);return c.operator=this.value,c.left=this.type===y.eq?this.toAssignable(u,!1,t):u,r||(t.parenthesizedAssign=t.trailingComma=t.doubleProto=-1),t.shorthandAssign>=c.left.start&&(t.shorthandAssign=-1),this.checkLVal(u),this.next(),c.right=this.parseMaybeAssign(e),this.finishNode(c,"AssignmentExpression")}return r&&this.checkExpressionErrors(t,!0),i>-1&&(t.parenthesizedAssign=i),s>-1&&(t.trailingComma=s),u},Q.parseMaybeConditional=function(e,t){var n=this.start,r=this.startLoc,i=this.parseExprOps(e,t);if(this.checkExpressionErrors(t))return i;if(this.eat(y.question)){var s=this.startNodeAt(n,r);return s.test=i,s.consequent=this.parseMaybeAssign(),this.expect(y.colon),s.alternate=this.parseMaybeAssign(e),this.finishNode(s,"ConditionalExpression")}return i},Q.parseExprOps=function(e,t){var n=this.start,r=this.startLoc,i=this.parseMaybeUnary(t,!1);return this.checkExpressionErrors(t)||i.start===n&&"ArrowFunctionExpression"===i.type?i:this.parseExprOp(i,n,r,-1,e)},Q.parseExprOp=function(e,t,n,r,i){var s=this.type.binop;if(null!=s&&(!i||this.type!==y._in)&&s>r){var a=this.type===y.logicalOR||this.type===y.logicalAND,o=this.type===y.coalesce;o&&(s=y.logicalAND.binop);var u=this.value;this.next();var c=this.start,l=this.startLoc,p=this.parseExprOp(this.parseMaybeUnary(null,!1),c,l,s,i),h=this.buildBinary(t,n,e,p,u,a||o);return(a&&this.type===y.coalesce||o&&(this.type===y.logicalOR||this.type===y.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(h,t,n,r,i)}return e},Q.buildBinary=function(e,t,n,r,i,s){var a=this.startNodeAt(e,t);return a.left=n,a.operator=i,a.right=r,this.finishNode(a,s?"LogicalExpression":"BinaryExpression")},Q.parseMaybeUnary=function(e,t){var n,r=this.start,i=this.startLoc;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))n=this.parseAwait(),t=!0;else if(this.type.prefix){var s=this.startNode(),a=this.type===y.incDec;s.operator=this.value,s.prefix=!0,this.next(),s.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(e,!0),a?this.checkLVal(s.argument):this.strict&&"delete"===s.operator&&"Identifier"===s.argument.type?this.raiseRecoverable(s.start,"Deleting local variable in strict mode"):t=!0,n=this.finishNode(s,a?"UpdateExpression":"UnaryExpression")}else{if(n=this.parseExprSubscripts(e),this.checkExpressionErrors(e))return n;for(;this.type.postfix&&!this.canInsertSemicolon();){var o=this.startNodeAt(r,i);o.operator=this.value,o.prefix=!1,o.argument=n,this.checkLVal(n),this.next(),n=this.finishNode(o,"UpdateExpression")}}return!t&&this.eat(y.starstar)?this.buildBinary(r,i,n,this.parseMaybeUnary(null,!1),"**",!1):n},Q.parseExprSubscripts=function(e){var t=this.start,n=this.startLoc,r=this.parseExprAtom(e);if("ArrowFunctionExpression"===r.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd))return r;var i=this.parseSubscripts(r,t,n);return e&&"MemberExpression"===i.type&&(e.parenthesizedAssign>=i.start&&(e.parenthesizedAssign=-1),e.parenthesizedBind>=i.start&&(e.parenthesizedBind=-1)),i},Q.parseSubscripts=function(e,t,n,r){for(var i=this.options.ecmaVersion>=8&&"Identifier"===e.type&&"async"===e.name&&this.lastTokEnd===e.end&&!this.canInsertSemicolon()&&e.end-e.start==5&&this.potentialArrowAt===e.start,s=!1;;){var a=this.parseSubscript(e,t,n,r,i,s);if(a.optional&&(s=!0),a===e||"ArrowFunctionExpression"===a.type){if(s){var o=this.startNodeAt(t,n);o.expression=a,a=this.finishNode(o,"ChainExpression")}return a}e=a}},Q.parseSubscript=function(e,t,n,r,i,s){var a=this.options.ecmaVersion>=11,o=a&&this.eat(y.questionDot);r&&o&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var u=this.eat(y.bracketL);if(u||o&&this.type!==y.parenL&&this.type!==y.backQuote||this.eat(y.dot)){var c=this.startNodeAt(t,n);c.object=e,c.property=u?this.parseExpression():this.parseIdent("never"!==this.options.allowReserved),c.computed=!!u,u&&this.expect(y.bracketR),a&&(c.optional=o),e=this.finishNode(c,"MemberExpression")}else if(!r&&this.eat(y.parenL)){var l=new G,p=this.yieldPos,h=this.awaitPos,d=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var f=this.parseExprList(y.parenR,this.options.ecmaVersion>=8,!1,l);if(i&&!o&&!this.canInsertSemicolon()&&this.eat(y.arrow))return this.checkPatternErrors(l,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=p,this.awaitPos=h,this.awaitIdentPos=d,this.parseArrowExpression(this.startNodeAt(t,n),f,!0);this.checkExpressionErrors(l,!0),this.yieldPos=p||this.yieldPos,this.awaitPos=h||this.awaitPos,this.awaitIdentPos=d||this.awaitIdentPos;var m=this.startNodeAt(t,n);m.callee=e,m.arguments=f,a&&(m.optional=o),e=this.finishNode(m,"CallExpression")}else if(this.type===y.backQuote){(o||s)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var _=this.startNodeAt(t,n);_.tag=e,_.quasi=this.parseTemplate({isTagged:!0}),e=this.finishNode(_,"TaggedTemplateExpression")}return e},Q.parseExprAtom=function(e){this.type===y.slash&&this.readRegexp();var t,n=this.potentialArrowAt===this.start;switch(this.type){case y._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),t=this.startNode(),this.next(),this.type!==y.parenL||this.allowDirectSuper||this.raise(t.start,"super() call outside constructor of a subclass"),this.type!==y.dot&&this.type!==y.bracketL&&this.type!==y.parenL&&this.unexpected(),this.finishNode(t,"Super");case y._this:return t=this.startNode(),this.next(),this.finishNode(t,"ThisExpression");case y.name:var r=this.start,i=this.startLoc,s=this.containsEsc,a=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!s&&"async"===a.name&&!this.canInsertSemicolon()&&this.eat(y._function))return this.parseFunction(this.startNodeAt(r,i),0,!1,!0);if(n&&!this.canInsertSemicolon()){if(this.eat(y.arrow))return this.parseArrowExpression(this.startNodeAt(r,i),[a],!1);if(this.options.ecmaVersion>=8&&"async"===a.name&&this.type===y.name&&!s)return a=this.parseIdent(!1),!this.canInsertSemicolon()&&this.eat(y.arrow)||this.unexpected(),this.parseArrowExpression(this.startNodeAt(r,i),[a],!0)}return a;case y.regexp:var o=this.value;return(t=this.parseLiteral(o.value)).regex={pattern:o.pattern,flags:o.flags},t;case y.num:case y.string:return this.parseLiteral(this.value);case y._null:case y._true:case y._false:return(t=this.startNode()).value=this.type===y._null?null:this.type===y._true,t.raw=this.type.keyword,this.next(),this.finishNode(t,"Literal");case y.parenL:var u=this.start,c=this.parseParenAndDistinguishExpression(n);return e&&(e.parenthesizedAssign<0&&!this.isSimpleAssignTarget(c)&&(e.parenthesizedAssign=u),e.parenthesizedBind<0&&(e.parenthesizedBind=u)),c;case y.bracketL:return t=this.startNode(),this.next(),t.elements=this.parseExprList(y.bracketR,!0,!0,e),this.finishNode(t,"ArrayExpression");case y.braceL:return this.parseObj(!1,e);case y._function:return t=this.startNode(),this.next(),this.parseFunction(t,0);case y._class:return this.parseClass(this.startNode(),!1);case y._new:return this.parseNew();case y.backQuote:return this.parseTemplate();case y._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.unexpected();default:this.unexpected()}},Q.parseExprImport=function(){var e=this.startNode();this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import");var t=this.parseIdent(!0);switch(this.type){case y.parenL:return this.parseDynamicImport(e);case y.dot:return e.meta=t,this.parseImportMeta(e);default:this.unexpected()}},Q.parseDynamicImport=function(e){if(this.next(),e.source=this.parseMaybeAssign(),!this.eat(y.parenR)){var t=this.start;this.eat(y.comma)&&this.eat(y.parenR)?this.raiseRecoverable(t,"Trailing comma is not allowed in import()"):this.unexpected(t)}return this.finishNode(e,"ImportExpression")},Q.parseImportMeta=function(e){this.next();var t=this.containsEsc;return e.property=this.parseIdent(!0),"meta"!==e.property.name&&this.raiseRecoverable(e.property.start,"The only valid meta property for import is 'import.meta'"),t&&this.raiseRecoverable(e.start,"'import.meta' must not contain escaped characters"),"module"!==this.options.sourceType&&this.raiseRecoverable(e.start,"Cannot use 'import.meta' outside a module"),this.finishNode(e,"MetaProperty")},Q.parseLiteral=function(e){var t=this.startNode();return t.value=e,t.raw=this.input.slice(this.start,this.end),110===t.raw.charCodeAt(t.raw.length-1)&&(t.bigint=t.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(t,"Literal")},Q.parseParenExpression=function(){this.expect(y.parenL);var e=this.parseExpression();return this.expect(y.parenR),e},Q.parseParenAndDistinguishExpression=function(e){var t,n=this.start,r=this.startLoc,i=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var s,a=this.start,o=this.startLoc,u=[],c=!0,l=!1,p=new G,h=this.yieldPos,d=this.awaitPos;for(this.yieldPos=0,this.awaitPos=0;this.type!==y.parenR;){if(c?c=!1:this.expect(y.comma),i&&this.afterTrailingComma(y.parenR,!0)){l=!0;break}if(this.type===y.ellipsis){s=this.start,u.push(this.parseParenItem(this.parseRestBinding())),this.type===y.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}u.push(this.parseMaybeAssign(!1,p,this.parseParenItem))}var f=this.start,m=this.startLoc;if(this.expect(y.parenR),e&&!this.canInsertSemicolon()&&this.eat(y.arrow))return this.checkPatternErrors(p,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=h,this.awaitPos=d,this.parseParenArrowList(n,r,u);u.length&&!l||this.unexpected(this.lastTokStart),s&&this.unexpected(s),this.checkExpressionErrors(p,!0),this.yieldPos=h||this.yieldPos,this.awaitPos=d||this.awaitPos,u.length>1?((t=this.startNodeAt(a,o)).expressions=u,this.finishNodeAt(t,"SequenceExpression",f,m)):t=u[0]}else t=this.parseParenExpression();if(this.options.preserveParens){var _=this.startNodeAt(n,r);return _.expression=t,this.finishNode(_,"ParenthesizedExpression")}return t},Q.parseParenItem=function(e){return e},Q.parseParenArrowList=function(e,t,n){return this.parseArrowExpression(this.startNodeAt(e,t),n)};var Z=[];Q.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var e=this.startNode(),t=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(y.dot)){e.meta=t;var n=this.containsEsc;return e.property=this.parseIdent(!0),"target"!==e.property.name&&this.raiseRecoverable(e.property.start,"The only valid meta property for new is 'new.target'"),n&&this.raiseRecoverable(e.start,"'new.target' must not contain escaped characters"),this.inNonArrowFunction()||this.raiseRecoverable(e.start,"'new.target' can only be used in functions"),this.finishNode(e,"MetaProperty")}var r=this.start,i=this.startLoc,s=this.type===y._import;return e.callee=this.parseSubscripts(this.parseExprAtom(),r,i,!0),s&&"ImportExpression"===e.callee.type&&this.raise(r,"Cannot use new with import()"),this.eat(y.parenL)?e.arguments=this.parseExprList(y.parenR,this.options.ecmaVersion>=8,!1):e.arguments=Z,this.finishNode(e,"NewExpression")},Q.parseTemplateElement=function(e){var t=e.isTagged,n=this.startNode();return this.type===y.invalidTemplate?(t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),n.value={raw:this.value,cooked:null}):n.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),n.tail=this.type===y.backQuote,this.finishNode(n,"TemplateElement")},Q.parseTemplate=function(e){void 0===e&&(e={});var t=e.isTagged;void 0===t&&(t=!1);var n=this.startNode();this.next(),n.expressions=[];var r=this.parseTemplateElement({isTagged:t});for(n.quasis=[r];!r.tail;)this.type===y.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(y.dollarBraceL),n.expressions.push(this.parseExpression()),this.expect(y.braceR),n.quasis.push(r=this.parseTemplateElement({isTagged:t}));return this.next(),this.finishNode(n,"TemplateLiteral")},Q.isAsyncProp=function(e){return!e.computed&&"Identifier"===e.key.type&&"async"===e.key.name&&(this.type===y.name||this.type===y.num||this.type===y.string||this.type===y.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===y.star)&&!x.test(this.input.slice(this.lastTokEnd,this.start))},Q.parseObj=function(e,t){var n=this.startNode(),r=!0,i={};for(n.properties=[],this.next();!this.eat(y.braceR);){if(r)r=!1;else if(this.expect(y.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(y.braceR))break;var s=this.parseProperty(e,t);e||this.checkPropClash(s,i,t),n.properties.push(s)}return this.finishNode(n,e?"ObjectPattern":"ObjectExpression")},Q.parseProperty=function(e,t){var n,r,i,s,a=this.startNode();if(this.options.ecmaVersion>=9&&this.eat(y.ellipsis))return e?(a.argument=this.parseIdent(!1),this.type===y.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(a,"RestElement")):(this.type===y.parenL&&t&&(t.parenthesizedAssign<0&&(t.parenthesizedAssign=this.start),t.parenthesizedBind<0&&(t.parenthesizedBind=this.start)),a.argument=this.parseMaybeAssign(!1,t),this.type===y.comma&&t&&t.trailingComma<0&&(t.trailingComma=this.start),this.finishNode(a,"SpreadElement"));this.options.ecmaVersion>=6&&(a.method=!1,a.shorthand=!1,(e||t)&&(i=this.start,s=this.startLoc),e||(n=this.eat(y.star)));var o=this.containsEsc;return this.parsePropertyName(a),!e&&!o&&this.options.ecmaVersion>=8&&!n&&this.isAsyncProp(a)?(r=!0,n=this.options.ecmaVersion>=9&&this.eat(y.star),this.parsePropertyName(a,t)):r=!1,this.parsePropertyValue(a,e,n,r,i,s,t,o),this.finishNode(a,"Property")},Q.parsePropertyValue=function(e,t,n,r,i,s,a,o){if((n||r)&&this.type===y.colon&&this.unexpected(),this.eat(y.colon))e.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,a),e.kind="init";else if(this.options.ecmaVersion>=6&&this.type===y.parenL)t&&this.unexpected(),e.kind="init",e.method=!0,e.value=this.parseMethod(n,r);else if(t||o||!(this.options.ecmaVersion>=5)||e.computed||"Identifier"!==e.key.type||"get"!==e.key.name&&"set"!==e.key.name||this.type===y.comma||this.type===y.braceR||this.type===y.eq)this.options.ecmaVersion>=6&&!e.computed&&"Identifier"===e.key.type?((n||r)&&this.unexpected(),this.checkUnreserved(e.key),"await"!==e.key.name||this.awaitIdentPos||(this.awaitIdentPos=i),e.kind="init",t?e.value=this.parseMaybeDefault(i,s,e.key):this.type===y.eq&&a?(a.shorthandAssign<0&&(a.shorthandAssign=this.start),e.value=this.parseMaybeDefault(i,s,e.key)):e.value=e.key,e.shorthand=!0):this.unexpected();else{(n||r)&&this.unexpected(),e.kind=e.key.name,this.parsePropertyName(e),e.value=this.parseMethod(!1);var u="get"===e.kind?0:1;if(e.value.params.length!==u){var c=e.value.start;"get"===e.kind?this.raiseRecoverable(c,"getter should have no params"):this.raiseRecoverable(c,"setter should have exactly one param")}else"set"===e.kind&&"RestElement"===e.value.params[0].type&&this.raiseRecoverable(e.value.params[0].start,"Setter cannot use rest params")}},Q.parsePropertyName=function(e){if(this.options.ecmaVersion>=6){if(this.eat(y.bracketL))return e.computed=!0,e.key=this.parseMaybeAssign(),this.expect(y.bracketR),e.key;e.computed=!1}return e.key=this.type===y.num||this.type===y.string?this.parseExprAtom():this.parseIdent("never"!==this.options.allowReserved)},Q.initFunction=function(e){e.id=null,this.options.ecmaVersion>=6&&(e.generator=e.expression=!1),this.options.ecmaVersion>=8&&(e.async=!1)},Q.parseMethod=function(e,t,n){var r=this.startNode(),i=this.yieldPos,s=this.awaitPos,a=this.awaitIdentPos;return this.initFunction(r),this.options.ecmaVersion>=6&&(r.generator=e),this.options.ecmaVersion>=8&&(r.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(64|M(t,r.generator)|(n?128:0)),this.expect(y.parenL),r.params=this.parseBindingList(y.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(r,!1,!0),this.yieldPos=i,this.awaitPos=s,this.awaitIdentPos=a,this.finishNode(r,"FunctionExpression")},Q.parseArrowExpression=function(e,t,n){var r=this.yieldPos,i=this.awaitPos,s=this.awaitIdentPos;return this.enterScope(16|M(n,!1)),this.initFunction(e),this.options.ecmaVersion>=8&&(e.async=!!n),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,e.params=this.toAssignableList(t,!0),this.parseFunctionBody(e,!0,!1),this.yieldPos=r,this.awaitPos=i,this.awaitIdentPos=s,this.finishNode(e,"ArrowFunctionExpression")},Q.parseFunctionBody=function(e,t,n){var r=t&&this.type!==y.braceL,i=this.strict,s=!1;if(r)e.body=this.parseMaybeAssign(),e.expression=!0,this.checkParams(e,!1);else{var a=this.options.ecmaVersion>=7&&!this.isSimpleParamList(e.params);i&&!a||(s=this.strictDirective(this.end))&&a&&this.raiseRecoverable(e.start,"Illegal 'use strict' directive in function with non-simple parameter list");var o=this.labels;this.labels=[],s&&(this.strict=!0),this.checkParams(e,!i&&!s&&!t&&!n&&this.isSimpleParamList(e.params)),this.strict&&e.id&&this.checkLVal(e.id,5),e.body=this.parseBlock(!1,void 0,s&&!i),e.expression=!1,this.adaptDirectivePrologue(e.body.body),this.labels=o}this.exitScope()},Q.isSimpleParamList=function(e){for(var t=0,n=e;t<n.length;t+=1){if("Identifier"!==n[t].type)return!1}return!0},Q.checkParams=function(e,t){for(var n={},r=0,i=e.params;r<i.length;r+=1){var s=i[r];this.checkLVal(s,1,t?null:n)}},Q.parseExprList=function(e,t,n,r){for(var i=[],s=!0;!this.eat(e);){if(s)s=!1;else if(this.expect(y.comma),t&&this.afterTrailingComma(e))break;var a=void 0;n&&this.type===y.comma?a=null:this.type===y.ellipsis?(a=this.parseSpread(r),r&&this.type===y.comma&&r.trailingComma<0&&(r.trailingComma=this.start)):a=this.parseMaybeAssign(!1,r),i.push(a)}return i},Q.checkUnreserved=function(e){var t=e.start,n=e.end,r=e.name;(this.inGenerator&&"yield"===r&&this.raiseRecoverable(t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&"await"===r&&this.raiseRecoverable(t,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(r)&&this.raise(t,"Unexpected keyword '"+r+"'"),this.options.ecmaVersion<6&&-1!==this.input.slice(t,n).indexOf("\\"))||(this.strict?this.reservedWordsStrict:this.reservedWords).test(r)&&(this.inAsync||"await"!==r||this.raiseRecoverable(t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(t,"The keyword '"+r+"' is reserved"))},Q.parseIdent=function(e,t){var n=this.startNode();return this.type===y.name?n.name=this.value:this.type.keyword?(n.name=this.type.keyword,"class"!==n.name&&"function"!==n.name||this.lastTokEnd===this.lastTokStart+1&&46===this.input.charCodeAt(this.lastTokStart)||this.context.pop()):this.unexpected(),this.next(!!e),this.finishNode(n,"Identifier"),e||(this.checkUnreserved(n),"await"!==n.name||this.awaitIdentPos||(this.awaitIdentPos=n.start)),n},Q.parseYield=function(e){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===y.semi||this.canInsertSemicolon()||this.type!==y.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(y.star),t.argument=this.parseMaybeAssign(e)),this.finishNode(t,"YieldExpression")},Q.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var e=this.startNode();return this.next(),e.argument=this.parseMaybeUnary(null,!1),this.finishNode(e,"AwaitExpression")};var ee=V.prototype;ee.raise=function(e,t){var n=L(this.input,e);t+=" ("+n.line+":"+n.column+")";var r=new SyntaxError(t);throw r.pos=e,r.loc=n,r.raisedAt=this.pos,r},ee.raiseRecoverable=ee.raise,ee.curPosition=function(){if(this.options.locations)return new N(this.curLine,this.pos-this.lineStart)};var te=V.prototype,ne=function(e){this.flags=e,this.var=[],this.lexical=[],this.functions=[]};te.enterScope=function(e){this.scopeStack.push(new ne(e))},te.exitScope=function(){this.scopeStack.pop()},te.treatFunctionsAsVarInScope=function(e){return 2&e.flags||!this.inModule&&1&e.flags},te.declareName=function(e,t,n){var r=!1;if(2===t){var i=this.currentScope();r=i.lexical.indexOf(e)>-1||i.functions.indexOf(e)>-1||i.var.indexOf(e)>-1,i.lexical.push(e),this.inModule&&1&i.flags&&delete this.undefinedExports[e]}else if(4===t){this.currentScope().lexical.push(e)}else if(3===t){var s=this.currentScope();r=this.treatFunctionsAsVar?s.lexical.indexOf(e)>-1:s.lexical.indexOf(e)>-1||s.var.indexOf(e)>-1,s.functions.push(e)}else for(var a=this.scopeStack.length-1;a>=0;--a){var o=this.scopeStack[a];if(o.lexical.indexOf(e)>-1&&!(32&o.flags&&o.lexical[0]===e)||!this.treatFunctionsAsVarInScope(o)&&o.functions.indexOf(e)>-1){r=!0;break}if(o.var.push(e),this.inModule&&1&o.flags&&delete this.undefinedExports[e],3&o.flags)break}r&&this.raiseRecoverable(n,"Identifier '"+e+"' has already been declared")},te.checkLocalExport=function(e){-1===this.scopeStack[0].lexical.indexOf(e.name)&&-1===this.scopeStack[0].var.indexOf(e.name)&&(this.undefinedExports[e.name]=e)},te.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},te.currentVarScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(3&t.flags)return t}},te.currentThisScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(3&t.flags&&!(16&t.flags))return t}};var re=function(e,t,n){this.type="",this.start=t,this.end=0,e.options.locations&&(this.loc=new I(e,n)),e.options.directSourceFile&&(this.sourceFile=e.options.directSourceFile),e.options.ranges&&(this.range=[t,0])},ie=V.prototype;function se(e,t,n,r){return e.type=t,e.end=n,this.options.locations&&(e.loc.end=r),this.options.ranges&&(e.range[1]=n),e}ie.startNode=function(){return new re(this,this.start,this.startLoc)},ie.startNodeAt=function(e,t){return new re(this,e,t)},ie.finishNode=function(e,t){return se.call(this,e,t,this.lastTokEnd,this.lastTokEndLoc)},ie.finishNodeAt=function(e,t,n,r){return se.call(this,e,t,n,r)};var ae=function(e,t,n,r,i){this.token=e,this.isExpr=!!t,this.preserveSpace=!!n,this.override=r,this.generator=!!i},oe={b_stat:new ae("{",!1),b_expr:new ae("{",!0),b_tmpl:new ae("${",!1),p_stat:new ae("(",!1),p_expr:new ae("(",!0),q_tmpl:new ae("`",!0,!0,(function(e){return e.tryReadTemplateToken()})),f_stat:new ae("function",!1),f_expr:new ae("function",!0),f_expr_gen:new ae("function",!0,!1,null,!0),f_gen:new ae("function",!1,!1,null,!0)},ue=V.prototype;ue.initialContext=function(){return[oe.b_stat]},ue.braceIsBlock=function(e){var t=this.curContext();return t===oe.f_expr||t===oe.f_stat||(e!==y.colon||t!==oe.b_stat&&t!==oe.b_expr?e===y._return||e===y.name&&this.exprAllowed?x.test(this.input.slice(this.lastTokEnd,this.start)):e===y._else||e===y.semi||e===y.eof||e===y.parenR||e===y.arrow||(e===y.braceL?t===oe.b_stat:e!==y._var&&e!==y._const&&e!==y.name&&!this.exprAllowed):!t.isExpr)},ue.inGeneratorContext=function(){for(var e=this.context.length-1;e>=1;e--){var t=this.context[e];if("function"===t.token)return t.generator}return!1},ue.updateContext=function(e){var t,n=this.type;n.keyword&&e===y.dot?this.exprAllowed=!1:(t=n.updateContext)?t.call(this,e):this.exprAllowed=n.beforeExpr},y.parenR.updateContext=y.braceR.updateContext=function(){if(1!==this.context.length){var e=this.context.pop();e===oe.b_stat&&"function"===this.curContext().token&&(e=this.context.pop()),this.exprAllowed=!e.isExpr}else this.exprAllowed=!0},y.braceL.updateContext=function(e){this.context.push(this.braceIsBlock(e)?oe.b_stat:oe.b_expr),this.exprAllowed=!0},y.dollarBraceL.updateContext=function(){this.context.push(oe.b_tmpl),this.exprAllowed=!0},y.parenL.updateContext=function(e){var t=e===y._if||e===y._for||e===y._with||e===y._while;this.context.push(t?oe.p_stat:oe.p_expr),this.exprAllowed=!0},y.incDec.updateContext=function(){},y._function.updateContext=y._class.updateContext=function(e){!e.beforeExpr||e===y.semi||e===y._else||e===y._return&&x.test(this.input.slice(this.lastTokEnd,this.start))||(e===y.colon||e===y.braceL)&&this.curContext()===oe.b_stat?this.context.push(oe.f_stat):this.context.push(oe.f_expr),this.exprAllowed=!1},y.backQuote.updateContext=function(){this.curContext()===oe.q_tmpl?this.context.pop():this.context.push(oe.q_tmpl),this.exprAllowed=!1},y.star.updateContext=function(e){if(e===y._function){var t=this.context.length-1;this.context[t]===oe.f_expr?this.context[t]=oe.f_expr_gen:this.context[t]=oe.f_gen}this.exprAllowed=!0},y.name.updateContext=function(e){var t=!1;this.options.ecmaVersion>=6&&e!==y.dot&&("of"===this.value&&!this.exprAllowed||"yield"===this.value&&this.inGeneratorContext())&&(t=!0),this.exprAllowed=t};var ce="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",le=ce+" Extended_Pictographic",pe={9:ce,10:le,11:le},he="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",de="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",fe=de+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",me={9:de,10:fe,11:fe+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho"},_e={};function De(e){var t=_e[e]={binary:O(pe[e]+" "+he),nonBinary:{General_Category:O(he),Script:O(me[e])}};t.nonBinary.Script_Extensions=t.nonBinary.Script,t.nonBinary.gc=t.nonBinary.General_Category,t.nonBinary.sc=t.nonBinary.Script,t.nonBinary.scx=t.nonBinary.Script_Extensions}De(9),De(10),De(11);var ge=V.prototype,ve=function(e){this.parser=e,this.validFlags="gim"+(e.options.ecmaVersion>=6?"uy":"")+(e.options.ecmaVersion>=9?"s":""),this.unicodeProperties=_e[e.options.ecmaVersion>=11?11:e.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};function be(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}function Ee(e){return 36===e||e>=40&&e<=43||46===e||63===e||e>=91&&e<=94||e>=123&&e<=125}function ye(e){return e>=65&&e<=90||e>=97&&e<=122}function xe(e){return ye(e)||95===e}function Ae(e){return xe(e)||Ce(e)}function Ce(e){return e>=48&&e<=57}function we(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}function Fe(e){return e>=65&&e<=70?e-65+10:e>=97&&e<=102?e-97+10:e-48}function Se(e){return e>=48&&e<=55}ve.prototype.reset=function(e,t,n){var r=-1!==n.indexOf("u");this.start=0|e,this.source=t+"",this.flags=n,this.switchU=r&&this.parser.options.ecmaVersion>=6,this.switchN=r&&this.parser.options.ecmaVersion>=9},ve.prototype.raise=function(e){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+e)},ve.prototype.at=function(e,t){void 0===t&&(t=!1);var n=this.source,r=n.length;if(e>=r)return-1;var i=n.charCodeAt(e);if(!t&&!this.switchU||i<=55295||i>=57344||e+1>=r)return i;var s=n.charCodeAt(e+1);return s>=56320&&s<=57343?(i<<10)+s-56613888:i},ve.prototype.nextIndex=function(e,t){void 0===t&&(t=!1);var n=this.source,r=n.length;if(e>=r)return r;var i,s=n.charCodeAt(e);return!t&&!this.switchU||s<=55295||s>=57344||e+1>=r||(i=n.charCodeAt(e+1))<56320||i>57343?e+1:e+2},ve.prototype.current=function(e){return void 0===e&&(e=!1),this.at(this.pos,e)},ve.prototype.lookahead=function(e){return void 0===e&&(e=!1),this.at(this.nextIndex(this.pos,e),e)},ve.prototype.advance=function(e){void 0===e&&(e=!1),this.pos=this.nextIndex(this.pos,e)},ve.prototype.eat=function(e,t){return void 0===t&&(t=!1),this.current(t)===e&&(this.advance(t),!0)},ge.validateRegExpFlags=function(e){for(var t=e.validFlags,n=e.flags,r=0;r<n.length;r++){var i=n.charAt(r);-1===t.indexOf(i)&&this.raise(e.start,"Invalid regular expression flag"),n.indexOf(i,r+1)>-1&&this.raise(e.start,"Duplicate regular expression flag")}},ge.validateRegExpPattern=function(e){this.regexp_pattern(e),!e.switchN&&this.options.ecmaVersion>=9&&e.groupNames.length>0&&(e.switchN=!0,this.regexp_pattern(e))},ge.regexp_pattern=function(e){e.pos=0,e.lastIntValue=0,e.lastStringValue="",e.lastAssertionIsQuantifiable=!1,e.numCapturingParens=0,e.maxBackReference=0,e.groupNames.length=0,e.backReferenceNames.length=0,this.regexp_disjunction(e),e.pos!==e.source.length&&(e.eat(41)&&e.raise("Unmatched ')'"),(e.eat(93)||e.eat(125))&&e.raise("Lone quantifier brackets")),e.maxBackReference>e.numCapturingParens&&e.raise("Invalid escape");for(var t=0,n=e.backReferenceNames;t<n.length;t+=1){var r=n[t];-1===e.groupNames.indexOf(r)&&e.raise("Invalid named capture referenced")}},ge.regexp_disjunction=function(e){for(this.regexp_alternative(e);e.eat(124);)this.regexp_alternative(e);this.regexp_eatQuantifier(e,!0)&&e.raise("Nothing to repeat"),e.eat(123)&&e.raise("Lone quantifier brackets")},ge.regexp_alternative=function(e){for(;e.pos<e.source.length&&this.regexp_eatTerm(e););},ge.regexp_eatTerm=function(e){return this.regexp_eatAssertion(e)?(e.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(e)&&e.switchU&&e.raise("Invalid quantifier"),!0):!!(e.switchU?this.regexp_eatAtom(e):this.regexp_eatExtendedAtom(e))&&(this.regexp_eatQuantifier(e),!0)},ge.regexp_eatAssertion=function(e){var t=e.pos;if(e.lastAssertionIsQuantifiable=!1,e.eat(94)||e.eat(36))return!0;if(e.eat(92)){if(e.eat(66)||e.eat(98))return!0;e.pos=t}if(e.eat(40)&&e.eat(63)){var n=!1;if(this.options.ecmaVersion>=9&&(n=e.eat(60)),e.eat(61)||e.eat(33))return this.regexp_disjunction(e),e.eat(41)||e.raise("Unterminated group"),e.lastAssertionIsQuantifiable=!n,!0}return e.pos=t,!1},ge.regexp_eatQuantifier=function(e,t){return void 0===t&&(t=!1),!!this.regexp_eatQuantifierPrefix(e,t)&&(e.eat(63),!0)},ge.regexp_eatQuantifierPrefix=function(e,t){return e.eat(42)||e.eat(43)||e.eat(63)||this.regexp_eatBracedQuantifier(e,t)},ge.regexp_eatBracedQuantifier=function(e,t){var n=e.pos;if(e.eat(123)){var r=0,i=-1;if(this.regexp_eatDecimalDigits(e)&&(r=e.lastIntValue,e.eat(44)&&this.regexp_eatDecimalDigits(e)&&(i=e.lastIntValue),e.eat(125)))return-1!==i&&i<r&&!t&&e.raise("numbers out of order in {} quantifier"),!0;e.switchU&&!t&&e.raise("Incomplete quantifier"),e.pos=n}return!1},ge.regexp_eatAtom=function(e){return this.regexp_eatPatternCharacters(e)||e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)},ge.regexp_eatReverseSolidusAtomEscape=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatAtomEscape(e))return!0;e.pos=t}return!1},ge.regexp_eatUncapturingGroup=function(e){var t=e.pos;if(e.eat(40)){if(e.eat(63)&&e.eat(58)){if(this.regexp_disjunction(e),e.eat(41))return!0;e.raise("Unterminated group")}e.pos=t}return!1},ge.regexp_eatCapturingGroup=function(e){if(e.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(e):63===e.current()&&e.raise("Invalid group"),this.regexp_disjunction(e),e.eat(41))return e.numCapturingParens+=1,!0;e.raise("Unterminated group")}return!1},ge.regexp_eatExtendedAtom=function(e){return e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)||this.regexp_eatInvalidBracedQuantifier(e)||this.regexp_eatExtendedPatternCharacter(e)},ge.regexp_eatInvalidBracedQuantifier=function(e){return this.regexp_eatBracedQuantifier(e,!0)&&e.raise("Nothing to repeat"),!1},ge.regexp_eatSyntaxCharacter=function(e){var t=e.current();return!!Ee(t)&&(e.lastIntValue=t,e.advance(),!0)},ge.regexp_eatPatternCharacters=function(e){for(var t=e.pos,n=0;-1!==(n=e.current())&&!Ee(n);)e.advance();return e.pos!==t},ge.regexp_eatExtendedPatternCharacter=function(e){var t=e.current();return!(-1===t||36===t||t>=40&&t<=43||46===t||63===t||91===t||94===t||124===t)&&(e.advance(),!0)},ge.regexp_groupSpecifier=function(e){if(e.eat(63)){if(this.regexp_eatGroupName(e))return-1!==e.groupNames.indexOf(e.lastStringValue)&&e.raise("Duplicate capture group name"),void e.groupNames.push(e.lastStringValue);e.raise("Invalid group")}},ge.regexp_eatGroupName=function(e){if(e.lastStringValue="",e.eat(60)){if(this.regexp_eatRegExpIdentifierName(e)&&e.eat(62))return!0;e.raise("Invalid capture group name")}return!1},ge.regexp_eatRegExpIdentifierName=function(e){if(e.lastStringValue="",this.regexp_eatRegExpIdentifierStart(e)){for(e.lastStringValue+=be(e.lastIntValue);this.regexp_eatRegExpIdentifierPart(e);)e.lastStringValue+=be(e.lastIntValue);return!0}return!1},ge.regexp_eatRegExpIdentifierStart=function(e){var t=e.pos,n=this.options.ecmaVersion>=11,r=e.current(n);return e.advance(n),92===r&&this.regexp_eatRegExpUnicodeEscapeSequence(e,n)&&(r=e.lastIntValue),function(e){return f(e,!0)||36===e||95===e}(r)?(e.lastIntValue=r,!0):(e.pos=t,!1)},ge.regexp_eatRegExpIdentifierPart=function(e){var t=e.pos,n=this.options.ecmaVersion>=11,r=e.current(n);return e.advance(n),92===r&&this.regexp_eatRegExpUnicodeEscapeSequence(e,n)&&(r=e.lastIntValue),function(e){return m(e,!0)||36===e||95===e||8204===e||8205===e}(r)?(e.lastIntValue=r,!0):(e.pos=t,!1)},ge.regexp_eatAtomEscape=function(e){return!!(this.regexp_eatBackReference(e)||this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)||e.switchN&&this.regexp_eatKGroupName(e))||(e.switchU&&(99===e.current()&&e.raise("Invalid unicode escape"),e.raise("Invalid escape")),!1)},ge.regexp_eatBackReference=function(e){var t=e.pos;if(this.regexp_eatDecimalEscape(e)){var n=e.lastIntValue;if(e.switchU)return n>e.maxBackReference&&(e.maxBackReference=n),!0;if(n<=e.numCapturingParens)return!0;e.pos=t}return!1},ge.regexp_eatKGroupName=function(e){if(e.eat(107)){if(this.regexp_eatGroupName(e))return e.backReferenceNames.push(e.lastStringValue),!0;e.raise("Invalid named reference")}return!1},ge.regexp_eatCharacterEscape=function(e){return this.regexp_eatControlEscape(e)||this.regexp_eatCControlLetter(e)||this.regexp_eatZero(e)||this.regexp_eatHexEscapeSequence(e)||this.regexp_eatRegExpUnicodeEscapeSequence(e,!1)||!e.switchU&&this.regexp_eatLegacyOctalEscapeSequence(e)||this.regexp_eatIdentityEscape(e)},ge.regexp_eatCControlLetter=function(e){var t=e.pos;if(e.eat(99)){if(this.regexp_eatControlLetter(e))return!0;e.pos=t}return!1},ge.regexp_eatZero=function(e){return 48===e.current()&&!Ce(e.lookahead())&&(e.lastIntValue=0,e.advance(),!0)},ge.regexp_eatControlEscape=function(e){var t=e.current();return 116===t?(e.lastIntValue=9,e.advance(),!0):110===t?(e.lastIntValue=10,e.advance(),!0):118===t?(e.lastIntValue=11,e.advance(),!0):102===t?(e.lastIntValue=12,e.advance(),!0):114===t&&(e.lastIntValue=13,e.advance(),!0)},ge.regexp_eatControlLetter=function(e){var t=e.current();return!!ye(t)&&(e.lastIntValue=t%32,e.advance(),!0)},ge.regexp_eatRegExpUnicodeEscapeSequence=function(e,t){void 0===t&&(t=!1);var n,r=e.pos,i=t||e.switchU;if(e.eat(117)){if(this.regexp_eatFixedHexDigits(e,4)){var s=e.lastIntValue;if(i&&s>=55296&&s<=56319){var a=e.pos;if(e.eat(92)&&e.eat(117)&&this.regexp_eatFixedHexDigits(e,4)){var o=e.lastIntValue;if(o>=56320&&o<=57343)return e.lastIntValue=1024*(s-55296)+(o-56320)+65536,!0}e.pos=a,e.lastIntValue=s}return!0}if(i&&e.eat(123)&&this.regexp_eatHexDigits(e)&&e.eat(125)&&((n=e.lastIntValue)>=0&&n<=1114111))return!0;i&&e.raise("Invalid unicode escape"),e.pos=r}return!1},ge.regexp_eatIdentityEscape=function(e){if(e.switchU)return!!this.regexp_eatSyntaxCharacter(e)||!!e.eat(47)&&(e.lastIntValue=47,!0);var t=e.current();return!(99===t||e.switchN&&107===t)&&(e.lastIntValue=t,e.advance(),!0)},ge.regexp_eatDecimalEscape=function(e){e.lastIntValue=0;var t=e.current();if(t>=49&&t<=57){do{e.lastIntValue=10*e.lastIntValue+(t-48),e.advance()}while((t=e.current())>=48&&t<=57);return!0}return!1},ge.regexp_eatCharacterClassEscape=function(e){var t=e.current();if(function(e){return 100===e||68===e||115===e||83===e||119===e||87===e}(t))return e.lastIntValue=-1,e.advance(),!0;if(e.switchU&&this.options.ecmaVersion>=9&&(80===t||112===t)){if(e.lastIntValue=-1,e.advance(),e.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(e)&&e.eat(125))return!0;e.raise("Invalid property name")}return!1},ge.regexp_eatUnicodePropertyValueExpression=function(e){var t=e.pos;if(this.regexp_eatUnicodePropertyName(e)&&e.eat(61)){var n=e.lastStringValue;if(this.regexp_eatUnicodePropertyValue(e)){var r=e.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(e,n,r),!0}}if(e.pos=t,this.regexp_eatLoneUnicodePropertyNameOrValue(e)){var i=e.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(e,i),!0}return!1},ge.regexp_validateUnicodePropertyNameAndValue=function(e,t,n){T(e.unicodeProperties.nonBinary,t)||e.raise("Invalid property name"),e.unicodeProperties.nonBinary[t].test(n)||e.raise("Invalid property value")},ge.regexp_validateUnicodePropertyNameOrValue=function(e,t){e.unicodeProperties.binary.test(t)||e.raise("Invalid property name")},ge.regexp_eatUnicodePropertyName=function(e){var t=0;for(e.lastStringValue="";xe(t=e.current());)e.lastStringValue+=be(t),e.advance();return""!==e.lastStringValue},ge.regexp_eatUnicodePropertyValue=function(e){var t=0;for(e.lastStringValue="";Ae(t=e.current());)e.lastStringValue+=be(t),e.advance();return""!==e.lastStringValue},ge.regexp_eatLoneUnicodePropertyNameOrValue=function(e){return this.regexp_eatUnicodePropertyValue(e)},ge.regexp_eatCharacterClass=function(e){if(e.eat(91)){if(e.eat(94),this.regexp_classRanges(e),e.eat(93))return!0;e.raise("Unterminated character class")}return!1},ge.regexp_classRanges=function(e){for(;this.regexp_eatClassAtom(e);){var t=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassAtom(e)){var n=e.lastIntValue;!e.switchU||-1!==t&&-1!==n||e.raise("Invalid character class"),-1!==t&&-1!==n&&t>n&&e.raise("Range out of order in character class")}}},ge.regexp_eatClassAtom=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatClassEscape(e))return!0;if(e.switchU){var n=e.current();(99===n||Se(n))&&e.raise("Invalid class escape"),e.raise("Invalid escape")}e.pos=t}var r=e.current();return 93!==r&&(e.lastIntValue=r,e.advance(),!0)},ge.regexp_eatClassEscape=function(e){var t=e.pos;if(e.eat(98))return e.lastIntValue=8,!0;if(e.switchU&&e.eat(45))return e.lastIntValue=45,!0;if(!e.switchU&&e.eat(99)){if(this.regexp_eatClassControlLetter(e))return!0;e.pos=t}return this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)},ge.regexp_eatClassControlLetter=function(e){var t=e.current();return!(!Ce(t)&&95!==t)&&(e.lastIntValue=t%32,e.advance(),!0)},ge.regexp_eatHexEscapeSequence=function(e){var t=e.pos;if(e.eat(120)){if(this.regexp_eatFixedHexDigits(e,2))return!0;e.switchU&&e.raise("Invalid escape"),e.pos=t}return!1},ge.regexp_eatDecimalDigits=function(e){var t=e.pos,n=0;for(e.lastIntValue=0;Ce(n=e.current());)e.lastIntValue=10*e.lastIntValue+(n-48),e.advance();return e.pos!==t},ge.regexp_eatHexDigits=function(e){var t=e.pos,n=0;for(e.lastIntValue=0;we(n=e.current());)e.lastIntValue=16*e.lastIntValue+Fe(n),e.advance();return e.pos!==t},ge.regexp_eatLegacyOctalEscapeSequence=function(e){if(this.regexp_eatOctalDigit(e)){var t=e.lastIntValue;if(this.regexp_eatOctalDigit(e)){var n=e.lastIntValue;t<=3&&this.regexp_eatOctalDigit(e)?e.lastIntValue=64*t+8*n+e.lastIntValue:e.lastIntValue=8*t+n}else e.lastIntValue=t;return!0}return!1},ge.regexp_eatOctalDigit=function(e){var t=e.current();return Se(t)?(e.lastIntValue=t-48,e.advance(),!0):(e.lastIntValue=0,!1)},ge.regexp_eatFixedHexDigits=function(e,t){var n=e.pos;e.lastIntValue=0;for(var r=0;r<t;++r){var i=e.current();if(!we(i))return e.pos=n,!1;e.lastIntValue=16*e.lastIntValue+Fe(i),e.advance()}return!0};var ke=function(e){this.type=e.type,this.value=e.value,this.start=e.start,this.end=e.end,e.options.locations&&(this.loc=new I(e,e.startLoc,e.endLoc)),e.options.ranges&&(this.range=[e.start,e.end])},Pe=V.prototype;function Te(e){return"function"!=typeof BigInt?null:BigInt(e.replace(/_/g,""))}function Be(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}Pe.next=function(e){!e&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new ke(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},Pe.getToken=function(){return this.next(),new ke(this)},"undefined"!=typeof Symbol&&(Pe[Symbol.iterator]=function(){var e=this;return{next:function(){var t=e.getToken();return{done:t.type===y.eof,value:t}}}}),Pe.curContext=function(){return this.context[this.context.length-1]},Pe.nextToken=function(){var e=this.curContext();return e&&e.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(y.eof):e.override?e.override(this):void this.readToken(this.fullCharCodeAtPos())},Pe.readToken=function(e){return f(e,this.options.ecmaVersion>=6)||92===e?this.readWord():this.getTokenFromCode(e)},Pe.fullCharCodeAtPos=function(){var e=this.input.charCodeAt(this.pos);return e<=55295||e>=57344?e:(e<<10)+this.input.charCodeAt(this.pos+1)-56613888},Pe.skipBlockComment=function(){var e,t=this.options.onComment&&this.curPosition(),n=this.pos,r=this.input.indexOf("*/",this.pos+=2);if(-1===r&&this.raise(this.pos-2,"Unterminated comment"),this.pos=r+2,this.options.locations)for(A.lastIndex=n;(e=A.exec(this.input))&&e.index<this.pos;)++this.curLine,this.lineStart=e.index+e[0].length;this.options.onComment&&this.options.onComment(!0,this.input.slice(n+2,r),n,this.pos,t,this.curPosition())},Pe.skipLineComment=function(e){for(var t=this.pos,n=this.options.onComment&&this.curPosition(),r=this.input.charCodeAt(this.pos+=e);this.pos<this.input.length&&!C(r);)r=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+e,this.pos),t,this.pos,n,this.curPosition())},Pe.skipSpace=function(){e:for(;this.pos<this.input.length;){var e=this.input.charCodeAt(this.pos);switch(e){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(!(e>8&&e<14||e>=5760&&w.test(String.fromCharCode(e))))break e;++this.pos}}},Pe.finishToken=function(e,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var n=this.type;this.type=e,this.value=t,this.updateContext(n)},Pe.readToken_dot=function(){var e=this.input.charCodeAt(this.pos+1);if(e>=48&&e<=57)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===e&&46===t?(this.pos+=3,this.finishToken(y.ellipsis)):(++this.pos,this.finishToken(y.dot))},Pe.readToken_slash=function(){var e=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===e?this.finishOp(y.assign,2):this.finishOp(y.slash,1)},Pe.readToken_mult_modulo_exp=function(e){var t=this.input.charCodeAt(this.pos+1),n=1,r=42===e?y.star:y.modulo;return this.options.ecmaVersion>=7&&42===e&&42===t&&(++n,r=y.starstar,t=this.input.charCodeAt(this.pos+2)),61===t?this.finishOp(y.assign,n+1):this.finishOp(r,n)},Pe.readToken_pipe_amp=function(e){var t=this.input.charCodeAt(this.pos+1);if(t===e){if(this.options.ecmaVersion>=12)if(61===this.input.charCodeAt(this.pos+2))return this.finishOp(y.assign,3);return this.finishOp(124===e?y.logicalOR:y.logicalAND,2)}return 61===t?this.finishOp(y.assign,2):this.finishOp(124===e?y.bitwiseOR:y.bitwiseAND,1)},Pe.readToken_caret=function(){return 61===this.input.charCodeAt(this.pos+1)?this.finishOp(y.assign,2):this.finishOp(y.bitwiseXOR,1)},Pe.readToken_plus_min=function(e){var t=this.input.charCodeAt(this.pos+1);return t===e?45!==t||this.inModule||62!==this.input.charCodeAt(this.pos+2)||0!==this.lastTokEnd&&!x.test(this.input.slice(this.lastTokEnd,this.pos))?this.finishOp(y.incDec,2):(this.skipLineComment(3),this.skipSpace(),this.nextToken()):61===t?this.finishOp(y.assign,2):this.finishOp(y.plusMin,1)},Pe.readToken_lt_gt=function(e){var t=this.input.charCodeAt(this.pos+1),n=1;return t===e?(n=62===e&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+n)?this.finishOp(y.assign,n+1):this.finishOp(y.bitShift,n)):33!==t||60!==e||this.inModule||45!==this.input.charCodeAt(this.pos+2)||45!==this.input.charCodeAt(this.pos+3)?(61===t&&(n=2),this.finishOp(y.relational,n)):(this.skipLineComment(4),this.skipSpace(),this.nextToken())},Pe.readToken_eq_excl=function(e){var t=this.input.charCodeAt(this.pos+1);return 61===t?this.finishOp(y.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===e&&62===t&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(y.arrow)):this.finishOp(61===e?y.eq:y.prefix,1)},Pe.readToken_question=function(){var e=this.options.ecmaVersion;if(e>=11){var t=this.input.charCodeAt(this.pos+1);if(46===t){var n=this.input.charCodeAt(this.pos+2);if(n<48||n>57)return this.finishOp(y.questionDot,2)}if(63===t){if(e>=12)if(61===this.input.charCodeAt(this.pos+2))return this.finishOp(y.assign,3);return this.finishOp(y.coalesce,2)}}return this.finishOp(y.question,1)},Pe.getTokenFromCode=function(e){switch(e){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(y.parenL);case 41:return++this.pos,this.finishToken(y.parenR);case 59:return++this.pos,this.finishToken(y.semi);case 44:return++this.pos,this.finishToken(y.comma);case 91:return++this.pos,this.finishToken(y.bracketL);case 93:return++this.pos,this.finishToken(y.bracketR);case 123:return++this.pos,this.finishToken(y.braceL);case 125:return++this.pos,this.finishToken(y.braceR);case 58:return++this.pos,this.finishToken(y.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(y.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(120===t||88===t)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===t||79===t)return this.readRadixNumber(8);if(98===t||66===t)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(e);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(e);case 124:case 38:return this.readToken_pipe_amp(e);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(e);case 60:case 62:return this.readToken_lt_gt(e);case 61:case 33:return this.readToken_eq_excl(e);case 63:return this.readToken_question();case 126:return this.finishOp(y.prefix,1)}this.raise(this.pos,"Unexpected character '"+Be(e)+"'")},Pe.finishOp=function(e,t){var n=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(e,n)},Pe.readRegexp=function(){for(var e,t,n=this.pos;;){this.pos>=this.input.length&&this.raise(n,"Unterminated regular expression");var r=this.input.charAt(this.pos);if(x.test(r)&&this.raise(n,"Unterminated regular expression"),e)e=!1;else{if("["===r)t=!0;else if("]"===r&&t)t=!1;else if("/"===r&&!t)break;e="\\"===r}++this.pos}var i=this.input.slice(n,this.pos);++this.pos;var s=this.pos,a=this.readWord1();this.containsEsc&&this.unexpected(s);var o=this.regexpState||(this.regexpState=new ve(this));o.reset(n,i,a),this.validateRegExpFlags(o),this.validateRegExpPattern(o);var u=null;try{u=new RegExp(i,a)}catch(e){}return this.finishToken(y.regexp,{pattern:i,flags:a,value:u})},Pe.readInt=function(e,t,n){for(var r=this.options.ecmaVersion>=12&&void 0===t,i=n&&48===this.input.charCodeAt(this.pos),s=this.pos,a=0,o=0,u=0,c=null==t?1/0:t;u<c;++u,++this.pos){var l=this.input.charCodeAt(this.pos),p=void 0;if(r&&95===l)i&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),95===o&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),0===u&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),o=l;else{if((p=l>=97?l-97+10:l>=65?l-65+10:l>=48&&l<=57?l-48:1/0)>=e)break;o=l,a=a*e+p}}return r&&95===o&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===s||null!=t&&this.pos-s!==t?null:a},Pe.readRadixNumber=function(e){var t=this.pos;this.pos+=2;var n=this.readInt(e);return null==n&&this.raise(this.start+2,"Expected number in radix "+e),this.options.ecmaVersion>=11&&110===this.input.charCodeAt(this.pos)?(n=Te(this.input.slice(t,this.pos)),++this.pos):f(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(y.num,n)},Pe.readNumber=function(e){var t=this.pos;e||null!==this.readInt(10,void 0,!0)||this.raise(t,"Invalid number");var n=this.pos-t>=2&&48===this.input.charCodeAt(t);n&&this.strict&&this.raise(t,"Invalid number");var r=this.input.charCodeAt(this.pos);if(!n&&!e&&this.options.ecmaVersion>=11&&110===r){var i=Te(this.input.slice(t,this.pos));return++this.pos,f(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(y.num,i)}n&&/[89]/.test(this.input.slice(t,this.pos))&&(n=!1),46!==r||n||(++this.pos,this.readInt(10),r=this.input.charCodeAt(this.pos)),69!==r&&101!==r||n||(43!==(r=this.input.charCodeAt(++this.pos))&&45!==r||++this.pos,null===this.readInt(10)&&this.raise(t,"Invalid number")),f(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var s,a=(s=this.input.slice(t,this.pos),n?parseInt(s,8):parseFloat(s.replace(/_/g,"")));return this.finishToken(y.num,a)},Pe.readCodePoint=function(){var e;if(123===this.input.charCodeAt(this.pos)){this.options.ecmaVersion<6&&this.unexpected();var t=++this.pos;e=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,e>1114111&&this.invalidStringToken(t,"Code point out of bounds")}else e=this.readHexChar(4);return e},Pe.readString=function(e){for(var t="",n=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var r=this.input.charCodeAt(this.pos);if(r===e)break;92===r?(t+=this.input.slice(n,this.pos),t+=this.readEscapedChar(!1),n=this.pos):(C(r,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(n,this.pos++),this.finishToken(y.string,t)};var Oe={};Pe.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(e){if(e!==Oe)throw e;this.readInvalidTemplateToken()}this.inTemplateElement=!1},Pe.invalidStringToken=function(e,t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Oe;this.raise(e,t)},Pe.readTmplToken=function(){for(var e="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var n=this.input.charCodeAt(this.pos);if(96===n||36===n&&123===this.input.charCodeAt(this.pos+1))return this.pos!==this.start||this.type!==y.template&&this.type!==y.invalidTemplate?(e+=this.input.slice(t,this.pos),this.finishToken(y.template,e)):36===n?(this.pos+=2,this.finishToken(y.dollarBraceL)):(++this.pos,this.finishToken(y.backQuote));if(92===n)e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!0),t=this.pos;else if(C(n)){switch(e+=this.input.slice(t,this.pos),++this.pos,n){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:e+="\n";break;default:e+=String.fromCharCode(n)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}},Pe.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if("{"!==this.input[this.pos+1])break;case"`":return this.finishToken(y.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},Pe.readEscapedChar=function(e){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Be(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(e){var n=this.pos-1;return this.invalidStringToken(n,"Invalid escape sequence in template string"),null}default:if(t>=48&&t<=55){var r=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],i=parseInt(r,8);return i>255&&(r=r.slice(0,-1),i=parseInt(r,8)),this.pos+=r.length-1,t=this.input.charCodeAt(this.pos),"0"===r&&56!==t&&57!==t||!this.strict&&!e||this.invalidStringToken(this.pos-1-r.length,e?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(i)}return C(t)?"":String.fromCharCode(t)}},Pe.readHexChar=function(e){var t=this.pos,n=this.readInt(16,e);return null===n&&this.invalidStringToken(t,"Bad character escape sequence"),n},Pe.readWord1=function(){this.containsEsc=!1;for(var e="",t=!0,n=this.pos,r=this.options.ecmaVersion>=6;this.pos<this.input.length;){var i=this.fullCharCodeAtPos();if(m(i,r))this.pos+=i<=65535?1:2;else{if(92!==i)break;this.containsEsc=!0,e+=this.input.slice(n,this.pos);var s=this.pos;117!==this.input.charCodeAt(++this.pos)&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var a=this.readCodePoint();(t?f:m)(a,r)||this.invalidStringToken(s,"Invalid Unicode escape"),e+=Be(a),n=this.pos}t=!1}return e+this.input.slice(n,this.pos)},Pe.readWord=function(){var e=this.readWord1(),t=y.name;return this.keywords.test(e)&&(t=b[e]),this.finishToken(t,e)};var Ne="7.4.1";function Ie(e,t){return V.parse(e,t)}function Le(e,t,n){return V.parseExpressionAt(e,t,n)}function Re(e,t){return V.tokenizer(e,t)}V.acorn={Parser:V,version:Ne,defaultOptions:R,Position:N,SourceLocation:I,getLineInfo:L,Node:re,TokenType:_,tokTypes:y,keywordTypes:b,TokContext:ae,tokContexts:oe,isIdentifierChar:m,isIdentifierStart:f,Token:ke,isNewLine:C,lineBreak:x,lineBreakG:A,nonASCIIwhitespace:w}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{__webpack_require__.d(__webpack_exports__,{default:()=>Nn});__webpack_require__(9463),__webpack_require__(2953);const e=(e=>{var t={};return __webpack_require__.d(t,e),t})({addCopyToCodeBlocks:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.addCopyToCodeBlocks,appendMediaToMessage:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.appendMediaToMessage,characters:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.characters,chat:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.chat,chat_metadata:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.chat_metadata,eventSource:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.eventSource,event_types:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.event_types,getCurrentChatId:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.getCurrentChatId,getThumbnailUrl:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.getThumbnailUrl,getUserAvatar:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.getUserAvatar,main_api:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.main_api,messageFormatting:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.messageFormatting,nai_settings:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.nai_settings,name1:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.name1,name2:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.name2,online_status:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.online_status,saveChatConditional:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.saveChatConditional,saveSettingsDebounced:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.saveSettingsDebounced,substituteParams:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.substituteParams,this_chid:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.this_chid,updateMessageBlock:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.updateMessageBlock,user_avatar:()=>__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__.user_avatar});__webpack_require__(7495),__webpack_require__(2480);var t=__webpack_require__(5134),n=__webpack_require__.n(t);const r=(e=>{var t={};return __webpack_require__.d(t,e),t})({executeSlashCommandsWithOptions:()=>__WEBPACK_EXTERNAL_MODULE__slash_commands_js_f5742a84__.executeSlashCommandsWithOptions});__webpack_require__(6910),__webpack_require__(4864),__webpack_require__(5440),__webpack_require__(2762);const i=(e=>{var t={};return __webpack_require__.d(t,e),t})({DEFAULT_DEPTH:()=>__WEBPACK_EXTERNAL_MODULE__world_info_js_83198f57__.DEFAULT_DEPTH,DEFAULT_WEIGHT:()=>__WEBPACK_EXTERNAL_MODULE__world_info_js_83198f57__.DEFAULT_WEIGHT,METADATA_KEY:()=>__WEBPACK_EXTERNAL_MODULE__world_info_js_83198f57__.METADATA_KEY,loadWorldInfo:()=>__WEBPACK_EXTERNAL_MODULE__world_info_js_83198f57__.loadWorldInfo,parseRegexFromString:()=>__WEBPACK_EXTERNAL_MODULE__world_info_js_83198f57__.parseRegexFromString,selected_world_info:()=>__WEBPACK_EXTERNAL_MODULE__world_info_js_83198f57__.selected_world_info,world_info:()=>__WEBPACK_EXTERNAL_MODULE__world_info_js_83198f57__.world_info,world_info_case_sensitive:()=>__WEBPACK_EXTERNAL_MODULE__world_info_js_83198f57__.world_info_case_sensitive,world_info_logic:()=>__WEBPACK_EXTERNAL_MODULE__world_info_js_83198f57__.world_info_logic,world_info_match_whole_words:()=>__WEBPACK_EXTERNAL_MODULE__world_info_js_83198f57__.world_info_match_whole_words,world_info_position:()=>__WEBPACK_EXTERNAL_MODULE__world_info_js_83198f57__.world_info_position,world_info_use_group_scoring:()=>__WEBPACK_EXTERNAL_MODULE__world_info_js_83198f57__.world_info_use_group_scoring,world_names:()=>__WEBPACK_EXTERNAL_MODULE__world_info_js_83198f57__.world_names});const s=(e=>{var t={};return __webpack_require__.d(t,e),t})({power_user:()=>__WEBPACK_EXTERNAL_MODULE__power_user_js_3c7cfb8b__.power_user});const a=(e=>{var t={};return __webpack_require__.d(t,e),t})({copyText:()=>__WEBPACK_EXTERNAL_MODULE__utils_js_d605cabe__.copyText,getCharaFilename:()=>__WEBPACK_EXTERNAL_MODULE__utils_js_d605cabe__.getCharaFilename});const o=(e=>{var t={};return __webpack_require__.d(t,e),t})({getGroupMembers:()=>__WEBPACK_EXTERNAL_MODULE__group_chats_js_678c16bd__.getGroupMembers,groups:()=>__WEBPACK_EXTERNAL_MODULE__group_chats_js_678c16bd__.groups,selected_group:()=>__WEBPACK_EXTERNAL_MODULE__group_chats_js_678c16bd__.selected_group});const u=(e=>{var t={};return __webpack_require__.d(t,e),t})({extension_settings:()=>__WEBPACK_EXTERNAL_MODULE__extensions_js_e625da88__.extension_settings,renderExtensionTemplateAsync:()=>__WEBPACK_EXTERNAL_MODULE__extensions_js_e625da88__.renderExtensionTemplateAsync}),c={"#pt_enabled":{name:"enabled",value:!0},"#pt_generate_enabled":{name:"generate_enabled",value:!0},"#pt_generate_loader_enabled":{name:"generate_loader_enabled",value:!0},"#pt_render_enabled":{name:"render_enabled",value:!0},"#pt_render_loader_enabled":{name:"render_loader_enabled",value:!0},"#pt_with_context_disabled":{name:"with_context_disabled",value:!1},"#pt_debug_enabled":{name:"debug_enabled",value:!1},"#pt_autosave_enabled":{name:"autosave_enabled",value:!1},"#pt_preload_worldinfo":{name:"preload_worldinfo_enabled",value:!0},"#pt_code_blocks":{name:"code_blocks_enabled",value:!0},"#pt_permanent_evaluation":{name:"raw_message_evaluation_enabled",value:!0},"#pt_filter_chat_message":{name:"filter_message_enabled",value:!0},"#pt_cache_enabled":{name:"cache_enabled",value:0},"#pt_cache_size":{name:"cache_size",value:64},"#pt_cache_hasher":{name:"cache_hasher",value:"h32ToString"},"#pt_inject_loader_enabled":{name:"inject_loader_enabled",value:!1},"#pt_invert_enabled":{name:"invert_enabled",value:!0},"#pt_chat_depth":{name:"depth_limit",value:-1},"#pt_compile_workers":{name:"compile_workers",value:!1},"#pt_sandbox":{name:"sandbox",value:!0}},l={};function p(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];u.extension_settings.EjsTemplate||(u.extension_settings.EjsTemplate={},t=!0);for(const[e,i]of Object.entries(c)){var n,r;if(t)u.extension_settings.EjsTemplate[i.name]=i.value,l[i.name]=i.value;else u.extension_settings.EjsTemplate[i.name]=null!==(n=f(e))&&void 0!==n?n:i.value,l[i.name]=null!==(r=f(e))&&void 0!==r?r:i.value}t&&(h(),(0,e.saveSettingsDebounced)())}function h(){for(const[r,i]of Object.entries(c)){var e,t,n;l[i.name]=null!==(e=null!==(t=null===(n=u.extension_settings.EjsTemplate)||void 0===n?void 0:n[i.name])&&void 0!==t?t:l[i.name])&&void 0!==e?e:i.value,m(r,l[i.name])}}function d(){p()}function f(e){const t=c[e];return"boolean"==typeof(null==t?void 0:t.value)?$(e).prop("checked"):"number"==typeof(null==t?void 0:t.value)?Number($(e).val()):$(e).val()}function m(e,t){const n=c[e];"boolean"==typeof(null==n?void 0:n.value)?$(e).prop("checked",null!=t?t:n.value):($(e).val(null!=t?t:null==n?void 0:n.value),$('*[data-for="'.concat(e.slice(1),'"]')).val(null!=t?t:null==n?void 0:n.value))}__webpack_require__(9479);const D=new Uint8Array([0,97,115,109,1,0,0,0,1,48,8,96,3,127,127,127,1,127,96,3,127,127,127,0,96,2,127,127,0,96,1,127,1,127,96,3,127,127,126,1,126,96,3,126,127,127,1,126,96,2,127,126,0,96,1,127,1,126,3,11,10,0,0,2,1,3,4,5,6,1,7,5,3,1,0,1,7,85,9,3,109,101,109,2,0,5,120,120,104,51,50,0,0,6,105,110,105,116,51,50,0,2,8,117,112,100,97,116,101,51,50,0,3,8,100,105,103,101,115,116,51,50,0,4,5,120,120,104,54,52,0,5,6,105,110,105,116,54,52,0,7,8,117,112,100,97,116,101,54,52,0,8,8,100,105,103,101,115,116,54,52,0,9,10,251,22,10,242,1,1,4,127,32,0,32,1,106,33,3,32,1,65,16,79,4,127,32,3,65,16,107,33,6,32,2,65,168,136,141,161,2,106,33,3,32,2,65,137,235,208,208,7,107,33,4,32,2,65,207,140,162,142,6,106,33,5,3,64,32,3,32,0,40,2,0,65,247,148,175,175,120,108,106,65,13,119,65,177,243,221,241,121,108,33,3,32,4,32,0,65,4,106,34,0,40,2,0,65,247,148,175,175,120,108,106,65,13,119,65,177,243,221,241,121,108,33,4,32,2,32,0,65,4,106,34,0,40,2,0,65,247,148,175,175,120,108,106,65,13,119,65,177,243,221,241,121,108,33,2,32,5,32,0,65,4,106,34,0,40,2,0,65,247,148,175,175,120,108,106,65,13,119,65,177,243,221,241,121,108,33,5,32,6,32,0,65,4,106,34,0,79,13,0,11,32,2,65,12,119,32,5,65,18,119,106,32,4,65,7,119,106,32,3,65,1,119,106,5,32,2,65,177,207,217,178,1,106,11,32,1,106,32,0,32,1,65,15,113,16,1,11,146,1,0,32,1,32,2,106,33,2,3,64,32,1,65,4,106,32,2,75,69,4,64,32,0,32,1,40,2,0,65,189,220,202,149,124,108,106,65,17,119,65,175,214,211,190,2,108,33,0,32,1,65,4,106,33,1,12,1,11,11,3,64,32,1,32,2,79,69,4,64,32,0,32,1,45,0,0,65,177,207,217,178,1,108,106,65,11,119,65,177,243,221,241,121,108,33,0,32,1,65,1,106,33,1,12,1,11,11,32,0,32,0,65,15,118,115,65,247,148,175,175,120,108,34,0,65,13,118,32,0,115,65,189,220,202,149,124,108,34,0,65,16,118,32,0,115,11,63,0,32,0,65,8,106,32,1,65,168,136,141,161,2,106,54,2,0,32,0,65,12,106,32,1,65,137,235,208,208,7,107,54,2,0,32,0,65,16,106,32,1,54,2,0,32,0,65,20,106,32,1,65,207,140,162,142,6,106,54,2,0,11,195,4,1,6,127,32,1,32,2,106,33,6,32,0,65,24,106,33,4,32,0,65,40,106,40,2,0,33,3,32,0,32,0,40,2,0,32,2,106,54,2,0,32,0,65,4,106,34,5,32,5,40,2,0,32,2,65,16,79,32,0,40,2,0,65,16,79,114,114,54,2,0,32,2,32,3,106,65,16,73,4,64,32,3,32,4,106,32,1,32,2,252,10,0,0,32,0,65,40,106,32,2,32,3,106,54,2,0,15,11,32,3,4,64,32,3,32,4,106,32,1,65,16,32,3,107,34,2,252,10,0,0,32,0,65,8,106,34,3,32,3,40,2,0,32,4,40,2,0,65,247,148,175,175,120,108,106,65,13,119,65,177,243,221,241,121,108,54,2,0,32,0,65,12,106,34,3,32,3,40,2,0,32,4,65,4,106,40,2,0,65,247,148,175,175,120,108,106,65,13,119,65,177,243,221,241,121,108,54,2,0,32,0,65,16,106,34,3,32,3,40,2,0,32,4,65,8,106,40,2,0,65,247,148,175,175,120,108,106,65,13,119,65,177,243,221,241,121,108,54,2,0,32,0,65,20,106,34,3,32,3,40,2,0,32,4,65,12,106,40,2,0,65,247,148,175,175,120,108,106,65,13,119,65,177,243,221,241,121,108,54,2,0,32,0,65,40,106,65,0,54,2,0,32,1,32,2,106,33,1,11,32,1,32,6,65,16,107,77,4,64,32,6,65,16,107,33,8,32,0,65,8,106,40,2,0,33,2,32,0,65,12,106,40,2,0,33,3,32,0,65,16,106,40,2,0,33,5,32,0,65,20,106,40,2,0,33,7,3,64,32,2,32,1,40,2,0,65,247,148,175,175,120,108,106,65,13,119,65,177,243,221,241,121,108,33,2,32,3,32,1,65,4,106,34,1,40,2,0,65,247,148,175,175,120,108,106,65,13,119,65,177,243,221,241,121,108,33,3,32,5,32,1,65,4,106,34,1,40,2,0,65,247,148,175,175,120,108,106,65,13,119,65,177,243,221,241,121,108,33,5,32,7,32,1,65,4,106,34,1,40,2,0,65,247,148,175,175,120,108,106,65,13,119,65,177,243,221,241,121,108,33,7,32,8,32,1,65,4,106,34,1,79,13,0,11,32,0,65,8,106,32,2,54,2,0,32,0,65,12,106,32,3,54,2,0,32,0,65,16,106,32,5,54,2,0,32,0,65,20,106,32,7,54,2,0,11,32,1,32,6,73,4,64,32,4,32,1,32,6,32,1,107,34,1,252,10,0,0,32,0,65,40,106,32,1,54,2,0,11,11,97,1,1,127,32,0,65,16,106,40,2,0,33,1,32,0,65,4,106,40,2,0,4,127,32,1,65,12,119,32,0,65,20,106,40,2,0,65,18,119,106,32,0,65,12,106,40,2,0,65,7,119,106,32,0,65,8,106,40,2,0,65,1,119,106,5,32,1,65,177,207,217,178,1,106,11,32,0,40,2,0,106,32,0,65,24,106,32,0,65,40,106,40,2,0,16,1,11,255,3,2,3,126,1,127,32,0,32,1,106,33,6,32,1,65,32,79,4,126,32,6,65,32,107,33,6,32,2,66,214,235,130,238,234,253,137,245,224,0,124,33,3,32,2,66,177,169,172,193,173,184,212,166,61,125,33,4,32,2,66,249,234,208,208,231,201,161,228,225,0,124,33,5,3,64,32,3,32,0,41,3,0,66,207,214,211,190,210,199,171,217,66,126,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,3,32,4,32,0,65,8,106,34,0,41,3,0,66,207,214,211,190,210,199,171,217,66,126,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,4,32,2,32,0,65,8,106,34,0,41,3,0,66,207,214,211,190,210,199,171,217,66,126,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,2,32,5,32,0,65,8,106,34,0,41,3,0,66,207,214,211,190,210,199,171,217,66,126,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,5,32,6,32,0,65,8,106,34,0,79,13,0,11,32,2,66,12,137,32,5,66,18,137,124,32,4,66,7,137,124,32,3,66,1,137,124,32,3,66,207,214,211,190,210,199,171,217,66,126,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,133,66,135,149,175,175,152,182,222,155,158,127,126,66,157,163,181,234,131,177,141,138,250,0,125,32,4,66,207,214,211,190,210,199,171,217,66,126,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,133,66,135,149,175,175,152,182,222,155,158,127,126,66,157,163,181,234,131,177,141,138,250,0,125,32,2,66,207,214,211,190,210,199,171,217,66,126,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,133,66,135,149,175,175,152,182,222,155,158,127,126,66,157,163,181,234,131,177,141,138,250,0,125,32,5,66,207,214,211,190,210,199,171,217,66,126,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,133,66,135,149,175,175,152,182,222,155,158,127,126,66,157,163,181,234,131,177,141,138,250,0,125,5,32,2,66,197,207,217,178,241,229,186,234,39,124,11,32,1,173,124,32,0,32,1,65,31,113,16,6,11,134,2,0,32,1,32,2,106,33,2,3,64,32,2,32,1,65,8,106,79,4,64,32,1,41,3,0,66,207,214,211,190,210,199,171,217,66,126,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,32,0,133,66,27,137,66,135,149,175,175,152,182,222,155,158,127,126,66,157,163,181,234,131,177,141,138,250,0,125,33,0,32,1,65,8,106,33,1,12,1,11,11,32,1,65,4,106,32,2,77,4,64,32,0,32,1,53,2,0,66,135,149,175,175,152,182,222,155,158,127,126,133,66,23,137,66,207,214,211,190,210,199,171,217,66,126,66,249,243,221,241,153,246,153,171,22,124,33,0,32,1,65,4,106,33,1,11,3,64,32,1,32,2,73,4,64,32,0,32,1,49,0,0,66,197,207,217,178,241,229,186,234,39,126,133,66,11,137,66,135,149,175,175,152,182,222,155,158,127,126,33,0,32,1,65,1,106,33,1,12,1,11,11,32,0,32,0,66,33,136,133,66,207,214,211,190,210,199,171,217,66,126,34,0,32,0,66,29,136,133,66,249,243,221,241,153,246,153,171,22,126,34,0,32,0,66,32,136,133,11,77,0,32,0,65,8,106,32,1,66,214,235,130,238,234,253,137,245,224,0,124,55,3,0,32,0,65,16,106,32,1,66,177,169,172,193,173,184,212,166,61,125,55,3,0,32,0,65,24,106,32,1,55,3,0,32,0,65,32,106,32,1,66,249,234,208,208,231,201,161,228,225,0,124,55,3,0,11,244,4,2,3,127,4,126,32,1,32,2,106,33,5,32,0,65,40,106,33,4,32,0,65,200,0,106,40,2,0,33,3,32,0,32,0,41,3,0,32,2,173,124,55,3,0,32,2,32,3,106,65,32,73,4,64,32,3,32,4,106,32,1,32,2,252,10,0,0,32,0,65,200,0,106,32,2,32,3,106,54,2,0,15,11,32,3,4,64,32,3,32,4,106,32,1,65,32,32,3,107,34,2,252,10,0,0,32,0,65,8,106,34,3,32,3,41,3,0,32,4,41,3,0,66,207,214,211,190,210,199,171,217,66,126,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,55,3,0,32,0,65,16,106,34,3,32,3,41,3,0,32,4,65,8,106,41,3,0,66,207,214,211,190,210,199,171,217,66,126,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,55,3,0,32,0,65,24,106,34,3,32,3,41,3,0,32,4,65,16,106,41,3,0,66,207,214,211,190,210,199,171,217,66,126,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,55,3,0,32,0,65,32,106,34,3,32,3,41,3,0,32,4,65,24,106,41,3,0,66,207,214,211,190,210,199,171,217,66,126,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,55,3,0,32,0,65,200,0,106,65,0,54,2,0,32,1,32,2,106,33,1,11,32,1,65,32,106,32,5,77,4,64,32,5,65,32,107,33,2,32,0,65,8,106,41,3,0,33,6,32,0,65,16,106,41,3,0,33,7,32,0,65,24,106,41,3,0,33,8,32,0,65,32,106,41,3,0,33,9,3,64,32,6,32,1,41,3,0,66,207,214,211,190,210,199,171,217,66,126,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,6,32,7,32,1,65,8,106,34,1,41,3,0,66,207,214,211,190,210,199,171,217,66,126,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,7,32,8,32,1,65,8,106,34,1,41,3,0,66,207,214,211,190,210,199,171,217,66,126,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,8,32,9,32,1,65,8,106,34,1,41,3,0,66,207,214,211,190,210,199,171,217,66,126,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,9,32,2,32,1,65,8,106,34,1,79,13,0,11,32,0,65,8,106,32,6,55,3,0,32,0,65,16,106,32,7,55,3,0,32,0,65,24,106,32,8,55,3,0,32,0,65,32,106,32,9,55,3,0,11,32,1,32,5,73,4,64,32,4,32,1,32,5,32,1,107,34,1,252,10,0,0,32,0,65,200,0,106,32,1,54,2,0,11,11,188,2,1,5,126,32,0,65,24,106,41,3,0,33,1,32,0,41,3,0,34,2,66,32,90,4,126,32,0,65,8,106,41,3,0,34,3,66,1,137,32,0,65,16,106,41,3,0,34,4,66,7,137,124,32,1,66,12,137,32,0,65,32,106,41,3,0,34,5,66,18,137,124,124,32,3,66,207,214,211,190,210,199,171,217,66,126,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,133,66,135,149,175,175,152,182,222,155,158,127,126,66,157,163,181,234,131,177,141,138,250,0,125,32,4,66,207,214,211,190,210,199,171,217,66,126,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,133,66,135,149,175,175,152,182,222,155,158,127,126,66,157,163,181,234,131,177,141,138,250,0,125,32,1,66,207,214,211,190,210,199,171,217,66,126,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,133,66,135,149,175,175,152,182,222,155,158,127,126,66,157,163,181,234,131,177,141,138,250,0,125,32,5,66,207,214,211,190,210,199,171,217,66,126,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,133,66,135,149,175,175,152,182,222,155,158,127,126,66,157,163,181,234,131,177,141,138,250,0,125,5,32,1,66,197,207,217,178,241,229,186,234,39,124,11,32,2,124,32,0,65,40,106,32,2,66,31,131,167,16,6,11]);const g={xxhash:null};function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4919;if(g.xxhash){if("h32ToString"===l.cache_hasher)return g.xxhash.h32ToString(e,t);if("h64ToString"===l.cache_hasher)return g.xxhash.h64ToString(e,BigInt(t))}return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4919;if(g.xxhash){if("h32ToString"===l.cache_hasher)return g.xxhash.h32(e,t);if("h64ToString"===l.cache_hasher)return Number(g.xxhash.h64(e,BigInt(t)))}let n=5381,r=e.length;for(;r;)n=(n<<5)+n+e.charCodeAt(--r);return 0|n}(e,t).toString(16)}$((async()=>{window.setTimeout((()=>{(async function(){return function(e){const{exports:{mem:t,xxh32:n,xxh64:r,init32:i,update32:s,digest32:a,init64:o,update64:u,digest64:c}}=e;let l=new Uint8Array(t.buffer);function p(e,n){if(t.buffer.byteLength<e+n){const r=Math.ceil((e+n-t.buffer.byteLength)/65536);t.grow(r),l=new Uint8Array(t.buffer)}}function h(e,t,n,r,i,s){p(e);const a=new Uint8Array(e);return l.set(a),n(0,t),a.set(l.subarray(0,e)),{update(t){let n;return l.set(a),"string"==typeof t?(p(3*t.length,e),n=_.encodeInto(t,l.subarray(e)).written):(p(t.byteLength,e),l.set(t,e),n=t.byteLength),r(0,e,n),a.set(l.subarray(0,e)),this},digest:()=>(l.set(a),s(i(0)))}}function d(e){return e>>>0}const f=2n**64n-1n;function m(e){return e&f}const _=new TextEncoder;function D(e,t=0){return p(3*e.length,0),d(n(0,_.encodeInto(e,l).written,t))}function g(e,t=0n){return p(3*e.length,0),m(r(0,_.encodeInto(e,l).written,t))}return{h32:D,h32ToString:(e,t=0)=>D(e,t).toString(16).padStart(8,"0"),h32Raw:(e,t=0)=>(p(e.byteLength,0),l.set(e),d(n(0,e.byteLength,t))),create32:(e=0)=>h(48,e,i,s,a,d),h64:g,h64ToString:(e,t=0n)=>g(e,t).toString(16).padStart(16,"0"),h64Raw:(e,t=0n)=>(p(e.byteLength,0),l.set(e),m(r(0,e.byteLength,t))),create64:(e=0n)=>h(88,e,o,u,c,m)}}((await WebAssembly.instantiate(D)).instance)})().then((e=>{g.xxhash=e,console.log("[Prompt Template] xxhash loaded")})).catch((e=>{console.error("[Prompt Template] cannot load xxhash-wasm"),console.error(e)}))}),100)}));const b={generateRegex:new Map,messageRegex:new Map};function E(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=n.uuid||v("".concat(e,"@").concat(t),195944109);if(n.basic||null==n.basic&&null==n.message&&null==n.generate){if("string"!=typeof t)throw new Error("Basic mode regexes must have a string replace value.");const m=u.extension_settings.regex.find((e=>e.id===r));var i,s,a,o,c,l,p,h,d,f;if(m)m.findRegex=e instanceof RegExp?"/".concat(e.source,"/").concat(e.flags):e,m.replaceString=t,m.placement=_.compact([null===(i=n.user)||void 0===i||i?1:0,null===(s=n.assistant)||void 0===s||s?2:0,null===(a=n.worldinfo)||void 0===a||a?5:0,null===(o=n.reasoning)||void 0===o||o?6:0]);else u.extension_settings.regex.push({id:r,scriptName:"".concat(r),findRegex:e instanceof RegExp?e.source:e,replaceString:t,trimStrings:[],placement:_.compact([null===(c=n.user)||void 0===c||c?1:0,null===(l=n.assistant)||void 0===l||l?2:0,null!==(p=n.worldinfo)&&void 0!==p&&p?5:0,null===(h=n.reasoning)||void 0===h||h?6:0]),disabled:!1,markdownOnly:!1,promptOnly:!0,runOnEdit:!1,substituteRegex:0,minDepth:null!==(d=n.minDepth)&&void 0!==d?d:NaN,maxDepth:null!==(f=n.minDepth)&&void 0!==f?f:NaN})}var m,D,g,E,y,x,A,C,w,F,S,k,P,T,B,O,N,I,L;n.generate&&b.generateRegex.set(r,{search:e,replace:t,user:null===(m=n.user)||void 0===m||m,assistant:null===(D=n.assistant)||void 0===D||D,system:null===(g=n.system)||void 0===g||g,worldinfo:null!==(E=n.worldinfo)&&void 0!==E&&E,order:null!==(y=n.order)&&void 0!==y?y:100,sticky:null!==(x=n.sticky)&&void 0!==x?x:0});n.message&&b.messageRegex.set(r,{search:e,replace:t,user:null===(A=n.user)||void 0===A||A,assistant:null===(C=n.assistant)||void 0===C||C,system:null===(w=n.system)||void 0===w||w,reasoning:null!==(F=n.reasoning)&&void 0!==F&&F,worldinfo:null!==(S=n.worldinfo)&&void 0!==S&&S,order:null!==(k=n.order)&&void 0!==k?k:100,minDepth:null!==(P=n.minDepth)&&void 0!==P?P:NaN,maxDepth:null!==(T=n.minDepth)&&void 0!==T?T:NaN,before:null!==(B=n.before)&&void 0!==B?B:null==(null!==(O=n.after)&&void 0!==O?O:n.html),after:null!==(N=n.after)&&void 0!==N&&N,html:null!==(I=n.html)&&void 0!==I&&I,sticky:null!==(L=n.sticky)&&void 0!==L?L:0})}function y(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(e.uuid){u.extension_settings.regex=u.extension_settings.regex.filter((t=>t.id!==e.uuid));const n=b.generateRegex.get(e.uuid);n&&(n.sticky-=t,n.sticky<=0&&b.generateRegex.delete(e.uuid));const r=b.messageRegex.get(e.uuid);r&&(r.sticky-=t,r.sticky<=0&&b.messageRegex.delete(e.uuid))}else{if(e.basic&&(u.extension_settings.regex=u.extension_settings.regex.filter((e=>!e.scriptName.startsWith("")))),e.generate)for(const[e,n]of Array.from(b.generateRegex.entries()))n.sticky-=t,n.sticky<=0&&b.generateRegex.delete(e);if(e.message)for(const[e,n]of Array.from(b.messageRegex.entries()))n.sticky-=t,n.sticky<=0&&b.messageRegex.delete(e)}}function x(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(n.uuid){const e=b.messageRegex.get(n.uuid);e&&(t=t.replace(e.search,e.replace));const r=b.generateRegex.get(n.uuid);r&&(t=t.replace(r.search,r.replace))}else{if(n.message)for(const r of Array.from(b.messageRegex.values()).sort(((e,t)=>e.order-t.order)))if((!n.assistant||!1!==r.assistant)&&(!n.user||!1!==r.user)&&(!n.system||!1!==r.system)&&(!n.reasoning||r.reasoning)&&(!n.worldinfo||r.worldinfo)&&(!n.before||r.before)&&(!n.after||r.after)&&(!n.html||r.html)){if(Number.isSafeInteger(n.depth)){if(r.minDepth>=-1&&n.depth<r.minDepth)continue;if(r.maxDepth>=0&&n.depth>r.maxDepth)continue}t=t.replace(r.search,"function"==typeof r.replace?r.replace.bind(e):r.replace)}if(n.generate)for(const r of Array.from(b.generateRegex.values()).sort(((e,t)=>e.order-t.order)))"user"===n.role&&!1===r.user||"assistant"===n.role&&!1===r.assistant||"system"===n.role&&!1===r.system||n.worldinfo&&!r.worldinfo||(t=t.replace(r.search,"function"==typeof r.replace?r.replace.bind(e):r.replace))}return t}function A(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=document.createElement("iframe");r.style.width="100%",r.style.height="300px",r.style.border="none",r.scrolling="no",Object.entries(n).forEach((e=>{let[t,n]=e;return r.setAttribute(t,n)})),r.id="iframe-"+Math.random().toString(36).substring(2,15);const i=(new DOMParser).parseFromString(e,"text/html"),s=i.createElement("script");return s.defer=!0,s.textContent="\n        (() => {\n            const iframeId = '".concat(r.id,"';\n            let lastHeight = 0;\n            let rafId;\n            let idleFrames = 0;\n            const IDLE_FRAMES_LIMIT = 5; // Stop checking after 5 frames of no size change\n\n            // Function to send the size to the parent window\n            function postSize(height) {\n                window.parent.postMessage({\n                    type: 'iframeResize',\n                    height: height,\n                    // width is often less critical to sync, but can be included\n                    // width: document.body.scrollWidth,\n                    id: iframeId,\n                }, '*'); // Use '*' for broad compatibility, or specify the parent origin for security\n            }\n\n            // The core update loop, runs on each animation frame\n            function updateLoop() {\n                const newHeight = document.body.scrollHeight;\n\n                if (newHeight !== lastHeight) {\n                    lastHeight = newHeight;\n                    postSize(newHeight);\n                    idleFrames = 0; // Reset idle counter on change\n                } else {\n                    idleFrames++; // Increment idle counter if no change\n                }\n\n                // If the size hasn't changed for a few frames, stop the loop to save CPU\n                if (idleFrames < IDLE_FRAMES_LIMIT) {\n                    rafId = requestAnimationFrame(updateLoop);\n                } else {\n                    rafId = null; // Mark the loop as stopped\n                }\n            }\n\n            // Function to schedule an update check. This is our trigger.\n            function scheduleUpdate() {\n                // If a loop is already running, do nothing.\n                // If it's stopped, start it again.\n                if (!rafId) {\n                    idleFrames = 0; // Reset counter\n                    rafId = requestAnimationFrame(updateLoop);\n                }\n            }\n            \n            // This observer now acts as a trigger to START the size checking loop\n            const observer = new MutationObserver(scheduleUpdate);\n            \n            function init() {\n                // Observe the body for any changes that might affect its size\n                observer.observe(document.body, {\n                    childList: true,\n                    subtree: true,\n                    attributes: true,\n                    characterData: true // Important for text changes\n                });\n    \n                // Also trigger on window resize and load\n                window.addEventListener('resize', scheduleUpdate);\n                document.addEventListener('transitionend', scheduleUpdate);\n                \n                // Initial size check\n                scheduleUpdate();\n            }\n\n            // Wait for the body to be ready before starting\n            if (document.body) {\n                init();\n            } else {\n                document.addEventListener('DOMContentLoaded', init);\n            }\n        })();\n    "),i.head.appendChild(s),r.srcdoc=i.documentElement.outerHTML,t?"<details><summary>".concat(t,"</summary>").concat(r.outerHTML,"</details>"):r.outerHTML}window.addEventListener("message",(e=>{if(e.data&&"iframeResize"===e.data.type){const t=document.getElementById(e.data.id);t&&(t.style.height=Math.ceil(e.data.height)+"px")}}));const C=(e=>{var t={};return __webpack_require__.d(t,e),t})({getRegexedString:()=>__WEBPACK_EXTERNAL_MODULE__regex_engine_js_683beba0__.getRegexedString,regex_placement:()=>__WEBPACK_EXTERNAL_MODULE__regex_engine_js_683beba0__.regex_placement});function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}async function k(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};try{var i,s;return await Ct(e,t,F(F({},r),{},{logging:!1,options:F({strict:null!==(i=l.with_context_disabled)&&void 0!==i&&i,debug:null!==(s=l.debug_enabled)&&void 0!==s&&s},r.options||{})}))}catch(t){if(l.debug_enabled){const t=e.split("\n").map(((e,t)=>"".concat(t,": ").concat(e))).join("\n");console.debug("[Prompt Template] handling ".concat(n," errors:\n").concat(t))}t instanceof SyntaxError&&(t.message+=Rt(e)),console.error(t),toastr.error(t.message,"EJS Error",{onclick:()=>(0,a.copyText)("Error: ".concat(t.message,"\n\nPrompt:\n").concat(e,"\n\nSourcecode:\n").concat(t.src)).then((()=>toastr.success("Copied to clipboard!")))})}return null}async function P(t){var n,r;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=U((null!==(n=i.entries)&&void 0!==n?n:await z()).filter((e=>{var t,n,r,s,a;return(e.disable===l.invert_enabled||(null===(t=e.decorators)||void 0===t?void 0:t.includes("@@always_enabled")))&&(e.comment.startsWith(null!==(n=i.comment)&&void 0!==n?n:e.comment+" ")||(null===(r=e.decorators)||void 0===r?void 0:r.includes(null!==(s=i.decorator)&&void 0!==s?s:" ")))&&(i.preload||!(null!==(a=e.decorators)&&void 0!==a&&a.includes("@@only_preload")))})),null!==(r=i.content)&&void 0!==r?r:"",{vectorized:!1});let a="";for(const n of s){var o,u,c,p,h,d;let r=await k(x(t,(0,e.substituteParams)(n.content),{generate:(null===(o=i.comment)||void 0===o?void 0:o.startsWith("[GENERATE"))||(null===(u=i.decorator)||void 0===u?void 0:u.includes("@@generate"))||!1,message:(null===(c=i.comment)||void 0===c?void 0:c.startsWith("[RENDER"))||(null===(p=i.decorator)||void 0===p?void 0:p.includes("@@render"))||!1,worldinfo:!0,before:!1,html:!0}),_.merge(t,{world_info:n,generateBuffer:null!==(h=i.buffer)&&void 0!==h?h:""}),"worldinfo ".concat(n.world,".").concat(n.comment),F({options:F({filename:"worldinfo/".concat(n.world,"/").concat(n.uid,"-").concat(n.comment),cache:1===l.cache_enabled||2===l.cache_enabled},null!==(d=i.options)&&void 0!==d?d:{})},null!=i?i:{}));if(null!=r){if(null!=i.msgId&&r.trim()){var f,m;if(null!==(f=n.decorators)&&void 0!==f&&f.includes("@@message_formatting")){var D;const t=e.chat[i.msgId];r=(0,e.messageFormatting)(r,null!==(D=t.name)&&void 0!==D?D:"",!!t.is_system,!!t.is_user,i.msgId)}const t=null===(m=n.decorators)||void 0===m?void 0:m.find((e=>e.startsWith("@@iframe")));t&&(r=A(r,t.substring(9),{id:"mes-".concat(i.msgId,"-").concat(n.world,"-").concat(n.uid),"data-worldinfo":n.world,"data-comment":n.comment,"data-uid":n.uid.toString(),loading:"lazy",style:"width: 100%; height: auto; border: none;"}))}a+=r}}return l.debug_enabled?console.debug("[Prompt Template] ".concat(i.comment,"/").concat(i.decorator," worldinfo templates applied.\n"),a,"\n",s):console.debug("[Prompt Template] ".concat(i.comment,"/").concat(i.decorator," worldinfo templates applied.\n"),s),a}async function T(t,n){var r,i;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=t.decorators?t.content:J(t.content)[1];return[null!==(r=await k(x(n,(0,e.substituteParams)((0,C.getRegexedString)(a,C.regex_placement.WORLD_INFO)),{generate:!0}),n,"lore book ".concat(t.world,"/").concat(t.comment,"/").concat(t.uid),F(F({},s),{},{options:F({filename:"worldinfo/".concat(t.world,"/").concat(t.uid,"-").concat(t.comment),cache:1===l.cache_enabled},null!==(i=s.options)&&void 0!==i?i:{})})))&&void 0!==r?r:a,await Promise.all(t.key.map((async e=>{var r;return null!==(r=await k(x(n,a,{generate:!0}),n,"lore book ".concat(t.world,"/").concat(t.comment,"/").concat(t.uid," key ").concat(e),s))&&void 0!==r?r:e}))),await Promise.all(t.keysecondary.map((async e=>{var r;return null!==(r=await k(x(n,a,{generate:!0}),n,"lore book ".concat(t.world,"/").concat(t.comment,"/").concat(t.uid," key ").concat(e),s))&&void 0!==r?r:e})))]}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e,t,n){return t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const I=["@@activate","@@dont_activate","@@message_formatting","@@generate_before","@@generate_after","@@render_before","@@render_after","@@dont_preload","@@initial_variables","@@always_enabled","@@only_preload","@@iframe","@@preprocessing","@@if","@@private"];let L=new Map;async function R(e,t,n){const r=await V(e,"boolean"==typeof t?void 0:t);return r&&(n="boolean"==typeof t?t:n,L.set("".concat(e,".").concat(t),O(O({},r),{},{disable:!1,constant:!!n||r.constant,cooldown:n?0:r.cooldown,delay:n?0:r.delay,vectorized:!n&&r.vectorized,delayUntilRecursion:!n&&r.vectorized,triggers:n?[]:r.triggers,hash:n?Math.random()+1:void 0,content:n?r.content.replace("@@dont_activate",""):r.content,ignoreBudget:n||r.ignoreBudget,group:n?"":r.group})),l.debug_enabled&&(null!=t&&"boolean"!=typeof t?console.log("[Prompt Template] Activated WI entry ".concat(e,".").concat(t," (force: ").concat(n)):console.log("[Prompt Template] Activated WI entry ".concat(e," (force: ").concat(n)))),r}function j(){L.clear()}async function M(t){var n;const r=t||(null===(n=e.characters[e.this_chid])||void 0===n||null===(n=n.data)||void 0===n||null===(n=n.extensions)||void 0===n?void 0:n.world)||s.power_user.persona_description_lorebook||e.chat_metadata[i.METADATA_KEY]||"",a=await(0,i.loadWorldInfo)(r);if(!a)return console.log("[Prompt Template] lorebook not found: ".concat(r," (").concat(t,")")),[];const o=Object.values(a.entries).map((e=>{const t=O({},e);t.uid=Number(e.uid);const[n,i]=J(e.content);return t.decorators=n,t.content=i,t.world=r,t}));return o.sort(H(o))}async function V(e,t){let n=[];null!=t?n=await M(e):(n=await M(),t=e);for(const e of n)if(e.comment===t||e.uid===t||e.comment.match(t))return e;return console.log("[Prompt Template] entry not found: ".concat(t," (").concat(e,")")),null}function U(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=new Set;const a=_.castArray(n).join("\n\n");for(const n of t){var o;if(null!=r.constant&&n.constant!==r.constant)continue;if(null!=r.disabled&&n.disable!==r.disabled)continue;if(null!=r.vectorized&&n.vectorized!==r.vectorized)continue;if(n.useProbability&&n.probability<_.random(1,100))continue;if(n.constant){s.add(n);continue}if(n.decorators.includes("@@activate")){s.add(n);continue}if(n.decorators.includes("@@dont_activate"))continue;if(n.decorators.includes("@@only_preload"))continue;if(!n.key.map((t=>(0,e.substituteParams)(t))).find((e=>q(a,e,n))))continue;if(!(n.selective&&_.isArray(n.keysecondary)&&n.keysecondary.length>0)){s.add(n);continue}const t=null!==(o=n.selectiveLogic)&&void 0!==o?o:0;let u=!1,c=!0;for(const r of n.keysecondary){const o=(0,e.substituteParams)(r),l=o&&q(a,o.trim(),n);if(l&&(u=!0),l||(c=!1),t===i.world_info_logic.AND_ANY&&l){s.add(n);break}if(t===i.world_info_logic.NOT_ALL&&!l){s.add(n);break}}t!==i.world_info_logic.NOT_ANY||u?t===i.world_info_logic.AND_ALL&&c&&s.add(n):s.add(n)}if(s.size<=0)return[];const u=_.groupBy(Array.from(s),(e=>e.group)),c=u[""]||[];if(c.length>0&&_.size(u)<=1)return c.sort(H(c));let l=[];for(const[e,t]of Object.entries(u)){if(""===e)continue;if(1===t.length){l.push(t[0]);continue}if(t.filter((e=>e.groupOverride)).length>0){const e=t.map((e=>e.order)),n=Math.min(...e);if(n){l.push(t[Math.max(e.findIndex((e=>e<=n)),0)]);continue}}if(t.filter((e=>{var t;return null!==(t=e.useGroupScoring)&&void 0!==t?t:i.world_info_use_group_scoring})).length>0){const e=t.map((e=>G(a,e))),n=Math.max(...e);if(n){l.push(t[Math.max(e.findIndex((e=>e>=n)),0)]);continue}}if(t.filter((e=>!e.groupOverride&&!e.useGroupScoring)).length>0){const e=t.map((e=>{var t;return null!==(t=e.groupWeight)&&void 0!==t?t:i.DEFAULT_WEIGHT})),n=_.sum(e);let r=_.random(1,n);const s=e.findIndex((e=>(r-=e)<=0));s>=0&&l.push(t[s])}}const p=c.concat(l);return p.sort(H(p))}function W(e,t){var n;return(null!==(n=t.caseSensitive)&&void 0!==n?n:i.world_info_case_sensitive)?e:e.toLowerCase()}function q(e,t,n){var r;const s=(0,i.parseRegexFromString)(t);if(s)return s.test(e);e=W(e,n);const a=W(t,n);if(!(null!==(r=n.matchWholeWords)&&void 0!==r?r:i.world_info_match_whole_words))return e.includes(a);if(a.split(/\s+/).length>1)return e.includes(a);if(new RegExp("(?:^|\\W)(".concat(_.escapeRegExp(a),")(?:$|\\W)")).test(e))return!0;return!1}function G(e,t){const n=e;let r=0,s=0,a=0,o=0;if(Array.isArray(t.key)){r=t.key.length;for(const e of t.key)q(n,e,t)&&a++}if(Array.isArray(t.keysecondary)){s=t.keysecondary.length;for(const e of t.keysecondary)q(n,e,t)&&o++}if(!r)return 0;if(s>0)switch(t.selectiveLogic){case i.world_info_logic.AND_ANY:return a+o;case i.world_info_logic.AND_ALL:return o===s?a+o:a}return a}function K(){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],u=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],c=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],l=[];if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]){var p;const t=null===(p=e.characters[e.this_chid])||void 0===p||null===(p=p.data)||void 0===p||null===(p=p.extensions)||void 0===p?void 0:p.world;t&&!i.selected_world_info.includes(t)&&l.push(t);for(const e of(0,o.getGroupMembers)()){var h;const t=null==e||null===(h=e.data)||void 0===h||null===(h=h.extensions)||void 0===h?void 0:h.world;t&&!i.selected_world_info.includes(t)&&l.push(t)}}if(t)for(const e of i.selected_world_info)e&&l.push(e);if(n){const t=e.chat_metadata[i.METADATA_KEY],n=s.power_user.persona_description_lorebook;n&&n!==t&&!i.selected_world_info.includes(n)&&l.push(n)}if(r){const t=(0,a.getCharaFilename)(e.this_chid);if(t){var d;const n=null===(d=i.world_info.charLore)||void 0===d?void 0:d.find((e=>e.name===t));if(n&&Array.isArray(n.extraBooks)){var f;const t=null===(f=e.characters[e.this_chid])||void 0===f||null===(f=f.data)||void 0===f||null===(f=f.extensions)||void 0===f?void 0:f.world;for(const e of n.extraBooks)e&&e!==t&&!i.selected_world_info.includes(e)&&l.push(e)}}for(const t of(0,o.getGroupMembers)()){const n=e.characters.findIndex((e=>e.avatar===t.avatar)),r=(0,a.getCharaFilename)(n);if(r){var m;const e=null===(m=i.world_info.charLore)||void 0===m?void 0:m.find((e=>e.name===r));if(e&&Array.isArray(e.extraBooks)){var _;const n=null==t||null===(_=t.data)||void 0===_||null===(_=_.extensions)||void 0===_?void 0:_.world;for(const t of e.extraBooks)t&&t!==n&&!i.selected_world_info.includes(t)&&l.push(t)}}}}if(u){const t=e.chat_metadata[i.METADATA_KEY];t&&!i.selected_world_info.includes(t)&&l.push(t)}return c?l.filter((e=>e&&i.world_names.includes(e))):l}async function z(){let e=[];const t=K(!(arguments.length>0&&void 0!==arguments[0])||arguments[0],!(arguments.length>1&&void 0!==arguments[1])||arguments[1],!(arguments.length>2&&void 0!==arguments[2])||arguments[2],!(arguments.length>3&&void 0!==arguments[3])||arguments[3],!(arguments.length>4&&void 0!==arguments[4])||arguments[4],!(arguments.length>5&&void 0!==arguments[5])||arguments[5]);for(const n of t){const t=await M(n);(null==t?void 0:t.length)>0&&(e=e.concat(t))}return e.sort(H(e))}const X={[i.world_info_position.before]:4,[i.world_info_position.after]:3,[i.world_info_position.EMTop]:2,[i.world_info_position.EMBottom]:1,[i.world_info_position.ANTop]:1,[i.world_info_position.ANBottom]:-1};function H(t){return(n,r)=>function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.DEFAULT_DEPTH;function s(t){var n,s,a;const o=X[t.position];if(null==o)return null!==(n=t.depth)&&void 0!==n?n:i.DEFAULT_DEPTH;if(t.position===i.world_info_position.ANTop||t.position===i.world_info_position.ANBottom)switch(e.chat_metadata.note_position){case 0:case 2:return o+r+X[i.world_info_position.before]+2;case 1:return(null!==(s=e.chat_metadata.note_depth)&&void 0!==s?s:i.DEFAULT_DEPTH)+(null!==(a=t.depth)&&void 0!==a?a:i.DEFAULT_DEPTH)}return o+r}return s(n)-s(t)||t.order-n.order||n.uid-t.uid}(n,r,Math.max(...t.map((e=>e.position===i.world_info_position.atDepth?e.depth:0))))}function J(e){const t=e=>{const t=(e=>{let t=e.startsWith("@@@")?e.substring(1):e;const n=t.indexOf(" ");return-1!==n&&(t=t.substring(0,n)),t})(e);return I.includes(t)};if(!e.startsWith("@@"))return[[],e];const n=e.split("\n"),r=[];let i=0,s=!1;for(let e=0;e<n.length;e++){const a=n[e];if(!a.startsWith("@@")){i=e;break}if(a.startsWith("@@@")&&!s){i=e;break}if(t(a)){const e=a.startsWith("@@@")?a.substring(1):a;r.push(e),s=!1}else s=!0}return[r,n.slice(i).join("\n")]}function Y(e){var t;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=e.comment;if(r.includes("[GENERATE:")||r.includes("[RENDER:")||r.includes("@INJECT")||r.includes("[InitialVariables]"))return!0;const i=(null!==(t=e.decorators)&&void 0!==t?t:J(e.content)[0]).join(",");return!!(i.includes("@@generate")||i.includes("@@render")||i.includes("@@initial_variables"))||!(n||!i.includes("@@only_preload"))}function Q(e){var t;if(e.disable)return!1;if(e.comment.includes("[Preprocessing]"))return!0;return(null!==(t=e.decorators)&&void 0!==t?t:J(e.content)[0]).includes("@@preprocessing")}async function Z(e,t){var n,r;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t.disable)return!1;let s=(null!==(n=t.decorators)&&void 0!==n?n:J(t.content)[0]).find((e=>e.startsWith("@@if")));return!!s&&"false"===await k("<%- !!(".concat(s.substring(4),") %>"),e,"lore book condition ".concat(t.world,"/").concat(t.comment,"/").concat(t.uid),O(O({},i),{},{options:O({filename:"worldinfo/".concat(t.world,"/").concat(t.uid,"-").concat(t.comment,"/condition"),cache:1===l.cache_enabled},null!==(r=i.options)&&void 0!==r?r:{})}))}function ee(e){var t;if(e.disable)return!1;return(null!==(t=e.decorators)&&void 0!==t?t:J(e.content)[0]).includes("@@private")}let te={isDryRun:!1,cacheVars:{},traceId:0,initialVariables:{},isInPlace:!1,messageId:-1,swipeId:-1};function ne(t,n){var r,i,s;if(e.chat.length<1)return te.cacheVars={},te.cacheVars;De(null!=t?t:e.chat.length-1),te.messageId=null!=t?t:e.chat.length-1,te.messageId<0&&(te.messageId=e.chat.length+te.messageId),te.messageId>=e.chat.length&&(te.messageId=e.chat.length-1),te.swipeId=null!==(r=null!=n?n:e.chat[te.messageId].swipe_id)&&void 0!==r?r:0;const a=ge(te.messageId,te.swipeId);return te.cacheVars=_.cloneDeep(Object.assign({},u.extension_settings.variables.global,te.initialVariables,null!==(i=e.chat_metadata.variables)&&void 0!==i?i:{},null!=a?a:{},{_trace_id:te.traceId++,_modify_id:0})),console.debug("[Prompt Template] message #".concat(te.messageId,".").concat(te.swipeId," variables: "),null===(s=e.chat[te.messageId])||void 0===s||null===(s=s.variables)||void 0===s?void 0:s[te.swipeId]),console.debug("[Prompt Template] all variables: ",te.cacheVars),te.cacheVars}function re(t,n,r){var i,s,a;let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=-1;if(void 0!==(null==t?void 0:t.id)?u=t.id>-1?t.id:e.chat.length+t.id:void 0!==(null==t?void 0:t.role)?u=e.chat.findLastIndex((e=>{var n,r;return!(e.is_system!==("system"===t.role)&&e.is_user!==("user"===t.role)&&(e.is_system||e.is_user||"assistant"!==t.role)&&"any"!==t.role||o&&null==(null===(n=e.variables)||void 0===n?void 0:n[null!==(r=e.swipe_id)&&void 0!==r?r:0]))})):void 0===n?u=e.chat.findLastIndex((e=>{var t,n;return!o||null!=(null===(t=e.variables)||void 0===t?void 0:t[null!==(n=e.swipe_id)&&void 0!==n?n:0])})):(n>e.chat.length?n=e.chat.length-1:n<0&&(n=e.chat.length+n),u=n,o&&(u=e.chat.slice(0,n+1).findLastIndex((e=>{var t,n;return null!=(null===(t=e.variables)||void 0===t?void 0:t[null!==(n=e.swipe_id)&&void 0!==n?n:0])})))),u<0||u>=e.chat.length)return console.warn("No message found for filter: ".concat(t)),[void 0,void 0];let c=0;return c=void 0!==(null==t?void 0:t.swipe_id)?t.swipe_id:void 0!==r?r:(null===(i=e.chat[u])||void 0===i?void 0:i.swipe_id)||0,c<0&&(c=((null===(s=e.chat[u])||void 0===s||null===(s=s.swipes)||void 0===s?void 0:s.length)||0)+c),void 0===(null===(a=e.chat[u])||void 0===a||null===(a=a.swipes)||void 0===a?void 0:a[c])?(console.debug("No swipe found for filter: ".concat(t)),[u,c]):(l.debug_enabled&&console.debug("Found message ".concat(u," with swipe ").concat(c," for filter: ").concat(t)),[u,c])}function ie(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r=me(r);const{noCache:i}=r;(i||void 0===(null==this?void 0:this.runID))&&(ne(null==this?void 0:this.message_id),l.debug_enabled&&(console.debug("[Prompt Template] reload variables cache:"),console.debug(te.cacheVars)));const{index:s,scope:a,flags:o,results:c,withMsg:p,merge:h,dryRun:d}=r;if(!d&&te.isDryRun)return;let f,m=n;if(null!=s){let i=JSON.parse(pe(te.cacheVars,t,"{}")),d=Number(s);if(d=Number.isNaN(d)?s:d,"nx"===o&&_.has(i,d))return;if("xx"===o&&!_.has(i,d))return;if("nxs"===o&&void 0!==se.call(this,t,r))return;if("xxs"===o&&void 0===se.call(this,t,r))return;switch(("old"===c||h)&&(f=pe(i,d,void 0)),h&&(m=(void 0===f||_.isArray(f))&&_.isArray(n)?_.concat(null!=f?f:[],n):_.mergeWith(_.cloneDeep(null!=f?f:{}),n,((e,t)=>_.isArray(t)?t:void 0))),void 0===m?_.unset(i,d):_.set(i,d,m),_.set(te.cacheVars,t,JSON.stringify(i)),a||"message"){case"global":i=JSON.parse(_.get(u.extension_settings.variables.global,t,"{}")||"{}"),void 0===m?_.unset(i,d):_.set(i,d,m),_.set(u.extension_settings.variables.global,t,JSON.stringify(i)),l.debug_enabled&&console.debug("Set global variable ".concat(t," to ").concat(m," (index ").concat(d,")"));break;case"local":e.chat_metadata.variables||(e.chat_metadata.variables={}),i=JSON.parse(_.get(e.chat_metadata.variables,t,"{}")||"{}"),void 0===m?_.unset(i,d):_.set(i,d,m),_.set(e.chat_metadata.variables,t,JSON.stringify(i)),l.debug_enabled&&console.debug("Set local variable ".concat(t," to ").concat(m," (index ").concat(d,")"));break;case"message":if(p){const[n,r]=re(p,null==this?void 0:this.message_id,null==this?void 0:this.swipe_id,!1);if(void 0!==n&&void 0!==r){const s=ge(n,r);i=JSON.parse(_.get(s,t,"{}")||"{}"),void 0===m?_.unset(i,d):_.set(i,d,m),_.set(e.chat[n].variables[r],t,JSON.stringify(i)),n===te.messageId&&r===te.swipeId&&_.set(te.cacheVars,t,JSON.stringify(i)),l.debug_enabled&&console.debug("Set message #".concat(n,".").concat(r," variable ").concat(t," to ").concat(m," (index ").concat(d,")"))}}else i=JSON.parse(_.get(te.cacheVars,t,"{}")||"{}"),void 0===m?_.unset(i,d):_.set(i,d,m),_.set(e.chat[te.messageId].variables[te.swipeId],t,JSON.stringify(i)),_.set(te.cacheVars,t,JSON.stringify(i)),l.debug_enabled&&console.debug("Set message variable ".concat(t," to ").concat(m," (index ").concat(d,")"));break;case"initial":i=JSON.parse(_.get(te.initialVariables,t,"{}")||"{}"),void 0===m?_.unset(i,d):_.set(i,d,m),_.set(te.initialVariables,t,JSON.stringify(i)),l.debug_enabled&&console.debug("Set initial variable ".concat(t," to ").concat(m," (index ").concat(d,")"))}te.cacheVars._modify_id=te.cacheVars._modify_id+1||1}else{if("nx"===o&&fe(te.cacheVars,t))return;if("xx"===o&&!fe(te.cacheVars,t))return;if("nxs"===o&&void 0!==se.call(this,t,r))return;if("xxs"===o&&void 0===se.call(this,t,r))return;switch(("old"===c||h)&&(f=pe(te.cacheVars,t,void 0)),h&&(m=(void 0===f||_.isArray(f))&&_.isArray(n)?_.concat(null!=f?f:[],n):_.mergeWith(_.cloneDeep(null!=f?f:{}),n,((e,t)=>_.isArray(t)?t:void 0))),void 0===m?de(te.cacheVars,t):he(te.cacheVars,t,m),a||"message"){case"global":void 0===m?de(u.extension_settings.variables.global,t):he(u.extension_settings.variables.global,t,m),l.debug_enabled&&console.debug("Set global variable ".concat(t," to ").concat(m));break;case"local":e.chat_metadata.variables||(e.chat_metadata.variables={}),void 0===m?de(e.chat_metadata.variables,t):he(e.chat_metadata.variables,t,m),l.debug_enabled&&console.debug("Set local variable ".concat(t," to ").concat(m));break;case"message":if(p){const[n,r]=re(p,null==this?void 0:this.message_id,null==this?void 0:this.swipe_id,!1);void 0!==n&&void 0!==r&&(ge(n,r),void 0===m?(de(e.chat[n].variables[r],t),n===te.messageId&&r===te.swipeId&&de(te.cacheVars,t)):(he(e.chat[n].variables[r],t,m),n===te.messageId&&r===te.swipeId&&he(te.cacheVars,t,m)),l.debug_enabled&&console.debug("Set message #".concat(n,".").concat(r," variable ").concat(t," to ").concat(m)))}else void 0===m?(de(te.cacheVars,t),de(e.chat[te.messageId].variables[te.swipeId],t)):(he(te.cacheVars,t,m),he(e.chat[te.messageId].variables[te.swipeId],t,m)),l.debug_enabled&&console.debug("Set message variable ".concat(t," to ").concat(m));break;case"initial":void 0===m?de(te.initialVariables,t):he(te.initialVariables,t,m),l.debug_enabled&&console.debug("Set initial variable ".concat(t," to ").concat(m))}te.cacheVars._modify_id=te.cacheVars._modify_id+1||1}return"old"===c?f:"fullcache"===c?te.cacheVars:m}function se(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n=me(n);const{noCache:r}=n;(r||void 0===(null==this?void 0:this.runID))&&(ne(null==this?void 0:this.message_id),l.debug_enabled&&(console.debug("[Prompt Template] reload variables cache:"),console.debug(te.cacheVars)));let i=null;const{index:s,scope:a,defaults:o,withMsg:c}=n;switch(a||"cache"){case"global":if(null!=s){const e=JSON.parse(_.get(u.extension_settings.variables.global,t,"{}")||"{}"),n=Number(s);return _.get(e,Number.isNaN(n)?s:n,o)}return i=pe(u.extension_settings.variables.global,t,o),n.clone?_.cloneDeep(i):i;case"local":if(!e.chat_metadata.variables)return o;if(null!=s){const n=JSON.parse(_.get(e.chat_metadata.variables,t,"{}")||"{}"),r=Number(s);return _.get(n,Number.isNaN(r)?s:r,o)}return i=pe(e.chat_metadata.variables,t,o),n.clone?_.cloneDeep(i):i;case"message":if(c){const[r,a]=re(c,null==this?void 0:this.message_id,null==this?void 0:this.swipe_id,!0);if(void 0!==r&&void 0!==a){var p;if(null===(p=e.chat[r])||void 0===p||null===(p=p.variables)||void 0===p||!p[a])return o;if(null!=s){const n=JSON.parse(_.get(e.chat[r].variables[a],t,"{}")||"{}"),i=Number(s);return _.get(n,Number.isNaN(i)?s:i,o)}return i=pe(e.chat[r].variables[a],t,o),n.clone?_.cloneDeep(i):i}return o}if(null!=s){const e=JSON.parse(_.get(te.cacheVars,t,"{}")||"{}"),n=Number(s);return _.get(e,Number.isNaN(n)?s:n,o)}return i=pe(te.cacheVars,t,o),n.clone?_.cloneDeep(i):i;case"initial":if(null!=s){const e=JSON.parse(_.get(te.initialVariables,t,"{}")||"{}"),n=Number(s);return _.get(e,Number.isNaN(n)?s:n,o)}return i=pe(te.initialVariables,t,o),n.clone?_.cloneDeep(i):i}if(null!=s){const e=JSON.parse(_.get(te.cacheVars,t,"{}")||"{}"),n=Number(s);return _.get(e,n,o)}return pe(te.cacheVars,t,o)}function ae(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null==t)return ie.call(this,e,void 0,n);{const r=se.call(this,e,n);if(_.isArray(r)){const i=r.indexOf(t);if(-1!==i)return r.splice(i,1),ie.call(this,e,r,n)}else{if(_.isObject(r))return delete r[t.toString()],ie.call(this,e,r,n);if(_.isString(r)&&_.isString(t)){const i=r.indexOf(t);if(-1!==i)return r.splice(i,t.length),ie.call(this,e,r,n)}}}}function oe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};r=me(r);let i=se.call(this,e,r);if(_.isArray(i))return null==n?i.push(t):(n=Number(n)<0?i.length+Number(n):Number(n),i.splice(n,0,t)),ie.call(this,e,i,r);if(_.isObject(i)&&null!=n){var s,a;const o=i.hasOwnProperty(n.toString());if(null!==(s=r.flags)&&void 0!==s&&s.includes("nx")&&o)return;if(null!==(a=r.flags)&&void 0!==a&&a.includes("xx")&&!o)return;return i[n.toString()]=t,ie.call(this,e,i,r)}if(_.isString(i)){if(null==n)i+=t.toString();else if(_.isString(n)){const e=i.indexOf(n);-1!==e&&i.splice(e,t.toString().length,t.toString())}else n=Number(n)<0?i.length+Number(n):Number(n),i.splice(Number(n),0,t.toString());return ie.call(this,e,i,r)}}function ue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n=me(n);const{noCache:r}=n;(r||void 0===(null==this?void 0:this.runID))&&(ne(null==this?void 0:this.message_id),l.debug_enabled&&(console.debug("[Prompt Template] reload variables cache:"),console.debug(te.cacheVars)));const{index:i,inscope:s,outscope:a,flags:o,defaults:u,results:c,withMsg:p,dryRun:h,min:d,max:f}=n;if("nx"===o&&!_.has(te.cacheVars,e)||"xx"===o&&_.has(te.cacheVars,e)||"nxs"===o&&void 0===se.call(this,e,{index:i,withMsg:p,scope:s})||"xxs"===o&&void 0!==se.call(this,e,{index:i,withMsg:p,scope:s})||"n"===o||void 0===o){let n=se.call(this,e,{index:i,withMsg:p,scope:s,defaults:u||0})+t;return null!=d&&(n=Math.max(n,d)),null!=f&&(n=Math.min(n,f)),ie.call(this,e,n,{index:i,results:c,withMsg:p,dryRun:h,scope:a,flags:"n"})}}function ce(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n=me(n),void 0===(null==this?void 0:this.runID)&&console.warn("setVariable called with invalid context ".concat(this)),ue.call(this,e,-t,n)}async function le(){(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||!1!==l.autosave_enabled)&&await(0,e.saveChatConditional)()}function pe(e,t,n){return null==t?e:_.get(e,t,n)}function he(e,t,n){return null==t?Object.assign(e,n):_.set(e,t,n)}function de(e,t){return null==t?Object.keys(e).forEach((t=>delete e[t])):_.unset(e,t)}function fe(e,t){return null==t?Object.keys(e).length>0:_.has(e,t)}function me(e){if("string"==typeof e)switch(e){case"old":case"new":case"fullcache":return{results:e};case"nx":case"xx":case"nxs":case"xxs":case"n":return{flags:e};case"cache":case"global":case"local":case"message":case"initial":return{scope:e,inscope:e,outscope:e}}return"boolean"==typeof e?{dryRun:e}:e}function _e(t,n){var r,i,s;const a=e.chat.slice(0,t).findLast((e=>{var t,r,i,s;return null!=(null===(t=e.variables)||void 0===t?void 0:t[null!==(r=null==e?void 0:e.swipe_id)&&void 0!==r?r:0])&&(null==n||null!=pe(null===(i=e.variables)||void 0===i?void 0:i[null!==(s=null==e?void 0:e.swipe_id)&&void 0!==s?s:0],n,null))}));return null!==(r=null==a||null===(i=a.variables)||void 0===i?void 0:i[null!==(s=a.swipe_id)&&void 0!==s?s:0])&&void 0!==r?r:{}}function De(t,n){var r,i;if(null==e.chat[t]||null==e.chat[t-1])return!1;const s=e.chat[t];if(n=null!==(r=null!=n?n:s.swipe_id)&&void 0!==r?r:0,null!==(i=s.variables_initialized)&&void 0!==i&&i[n])return!1;const a=ge(t,n),o=_e(t);return s.variables[n]=_.cloneDeep(Object.assign({},o,a)),s.variables_initialized[n]=!0,console.debug("[Prompt Template] clone previous message variables: ",s.variables[n]),!0}function ge(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=e.chat[t];return i?(i.variables?Array.isArray(i.variables)||(i.variables=Object.assign([],i.variables)):i.variables=[],i.variables[n]||(i.variables[n]=r),i.variables_initialized?Array.isArray(i.variables_initialized)||(i.variables_initialized=Object.assign([],i.variables_initialized)):i.variables_initialized=[],i.variables[n]):null}function ve(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.this_chid;if(t=t||e.this_chid,null==t)return null;const n=e.characters[t]||e.characters.find((e=>e.name===t||e.name.match(t)));return n||null}const be="<% if (name) { %><<%- name %>>\n<% if (system_prompt) { %>System: <%- system_prompt %>\n<% } %>name: <%- name %>\n<% if (personality) { %>personality: <%- personality %>\n<% } %><% if (description) { %>description: <%- description %>\n<% } %><% if (message_example) { %>example:\n<%- message_example %>\n<% } %><% if (depth_prompt) { %>System: <%- depth_prompt %>\n<% } %></<%- name %>><% } %>";function Ee(){var t,n;const r=ve(arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.this_chid);if(!r)return null;let i=r.mes_example.trim();return i&&i.startsWith("<START>")&&(i=i.slice(7).trim()),i=i.replace("<START>","```\n```"),i&&i.includes("```")&&(i+="\n```"),{name:r.name,description:r.description,personality:r.personality,scenario:r.scenario,first_message:r.first_mes,message_example:i,creator_notes:r.data.creator_notes,creatorcomment:r.creatorcomment,system_prompt:r.data.system_prompt,post_history_instructions:r.data.post_history_instructions,alternate_greetings:r.data.alternate_greetings,depth_prompt:null==r||null===(t=r.data)||void 0===t?void 0:t.depth_prompt,creator:null==r||null===(n=r.data)||void 0===n?void 0:n.creator}}const ye=(e=>{var t={};return __webpack_require__.d(t,e),t})({getChatCompletionModel:()=>__WEBPACK_EXTERNAL_MODULE__openai_js_bf183548__.getChatCompletionModel,oai_settings:()=>__WEBPACK_EXTERNAL_MODULE__openai_js_bf183548__.oai_settings});function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(n),!0).forEach((function(t){Ce(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ce(e,t,n){return t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function we(t){var n;if(null==t)return"";const r=t.is_user?C.regex_placement.USER_INPUT:C.regex_placement.AI_OUTPUT;return(0,e.substituteParams)((0,C.getRegexedString)(null!==(n=t.mes)&&void 0!==n?n:"",r,{characterOverride:t.name,isPrompt:!0,depth:e.chat.length-t.id-1}))}function Fe(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.chat.length,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;if(null==n){if(t>0)return Object.entries(e.chat).map((e=>{let[t,n]=e;return Ae(Ae({},n),{},{id:Number(t)})})).slice(0,t).map(we);if(t<0)return Object.entries(e.chat).map((e=>{let[t,n]=e;return Ae(Ae({},n),{},{id:Number(t)})})).slice(t).map(we)}else if("string"==typeof n){if(t>0)return Object.entries(e.chat).map((e=>{let[t,n]=e;return Ae(Ae({},n),{},{id:Number(t)})})).filter((e=>"user"===n&&e.is_user||"system"===n&&e.is_system||"assistant"===n&&!e.is_user&&!e.is_system)).slice(0,t).map(we);if(t<0)return Object.entries(e.chat).map((e=>{let[t,n]=e;return Ae(Ae({},n),{},{id:Number(t)})})).filter((e=>"user"===n&&e.is_user||"system"===n&&e.is_system||"assistant"===n&&!e.is_user&&!e.is_system)).slice(t).map(we)}else if("number"==typeof n){if(t>0)return Object.entries(e.chat).map((e=>{let[t,n]=e;return Ae(Ae({},n),{},{id:Number(t)})})).filter((e=>!r||"user"===r&&e.is_user||"system"===r&&e.is_system||"assistant"===r&&!e.is_user&&!e.is_system)).slice(t,n).map(we);if(t<0)return Object.entries(e.chat).map((e=>{let[t,n]=e;return Ae(Ae({},n),{},{id:Number(t)})})).filter((e=>!r||"user"===r&&e.is_user||"system"===r&&e.is_system||"assistant"===r&&!e.is_user&&!e.is_system)).slice(t,n).map(we)}return[]}const Se={faker:void 0};$((async()=>{window.setTimeout((()=>{Promise.resolve().then(__webpack_require__.bind(__webpack_require__,2395)).then((e=>{Se.faker=e,console.log("[Prompt Template] Faker loaded"),console.log(Object.keys(e))})).catch((e=>{console.log("cannot load faker"),console.error(e)}))}),100)}));var ke=__webpack_require__(5233),Pe=__webpack_require__.n(ke);let Te=new Map;function Be(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;for(const t of Array.from(Te.keys())){const n=Te.get(t);if(!n)continue;const r=[];for(const[t,i]of n.entries()){const n=i.sticky-e;n>=0?i.sticky=n:r.push(t)}if(r.length>0)if(r.length===n.size)Te.delete(t);else{for(const e of r)n.delete(e);0===n.size&&Te.delete(t)}}}class Oe extends Error{constructor(e,t){super(`${e} at position ${t}`),this.position=t}}const Ne=32,Ie=10,Le=9,Re=13,je=160,Me=8192,Ve=8202,Ue=8239,We=8287,qe=12288;function Ge(e){return/^[0-9A-Fa-f]$/.test(e)}function Ke(e){return e>="0"&&e<="9"}function ze(e){return e>=" "}function Xe(e){return",:[]/{}()\n+".includes(e)}function He(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||"_"===e||"$"===e}function $e(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||"_"===e||"$"===e||e>="0"&&e<="9"}const Je=/^(http|https|ftp|mailto|file|data|irc):\/\/$/,Ye=/^[A-Za-z0-9-._~:/?#@!$&'()*+;=]$/;function Qe(e){return",[]/{}\n+".includes(e)}function Ze(e){return st(e)||et.test(e)}const et=/^[[{\w-]$/;function tt(e){return"\n"===e||"\r"===e||"\t"===e||"\b"===e||"\f"===e}function nt(e,t){const n=e.charCodeAt(t);return n===Ne||n===Ie||n===Le||n===Re}function rt(e,t){const n=e.charCodeAt(t);return n===Ne||n===Le||n===Re}function it(e,t){const n=e.charCodeAt(t);return n===je||n>=Me&&n<=Ve||n===Ue||n===We||n===qe}function st(e){return at(e)||ut(e)}function at(e){return'"'===e||""===e||""===e}function ot(e){return'"'===e}function ut(e){return"'"===e||""===e||""===e||"`"===e||""===e}function ct(e){return"'"===e}function lt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=e.lastIndexOf(t);return-1!==r?e.substring(0,r)+(n?"":e.substring(r+1)):e}function pt(e,t){let n=e.length;if(!nt(e,n-1))return e+t;for(;nt(e,n-1);)n--;return e.substring(0,n)+t+e.substring(n)}function ht(e,t,n){return e.substring(0,t)+e.substring(t+n)}const dt={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"},ft={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function mt(e){let t=0,n="";u(["```","[```","{```"]);i()||function(){throw new Oe("Unexpected end of json string",e.length)}(),u(["```","```]","```}"]);const r=c(",");for(r&&s(),Ze(e[t])&&function(e){return/[,\n][ \t\r]*$/.test(e)}(n)?(r||(n=pt(n,",")),function(){let e=!0,t=!0;for(;t;){if(e)e=!1;else{c(",")||(n=pt(n,","))}t=i()}t||(n=lt(n,","));n=`[\n${n}\n]`}()):r&&(n=lt(n,","));"}"===e[t]||"]"===e[t];)t++,s();if(t>=e.length)return n;function i(){s();const r=function(){if("{"===e[t]){n+="{",t++,s(),l(",")&&s();let r=!0;for(;t<e.length&&"}"!==e[t];){let a;r?(a=!0,r=!1):(a=c(","),a||(n=pt(n,",")),s()),p();if(!(h()||m(!0))){"}"===e[t]||"{"===e[t]||"]"===e[t]||"["===e[t]||void 0===e[t]?n=lt(n,","):b();break}s();const o=c(":"),u=t>=e.length;o||(Ze(e[t])||u?n=pt(n,":"):E());i()||(o||u?n+="null":E())}return"}"===e[t]?(n+="}",t++):n=pt(n,"}"),!0}return!1}()||function(){if("["===e[t]){n+="[",t++,s(),l(",")&&s();let r=!0;for(;t<e.length&&"]"!==e[t];){if(r)r=!1;else{c(",")||(n=pt(n,","))}p();if(!i()){n=lt(n,",");break}}return"]"===e[t]?(n+="]",t++):n=pt(n,"]"),!0}return!1}()||h()||function(){const r=t;if("-"===e[t]){if(t++,D())return g(r),!0;if(!Ke(e[t]))return t=r,!1}for(;Ke(e[t]);)t++;if("."===e[t]){if(t++,D())return g(r),!0;if(!Ke(e[t]))return t=r,!1;for(;Ke(e[t]);)t++}if("e"===e[t]||"E"===e[t]){if(t++,"-"!==e[t]&&"+"!==e[t]||t++,D())return g(r),!0;if(!Ke(e[t]))return t=r,!1;for(;Ke(e[t]);)t++}if(!D())return t=r,!1;if(t>r){const i=e.slice(r,t),s=/^0\d/.test(i);return n+=s?`"${i}"`:i,!0}return!1}()||f("true","true")||f("false","false")||f("null","null")||f("True","true")||f("False","false")||f("None","null")||m(!1)||function(){if("/"===e[t]){const r=t;for(t++;t<e.length&&("/"!==e[t]||"\\"===e[t-1]);)t++;return t++,n+=`"${e.substring(r,t)}"`,!0}}();return s(),r}function s(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const n=t;let r=a(e);do{r=o(),r&&(r=a(e))}while(r);return t>n}function a(r){const i=r?nt:rt;let s="";for(;;)if(i(e,t))s+=e[t],t++;else{if(!it(e,t))break;s+=" ",t++}return s.length>0&&(n+=s,!0)}function o(){if("/"===e[t]&&"*"===e[t+1]){for(;t<e.length&&!_t(e,t);)t++;return t+=2,!0}if("/"===e[t]&&"/"===e[t+1]){for(;t<e.length&&"\n"!==e[t];)t++;return!0}return!1}function u(n){if(function(n){a(!0);for(const r of n){const n=t+r.length;if(e.slice(t,n)===r)return t=n,!0}return!1}(n)){if(He(e[t]))for(;t<e.length&&$e(e[t]);)t++;return s(),!0}return!1}function c(r){return e[t]===r&&(n+=e[t],t++,!0)}function l(n){return e[t]===n&&(t++,!0)}function p(){return s(),"."===e[t]&&"."===e[t+1]&&"."===e[t+2]&&(t+=3,s(),l(","),!0)}function h(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,a="\\"===e[t];if(a&&(t++,a=!0),st(e[t])){const o=ot(e[t])?ot:ct(e[t])?ct:ut(e[t])?ut:at,u=t,c=n.length;let p='"';for(t++;;){if(t>=e.length){const i=_(t-1);return!r&&Xe(e.charAt(i))?(t=u,n=n.substring(0,c),h(!0)):(p=pt(p,'"'),n+=p,!0)}if(t===i)return p=pt(p,'"'),n+=p,!0;if(o(e[t])){const i=t,a=p.length;if(p+='"',t++,n+=p,s(!1),r||t>=e.length||Xe(e[t])||st(e[t])||Ke(e[t]))return d(),!0;const o=_(i-1),l=e.charAt(o);if(","===l)return t=u,n=n.substring(0,c),h(!1,o);if(Xe(l))return t=u,n=n.substring(0,c),h(!0);n=n.substring(0,c),t=i+1,p=`${p.substring(0,a)}\\${p.substring(a)}`}else{if(r&&Qe(e[t])){if(":"===e[t-1]&&Je.test(e.substring(u+1,t+2)))for(;t<e.length&&Ye.test(e[t]);)p+=e[t],t++;return p=pt(p,'"'),n+=p,d(),!0}if("\\"===e[t]){const n=e.charAt(t+1);if(void 0!==ft[n])p+=e.slice(t,t+2),t+=2;else if("u"===n){let n=2;for(;n<6&&Ge(e[t+n]);)n++;6===n?(p+=e.slice(t,t+6),t+=6):t+n>=e.length?t=e.length:y()}else p+=n,t+=2}else{const n=e.charAt(t);'"'===n&&"\\"!==e[t-1]?(p+=`\\${n}`,t++):tt(n)?(p+=dt[n],t++):(ze(n)||v(n),p+=n,t++)}}a&&l("\\")}}return!1}function d(){let r=!1;for(s();"+"===e[t];){r=!0,t++,s(),n=lt(n,'"',!0);const e=n.length,i=h();n=i?ht(n,e,1):pt(n,'"')}return r}function f(r,i){return e.slice(t,t+r.length)===r&&(n+=i,t+=r.length,!0)}function m(r){const s=t;if(He(e[t])){for(;t<e.length&&$e(e[t]);)t++;let n=t;for(;nt(e,n);)n++;if("("===e[n])return t=n+1,i(),")"===e[t]&&(t++,";"===e[t]&&t++),!0}for(;t<e.length&&!Qe(e[t])&&!st(e[t])&&(!r||":"!==e[t]);)t++;if(":"===e[t-1]&&Je.test(e.substring(s,t+2)))for(;t<e.length&&Ye.test(e[t]);)t++;if(t>s){for(;nt(e,t-1)&&t>0;)t--;const r=e.slice(s,t);return n+="undefined"===r?"null":JSON.stringify(r),'"'===e[t]&&t++,!0}}function _(t){let n=t;for(;n>0&&nt(e,n);)n--;return n}function D(){return t>=e.length||Xe(e[t])||nt(e,t)}function g(r){n+=`${e.slice(r,t)}0`}function v(e){throw new Oe(`Invalid character ${JSON.stringify(e)}`,t)}function b(){throw new Oe("Object key expected",t)}function E(){throw new Oe("Colon expected",t)}function y(){const n=e.slice(t,t+6);throw new Oe(`Invalid unicode character "${n}"`,t)}!function(){throw new Oe(`Unexpected character ${JSON.stringify(e[t])}`,t)}()}function _t(e,t){return"*"===e[t]&&"/"===e[t+1]}function Dt(e){if("string"!=typeof e)throw new Error("Path must be a string.");if(""===e)return[];if("/"!==e.charAt(0))throw new Error('Invalid JSON Pointer: must start with "/".');return e.substring(1).split("/").map((e=>e.replace(/~1/g,"/").replace(/~0/g,"~")))}function gt(e,t){const n=_.cloneDeep(e);for(const r of t){const{op:t,path:i,value:s}=r,a=r.from?Dt(r.from):void 0,o=Dt(i);switch(t){case"set":case"assign":case"add":case"replace":if("-"===o[o.length-1]){const e=o.slice(0,-1),t=_.get(n,e);if(!Array.isArray(t)){toastr.error("Cannot push to a non-array value at path: ".concat(e.join(".")),"JSON Patch");break}t.push(s)}else _.set(n,o,s);break;case"remove":_.unset(n,o)||toastr.warn('Path "'.concat(i,'" could not be removed.'),"JSON Patch");break;case"move":{const e=_.get(n,a);if(_.isUndefined(e)){toastr.error('Cannot move from a non-existent path: "'.concat(r.from,'"'),"JSON Patch");break}_.unset(n,a),_.set(n,o,e);break}case"copy":{const e=_.get(n,a);if(_.isUndefined(e)){toastr.error('Cannot copy from a non-existent path: "'.concat(r.from,'"'),"JSON Patch");break}_.set(n,o,e);break}case"test":{const t=_.get(n,o);if(!_.isEqual(t,s))return toastr.error('Test failed: value at "'.concat(i,'" is not equal to the provided value.')),e;break}default:toastr.warning('Unsupported patch operation: "'.concat(t,'"'),"JSON Patch")}}return n}function vt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=gt(se.call(this,e,n),"string"==typeof t?bt(t):t);return ie.call(this,e,r,n)}function bt(e){return JSON.parse(mt(e))}function Et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(n),!0).forEach((function(t){xt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xt(e,t,n){return t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const At={_,$,toastr,console,getCharaData:ve,getCharData:ve,getWorldInfoData:M,getQuickReplyData:function(e){var t;const n=null===(t=u.extension_settings.quickReplyV2)||void 0===t?void 0:t.config;if(!n)return null;for(const t of n.setList)if(t.set.name===e||t.set.name.match(e))return t;return null},getWorldInfoActivatedData:async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=await M(e);return r?U(r,t,n):[]},getEnabledWorldInfoEntries:z,selectActivatedEntries:U,activewi:R,activateWorldInfo:R,getChatMessage:function(t,n){const r=Object.entries(e.chat).map((e=>{let[t,n]=e;return Ae(Ae({},n),{},{id:Number(t)})})).filter((e=>!n||"user"===n&&e.is_user||"system"===n&&e.is_system||"assistant"===n&&!e.is_user&&!e.is_system));return we(r[t>-1?t:r.length+t])},getChatMessages:Fe,activateRegex:E,injectPrompt:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";Te.has(e)||Te.set(e,new Map),i||(i=v("".concat(e,"#").concat(t),3735928559)),Te.get(e).set(i,{prompt:t,order:n,sticky:r,uid:i})},getPromptsInjected:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=Te.get(e);if(!n)return"";let r=Array.from(n.values()).sort(((e,t)=>e.order-t.order)).map((e=>e.prompt)).join("\n");for(const e of t)r=r.replace(e.search,e.replace);return r},activateWorldInfoByKeywords:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=U(await z(),e,t);return n.forEach((e=>R(e.world,e.uid,t.force))),n},getEnabledLoreBooks:K,hasPromptsInjected:function(e){return Te.has(e)},matchChatMessages:function(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=Fe(null!==(t=n.start)&&void 0!==t?t:-2,n.end,n.role);return Array.isArray(e)||(e=[e]),r.some((t=>n.and?e.every((e=>t.match(e))):e.some((e=>t.match(e)))))},jsonPatch:gt,parseJSON:bt,get model(){return function(){let t="";switch(e.main_api){case"kobold":case"textgenerationwebui":t=e.online_status;break;case"novel":t=e.nai_settings.model_novel;break;case"openai":t=(0,ye.getChatCompletionModel)()}return t}()}};async function Ct(e,t){var r,i,s,o,u,c;let p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"!=typeof e)return console.error("[Prompt Template] content is not a string"),e;var h,d,f,m;if(!e.includes("".concat(null!==(r=null==p||null===(i=p.options)||void 0===i?void 0:i.openDelimiter)&&void 0!==r?r:"<").concat(null!==(s=null==p||null===(o=p.options)||void 0===o?void 0:o.delimiter)&&void 0!==s?s:"%")))return l.debug_enabled&&console.debug("[Prompt Template] no available ".concat(null!==(h=null==p||null===(d=p.options)||void 0===d?void 0:d.openDelimiter)&&void 0!==h?h:"<").concat(null!==(f=null==p||null===(m=p.options)||void 0===m?void 0:m.delimiter)&&void 0!==f?f:"%"," to evaluate ").concat(e.slice(0,25),"...")),e;let D="";var g;(p.options||(p.options={}),_.defaults(p.options,{async:!0,outputFunctionName:"print",_with:!0,localsName:"locals",client:!0}),l.with_context_disabled||!1===(null===(u=p.options)||void 0===u?void 0:u._with))&&(p.options._with=!1,null!==(g=p.options)&&void 0!==g&&g.destructuredLocals||(p.options.destructuredLocals=Object.keys(t)));null!==(c=p.options)&&void 0!==c&&c.cache&&(p.options.filename||(p.options.filename="unk"),p.options.filename+="/"+v(e,4207869677));try{if(l.compile_workers){const n=await Ut(e,yt(yt({},p),{},{sandbox:p.sandbox}),t);D=await n.call(t,t)}else{const r=n().compile(e,p.options);var b,E,y,x;if(!p.sandbox)return await r.call(t,t,null!==(b=p.escaper)&&void 0!==b?b:qt,null!==(E=p.includer)&&void 0!==E?E:Wt,Gt);D=await p.sandbox.run(r,[t,null!==(y=p.escaper)&&void 0!==y?y:qt,null!==(x=p.includer)&&void 0!==x?x:Wt,Gt],{TavernHelper:globalThis.TavernHelper,Mvu:globalThis.Mvu},t)}}catch(t){var A;if(null===(A=p.logging)||void 0===A||A){if(l.debug_enabled){const t=e.split("\n").map(((e,t)=>"".concat(t,": ").concat(e))).join("\n");console.debug("[Prompt Template] when ".concat(p.when," has errors:\n").concat(t))}t instanceof SyntaxError&&(t.message+=Rt(e),console.info("SOURCE: ",t.src)),console.error(t),toastr.error(t.message,"EJS Template Error",{onclick:()=>(0,a.copyText)("Error: ".concat(t.message,"\n\nPrompt:\n").concat(e,"\n\nSourcecode:\n").concat(t.src)).then((()=>toastr.success("Copied to clipboard!")))})}throw t}return D}async function wt(t){var n;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ne(t);let u=yt(yt({},At),{},{get variables(){return te.cacheVars},execute:async e=>(await(0,r.executeSlashCommandsWithOptions)(e)).pipe,get SillyTavern(){return SillyTavern.getContext()},faker:Se.faker,userName:e.name1,assistantName:e.name2,charName:e.name2,get chatId(){return(0,e.getCurrentChatId)()},characterId:e.this_chid,get charAvatar(){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.this_chid;return t?(0,e.getThumbnailUrl)("avatar",e.characters[t].avatar):""}()},userAvatar:(0,e.getUserAvatar)(e.user_avatar),groups:o.groups,groupId:o.selected_group,charLoreBook:null===(n=e.characters[e.this_chid])||void 0===n||null===(n=n.data)||void 0===n||null===(n=n.extensions)||void 0===n?void 0:n.world,userLoreBook:s.power_user.persona_description_lorebook,chatLoreBook:e.chat_metadata[i.METADATA_KEY],get lastUserMessageId(){return e.chat.findLastIndex((e=>e.is_user))},get lastUserMessage(){var t,n;return null!==(t=null===(n=e.chat.findLast((e=>e.is_user)))||void 0===n?void 0:n.mes)&&void 0!==t?t:""},get lastCharMessageId(){return e.chat.findLastIndex((e=>!e.is_user&&!e.is_system))},get lastCharMessage(){var t,n;return null!==(t=null===(n=e.chat.findLast((e=>!e.is_user&&!e.is_system)))||void 0===n?void 0:n.mes)&&void 0!==t?t:""},get lastMessageId(){return e.chat.length-1}},a);return _.merge(u,yt({getwi:Ft.bind(u),getWorldInfo:Ft.bind(u),getchr:St.bind(u),getchar:St.bind(u),getChara:St.bind(u),getprp:kt.bind(u),getpreset:kt.bind(u),getPresetPrompt:kt.bind(u),define:Tt.bind(u),setvar:ie.bind(u),setLocalVar:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ie.call(u,e,t,yt(yt({},n),{},{scope:"local"}))},setGlobalVar:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ie.call(u,e,t,yt(yt({},n),{},{scope:"global"}))},setMessageVar:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ie.call(u,e,t,yt(yt({},n),{},{scope:"message"}))},getvar:se.bind(u),getLocalVar:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return se.call(u,e,yt(yt({},t),{},{scope:"local"}))},getGlobalVar:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return se.call(u,e,yt(yt({},t),{},{scope:"global"}))},getMessageVar:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return se.call(u,e,yt(yt({},t),{},{scope:"message"}))},incvar:ue.bind(u),incLocalVar:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ue.call(u,e,t,yt(yt({},n),{},{outscope:"local"}))},incGlobalVar:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ue.call(u,e,t,yt(yt({},n),{},{outscope:"global"}))},incMessageVar:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ue.call(u,e,t,yt(yt({},n),{},{outscope:"message"}))},decvar:ce.bind(u),decLocalVar:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ce.call(u,e,t,yt(yt({},n),{},{outscope:"local"}))},decGlobalVar:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ce.call(u,e,t,yt(yt({},n),{},{outscope:"global"}))},decMessageVar:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ce.call(u,e,t,yt(yt({},n),{},{outscope:"message"}))},patchVariables:vt.bind(u),getqr:Ot.bind(u),getQuickReply:Ot.bind(u),evalTemplate:Nt.bind(u),findVariables:function(t){return _e(arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.chat.length,t)},delvar:ae.bind(u),delLocalVar:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ae.call(u,e,yt(yt({},t),{},{scope:"local"}))},delGlobalVar:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ae.call(u,e,yt(yt({},t),{},{scope:"global"}))},delMessageVar:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ae.call(u,e,yt(yt({},t),{},{scope:"message"}))},insvar:oe.bind(u),insertLocalVar:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return oe.call(u,e,t,n,yt(yt({},r),{},{scope:"local"}))},insertGlobalVar:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return oe.call(u,e,t,n,yt(yt({},r),{},{scope:"global"}))},insertMessageVar:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return oe.call(u,e,t,n,yt(yt({},r),{},{scope:"message"}))}},Bt(u,Pt))),await e.eventSource.emit("prompt_template_prepare",u),l.debug_enabled&&(console.debug("[Prompt Template] context prepared:"),console.debug(u)),u}async function Ft(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=null;var s,a;_.isPlainObject(n)?(i=await V((null===(s=this.world_info)||void 0===s?void 0:s.world)||"",t),_.isPlainObject(n)&&(r=n)):i=await V(t||(null===(a=this.world_info)||void 0===a?void 0:a.world)||"",n);return i?await Ct((0,e.substituteParams)((0,C.getRegexedString)(i.content,C.regex_placement.WORLD_INFO)),_.merge(this,r,{world_info:i}),{when:"".concat(i.world,".").concat(i.comment)}):(console.warn("[Prompt Template] worldinfo ".concat(t," or entry ").concat(n," not found")),"")}async function St(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:be,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=Ee(t);return i?(0,e.substituteParams)(await Ct(n,_.merge(this,r,i,{chara_name:i.name}),{when:"".concat(t)}),void 0,i.name,void 0,void 0,!1):(console.warn("[Prompt Template] character ".concat(t," not found")),"")}async function kt(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=function(e){const t=ye.oai_settings.prompts.find((t=>t.name===e||t.name.match(e)));return t&&(null==t?void 0:t.content)||null}(t);return r?(0,e.substituteParams)(await Ct(r,_.merge(this,n,{prompt_name:t}),{when:"".concat(t)})):(console.warn("[Prompt Template] preset prompt ".concat(t," not found")),"")}let Pt={};function Tt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=_.get(Pt,e,void 0);return n&&((void 0===r||_.isArray(r))&&_.isArray(t)?t=_.concat(null!=r?r:[],t):(void 0===r||_.isPlainObject(r))&&_.isPlainObject(t)&&(t=_.mergeWith(null!=r?r:{},t,((e,t)=>_.isArray(t)?t:void 0)))),_.set(Pt,e,t),_.set(this,e,t),r}function Bt(e,t){let n={};_.isArray(t)&&(n=[]);for(const[r,i]of _.entries(t))_.isFunction(i)?n[r]=i.bind(e):_.isArray(i)||_.isPlainObject(i)?n[r]=Bt(e,i):n[r]=i;return n}async function Ot(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=function(e,t){var n;const r=null===(n=u.extension_settings.quickReplyV2)||void 0===n?void 0:n.config;if(!r)return"";const i=_.find(r.setList,(t=>t.set.name===e||t.set.name.match(e)));if(i){const e=_.find(i.set.qrList,(e=>e.label===t||e.label.match(t)));return(null==e?void 0:e.message)||""}return""}(t,n);return i?(0,e.substituteParams)(await Ct(i,_.merge(this,r,{qr_name:t,qr_label:n}),{when:"".concat(t,".").concat(n)})):(console.warn("[Prompt Template] quick reply ".concat(t,".").concat(n," not found")),"")}async function Nt(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,e.substituteParams)(await Ct(t,_.merge(this,n),{when:"evalTemplate",options:r}))}const It=/^\s*include\s+(\S+)/;function Lt(e){let t="";return e.split("\n").forEach(((e,n)=>{0!==n&&(t+="\n");for(let n=0;n<e.length;n++)t+=" "})),t}function Rt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=new(n().Template)(e,t).parseTemplateText();let i;const s=t.delimiter||"%",a=r.map((e=>{switch(e){case"<".concat(s):case"<".concat(s,"_"):return i=1,Lt(e);case"<".concat(s,"="):case"<".concat(s,"-"):return i=2,";".concat(Lt(e));case"".concat(s,">"):case"-".concat(s,">"):case"_".concat(s,">"):return e=Lt(e)+(2===i?";":""),i=0,e;case(e.match(It)||{}).input:return t.preprocessorInclude?Lt(e):e;default:return i?e:Lt(e)}})).join(""),o={allowAwaitOutsideFunction:!!t.await,locations:!0};let u=Pe()(a,void 0,o);return u&&(u.message+=" at ".concat(e.split("\n")[u.line-1])),u}(e);if(!r)return"";const i=e.split("\n"),s=r.line-1;return t=_.clamp(t,0,i.length),"".concat(i.slice(s-t,s).map((e=>e.length>50?e.substring(0,50)+"...":e)).join("\n"),"\n").concat(i[s],"\n").concat(" ".repeat(r.column-1),"^\n").concat(i.slice(s+1,s+t+1).map((e=>e.length>50?e.substring(0,50)+"...":e)).join("\n"),"\n\nat line: ").concat(s,", column: ").concat(r.column)}let jt=0,Mt=null,Vt=new Map;async function Ut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return null==Mt&&(Mt=new Worker("/scripts/extensions/third-party/ST-Prompt-Template/dist/ejs.workers.js"),Mt.onerror=e=>{console.error("[Prompt Template] worker error: ".concat(e.message),e),Mt=null},Mt.onmessage=e=>{const{id:t,code:n,error:r}=e.data;if(Vt.has(t)){const{resolve:e,reject:i}=Vt.get(t);Vt.delete(t),r?i(new Error(r)):e(n)}}),t.options||(t.options={}),_.defaults(t.options,{async:!0,outputFunctionName:"print",_with:!0,localsName:"locals"}),t.options.client=!0,t.options.escape=void 0,t.options.includer=void 0,new Promise(((r,i)=>{const s=jt++;Vt.set(s,{resolve(e){try{const i=new Function("return ".concat(e))();r((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var r,s,a,o;return t.sandbox?t.sandbox.run(i,[e,null!==(r=t.escaper)&&void 0!==r?r:qt,null!==(s=t.includer)&&void 0!==s?s:Wt,Gt],{TavernHelper:globalThis.TavernHelper,Mvu:globalThis.Mvu},n):i.call(this,e,null!==(a=t.escaper)&&void 0!==a?a:qt,null!==(o=t.includer)&&void 0!==o?o:Wt,Gt)}))}catch(e){i(new Error("Template hydration failed: ".concat(e.message),{cause:e}))}},reject:i}),Mt.postMessage({id:s,template:e,options:t.options})}))}function Wt(e,t){return console.warn("[Prompt Template] include not implemented"),{filename:e,template:""}}function qt(e){return e}function Gt(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:qt,s=t.split("\n"),a=Math.max(r-3,0),o=Math.min(s.length,r+3),u=i(n),c=s.slice(a,o).map((function(e,t){let n=t+a+1;return(n==r?" >> ":"    ")+n+"| "+e})).join("\n");throw e.path=u,e.message=(u||"ejs")+":"+r+"\n"+c+"\n\n"+e.message,e}__webpack_require__(2041);const Kt=(e=>{var t={};return __webpack_require__.d(t,e),t})({getTokenCountAsync:()=>__WEBPACK_EXTERNAL_MODULE__tokenizers_js_d5863f55__.getTokenCountAsync});function zt(e,t){window.setTimeout((()=>{(0,Kt.getTokenCountAsync)(e).then((n=>{switch(console.log("[Prompt Template] processing ".concat(t," result: ").concat(n," tokens and ").concat(e.length," chars")),t){case"send":u.extension_settings.variables.global.LAST_SEND_TOKENS=n,u.extension_settings.variables.global.LAST_SEND_CHARS=e.length;break;case"receive":u.extension_settings.variables.global.LAST_RECEIVE_TOKENS=n,u.extension_settings.variables.global.LAST_RECEIVE_CHARS=e.length}}))}))}function Xt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"escape-ejs";const r=t.openDelimiter||"<",i=t.closeDelimiter||">",s=t.delimiter||"%",a="<"===r&&">"===i?"":"#";return e.replaceAll(new RegExp("".concat(r).concat(a).concat(n).concat(i,"([\\s\\S]*?)").concat(r).concat(a,"/").concat(n).concat(i),"gi"),(e=>e.replaceAll("".concat(r).concat(s),"".concat(r).concat(s).concat(s)).replaceAll("".concat(s).concat(i),"".concat(s).concat(s).concat(i))))}function Ht(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=Xt(e,t.options||{},t.disableMarkup||"escape-ejs"),e=Xt(e,t.options||{},"thinking"),e=Xt(e,t.options||{},"think"),e=Xt(e,t.options||{},"reasoning")}const $t=(e=>{var t={};return __webpack_require__.d(t,e),t})({updateReasoningUI:()=>__WEBPACK_EXTERNAL_MODULE__reasoning_js_8d5a64cc__.updateReasoningUI});function Jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jt(Object(n),!0).forEach((function(t){Qt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qt(e,t,n){return t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}async function Zt(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};null!=n&&0!==n.length||(n=await z()),Object.keys(te.initialVariables).forEach((e=>delete te.initialVariables[e])),await Promise.all(n.filter((e=>(e.disable===l.invert_enabled||e.decorators.includes("@@always_enabled"))&&(e.comment.startsWith("[InitialVariables]")||e.decorators.includes("@@initial_variables")))).map((async n=>{const i=await Ct(x(t,(0,e.substituteParams)(n.content),{worldinfo:!0}),t,r);let s={};try{s=JSON.parse(i)}catch(e){return toastr.error("Can't parse initial variables ".concat(n.world,"/").concat(n.comment,"/").concat(n.uid),"Prompt Template"),console.error("[Prompt Template] Can't parse initial variables ".concat(n.world,"/").concat(n.comment,"/").concat(n.uid,": "),n.content),void console.error(e)}if(!_.isPlainObject(s))return toastr.error("Wrong format for initial variables ".concat(n.world,"/").concat(n.comment,"/").concat(n.uid),"Prompt Template"),void console.error("[Prompt Template] Wrong format for initial variables ".concat(n.world,"/").concat(n.comment,"/").concat(n.uid,": "),s);_.mergeWith(te.initialVariables,s,((e,t)=>_.isArray(t)?t:void 0)),console.debug("[Prompt Template] Set Initial Variables: \n",s)})))}function en(e,t,n){return t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class tn{constructor(){en(this,"iframe",null),en(this,"win",null),this.initIframe(),this.hardenEnvironment()}initIframe(){if(this.iframe=document.createElement("iframe"),this.iframe.style.display="none",this.iframe.setAttribute("sandbox","allow-same-origin allow-scripts"),document.body.appendChild(this.iframe),this.win=this.iframe.contentWindow,!this.win)throw this.destroy(),new Error("Sandbox: Failed to initialize iframe window");l.debug_enabled&&console.log("Sandbox: Initialized iframe window")}async run(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!this.win)throw new Error("Sandbox: Instance has been destroyed. Please create a new BatchSandbox.");try{this.injectContext(n);const i=e.toString(),s=this.win.eval("(".concat(i,")")).apply(r,t);return s&&"function"==typeof s.then?await s:s}catch(e){throw e}}destroy(){this.iframe&&this.iframe.parentNode&&this.iframe.parentNode.removeChild(this.iframe),this.iframe=null,this.win=null,l.debug_enabled&&console.log("Sandbox: Destroyed iframe window")}destroyIframe(){this.destroy()}injectContext(e){this.win&&Object.keys(e).forEach((t=>{this.win[t]=e[t]}))}hardenEnvironment(){if(!this.win)return;const e=this.win,t=t=>{try{Object.defineProperty(e,t,{get:()=>null,set:()=>{},configurable:!1,enumerable:!1})}catch(e){}};t("parent"),t("top"),t("frameElement"),e.fetch=void 0,e.XMLHttpRequest=void 0,e.alert=void 0}}function nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nn(Object(n),!0).forEach((function(t){sn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function sn(e,t,n){return t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let an=0,on=!1,un=!1,cn="",ln="";const pn="a8ff1bc7-15f2-4122-b43b-ded692560538";async function hn(e,t,n){if(!1!==l.enabled&&(un=n,!n))if(ln=e,te.isInPlace="swipe"===e||"append"===e||"continue"===e||"appendFinal"===e,console.debug("[Prompt Template] start generate before on dryRun=".concat(n,", isInPlace=").concat(te.isInPlace)),y({message:!0}),l.generate_loader_enabled){const e=await wt(-1-Number(te.isInPlace),{runType:"generate",runID:an++,message_id:void 0,swipe_id:void 0,is_last:void 0,is_user:void 0,is_system:void 0,name:void 0,isDryRun:!1,generateType:ln}),t=l.sandbox?new tn:null;try{cn=await P(e,{decorator:"@@generate_before",comment:"[GENERATE:BEFORE]",sandbox:t})}catch(e){throw console.error("[Prompt Template] Error in generateBefore:",e),cn="",e}finally{null==t||t.destroy()}}else cn=""}async function dn(e){if(!1===l.enabled)return;const t=await wt(-1-Number(te.isInPlace),{runType:"generate",runID:an++,message_id:void 0,swipe_id:void 0,is_last:void 0,is_user:void 0,is_system:void 0,name:void 0,isDryRun:!1,generateType:ln}),n=l.sandbox?new tn:null,r=async function(r){for(let i=e[r].length-1;i>=0;i--){const s=e[r][i];if(Y(s))e[r].splice(i,1),console.debug("[Prompt Template] Remove ".concat(r," of ").concat(s.world,"/").concat(s.comment,"/").concat(s.uid," from context when SpecialEntry"));else if(await Z(t,s,{sandbox:n}))e[r].splice(i,1),console.debug("[Prompt Template] Remove ".concat(r," of ").concat(s.world,"/").concat(s.comment,"/").concat(s.uid," from context when ConditionFiltedEntry"));else if(Q(s))try{const[a,o,u]=await T(e[r][i],t,{sandbox:n});e[r][i]=rn(rn({},s),{},{content:a,key:o,keysecondary:u}),console.debug("[Prompt Template] Preprocess ".concat(r," of ").concat(s.world,"/").concat(s.comment,"/").concat(s.uid)),l.debug_enabled&&console.debug(a)}catch(e){throw console.error("[Prompt Template] Error in preprocess:",e),e}finally{null==n||n.destroy()}else ee(s)&&(s.content="<% (()=>{%>".concat(s.content,"<%})(); %>"),console.debug("[Prompt Template] Mark ".concat(r," of ").concat(s.world,"/").concat(s.comment,"/").concat(s.uid," as private")))}};await r("characterLore"),await r("globalLore"),await r("personaLore"),await r("chatLore");const i=function(t,n){const r=e[n].findIndex((e=>e.world===t.world&&e.uid==t.uid));return r>-1?(e[n].splice(r,1),console.debug("[Prompt Template] Remove duplicate ".concat(n," of ").concat(t.world,"/").concat(t.comment,"/").concat(t.uid," from context when FORCE ACTIVATE WI")),n):null};for(const t of Array.from(L.values())){var s,a,o,u;let n="chatLore";n=null!==(s=i(t,"characterLore"))&&void 0!==s?s:n,n=null!==(a=i(t,"globalLore"))&&void 0!==a?a:n,n=null!==(o=i(t,"personaLore"))&&void 0!==o?o:n,n=null!==(u=i(t,"chatLore"))&&void 0!==u?u:n,e[n].push(t),console.debug("[Prompt Template] Inject ".concat(t.world,"/").concat(t.comment,"/").concat(t.uid," to context as ").concat(n))}}async function fn(t,n){if(un=null!=n?n:un,un)return;if(!1===l.enabled)return;const r="string"==typeof t.prompt?[{role:"",content:t.prompt}]:t.prompt;if(y({basic:!0}),j(),!1===l.generate_enabled)return;te.isDryRun=!1;const i=Date.now();console.log("[Prompt Template] start generate after ".concat(r.length," messages"));const s=await z(),a=await wt(-1-Number(te.isInPlace),{runType:"generate",runID:an++,message_id:void 0,swipe_id:void 0,is_last:void 0,is_user:void 0,is_system:void 0,name:void 0,isDryRun:!1,generateType:ln}),o=l.sandbox?new tn:null;let u=cn;try{for(const[t,n]of r.entries()){const r=!1===l.generate_loader_enabled?"":await P(a,{comment:"[GENERATE:".concat(t,":BEFORE]"),decorator:"@@generate_before ".concat(t),entries:s,buffer:u});if("string"==typeof n.content){const i=await k(x(a,n.content,{generate:!0,role:n.role}),a,"message #".concat(t+1,"(").concat(n.role,")"),{options:{filename:"generate/".concat((0,e.getCurrentChatId)(),"/").concat(t),cache:1===l.cache_enabled},sandbox:o}),c=!1===l.generate_loader_enabled?"":await P(a,{comment:"[GENERATE:".concat(t,":AFTER]"),decorator:"@@generate_after ".concat(t),content:i,entries:s,buffer:u+r+i});null!=i&&(n.content=r+i+c,u+=r+i+c)}else if(_.isArray(n.content))for(const i of n.content)if("text"===i.type){const c=await k(x(a,i.text,{generate:!0,role:n.role}),a,"message #".concat(t+1,"(").concat(n.role,")"),{options:{filename:"generate/".concat((0,e.getCurrentChatId)(),"/").concat(t),cache:1===l.cache_enabled},sandbox:o}),p=!1===l.generate_loader_enabled?"":await P(a,{comment:"[GENERATE:".concat(t,":AFTER]"),decorator:"@@generate_after ".concat(t),content:c,entries:s,buffer:u+r+c,sandbox:o});null!=c&&(i.text=r+c+p,u+=r+c+p)}}const n=!1===l.generate_loader_enabled?"":await P(a,{decorator:"@@generate_after",comment:"[GENERATE:AFTER]",content:u,entries:s,buffer:cn+u,sandbox:o});u+=n,"string"==typeof t.prompt?t.prompt=cn+r[0].content+n:(r[0].content=cn+r[0].content,r[r.length-1].content+=n),l.inject_loader_enabled&&await async function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=(await z()).filter((e=>e.comment.startsWith("@INJECT")&&(e.disable===l.invert_enabled||e.decorators.includes("@@always_enabled"))&&!e.decorators.includes("@@only_preload")));if(i&&i.length>0){console.log("[Prompt Template] Found inject entries:",i.length);const a=[];for(const e of i)if(e.useProbability){const t=Math.floor(100*Math.random())+1;t<=e.probability?(a.push(e),console.log("[Prompt Template] Probability triggered: ".concat(e.comment," (").concat(e.probability,"% chance, rolled ").concat(t,")"))):console.log("[Prompt Template] Probability failed: ".concat(e.comment," (").concat(e.probability,"% chance, rolled ").concat(t,")"))}else a.push(e);console.log("[Prompt Template] After probability check: ".concat(a.length,"/").concat(i.length," entries triggered"));const o=a,u=[];for(const t of o){const i=t.comment,s=i.match(/role=(\w+)/),a=s?s[1]:"system",o="user"===a||"assistant"===a||"system"===a?a:"system",c=await k(x(n,(0,e.substituteParams)(t.content),{generate:!0,role:o,worldinfo:!0}),_.merge(n,{world_info:t}),"inject ".concat(t.world,".").concat(t.comment),Yt(Yt({},r),{},{options:Yt({filename:"inject/".concat(t.world,"/").concat(t.uid,"-").concat(t.comment),cache:1===l.cache_enabled},r.options)}));if(null==c||!c.trim()){console.warn("[Prompt Template] Empty inject content: ".concat(i," from"),t);continue}const p=i.match(/pos=(\d+)/);if(p){const e=parseInt(p[1]);u.push({type:"pos",pos:e,role:o,content:c,order:t.order||0,originalData:t}),console.log("[Prompt Template] Parsed pos inject: pos=".concat(e,", role=").concat(o,", order=").concat(t.order||0,", content=").concat(c));continue}const h=i.match(/target=(\w+)/);if(h){const e=h[1],n=i.match(/index=(-?\d+)/),r=i.match(/at=(before|after)/);u.push({type:"target",target:e,targetIndex:n?parseInt(n[1]):1,targetAt:r?r[1]:"before",role:o,content:c,order:t.order||0,originalData:t}),console.log("[Prompt Template] Parsed target inject: target=".concat(e,", index=").concat(n?n[1]:1,", at=").concat(r?r[1]:"before",", role=").concat(o,", order=").concat(t.order||0,", content=").concat(c));continue}const d=i.match(/regex=(?:"([^"]*)"|'([^']*)'|(\S+))/);if(d){const e=d[1]||d[2]||d[3];if(!e){console.warn("[Prompt Template] Empty regex pattern: ".concat(i));continue}const n=e.replace(/^["']|["']$/g,""),r=i.match(/at=(before|after)/);u.push({type:"regex",regex:n,regexAt:r?r[1]:"before",role:o,content:c,order:t.order||0,originalData:t}),console.log("[Prompt Template] Parsed regex inject: regex=".concat(n,", at=").concat(r?r[1]:"before",", role=").concat(o,", order=").concat(t.order||0,", content=").concat(c))}else console.warn("[Prompt Template] Invalid inject format: ".concat(i," from"),t)}const c=u.filter((e=>"pos"===e.type)),p=u.filter((e=>"target"===e.type)),h=u.filter((e=>"regex"===e.type));if(console.log("[Prompt Template] Injection instructions parsed:"),console.log("  - pos mode: ".concat(c.length)),console.log("  - target mode: ".concat(p.length)),console.log("  - regex mode: ".concat(h.length)),console.log("  - total: ".concat(u.length)),u.length>0){console.log("[Prompt Template] Starting injection process...");const e=Array.from(t.prompt);console.log("[Prompt Template] data before injection:",e);const n=Array.from(t.prompt);let r=1,i=1,a=1;for(let e=0;e<n.length;e++)switch(n[e].original_index=e+1,n[e].role){case"user":n[e].role_specific_index=r,r++;break;case"assistant":n[e].role_specific_index=i,i++;break;case"system":n[e].role_specific_index=a,a++}const o=[];for(const e of p){let t=e.targetIndex||1;if(t<0){const r=n.filter((t=>t.role===e.target)).length;t=r+t+1}const r=n.find((n=>n.role===e.target&&n.role_specific_index===t));if(r&&void 0!==r.original_index){const n=r.original_index,i="before"===e.targetAt?n:n+1;o.push({instruction:e,finalPos:i}),console.log("[Prompt Template] Target position calculated: ".concat(e.target,"[").concat(t,"] -> pos ").concat(i))}else console.warn("[Prompt Template] Target not found: ".concat(e.target,"[").concat(t,"]"),e)}for(const e of c){if(0===e.pos){o.push({instruction:e,finalPos:0}),console.log("[Prompt Template] Pos position calculated: pos 0 (special case for pos=0)");continue}let t=e.pos||1;t<0&&(t=n.length+t+1,t=Math.max(1,t));const r=t-1;o.push({instruction:e,finalPos:r}),console.log("[Prompt Template] Pos position calculated: pos ".concat(r," (from 1-based ").concat(t,")"))}o.sort(((e,t)=>{var n,r;if(e.finalPos!==t.finalPos)return t.finalPos-e.finalPos;const i=null!==(n=e.instruction.order)&&void 0!==n?n:1/0,s=null!==(r=t.instruction.order)&&void 0!==r?r:1/0;var a,o;if(i!==s)return console.log("[Prompt Template] Order comparison: ".concat(null===(a=e.instruction.originalData)||void 0===a?void 0:a.comment," (order=").concat(i,") vs ").concat(null===(o=t.instruction.originalData)||void 0===o?void 0:o.comment," (order=").concat(s,") -> ").concat(i<s?"A first":"B first")),s-i;const u="pos"===e.instruction.type,c="pos"===t.instruction.type;return u&&!c?-1:!u&&c?1:0})),console.log("[Prompt Template] Position-based queue after sorting:");for(let e=0;e<o.length;e++){var s;const t=o[e];console.log("  ".concat(e,": ").concat(null===(s=t.instruction.originalData)||void 0===s?void 0:s.comment," (pos=").concat(t.finalPos,", order=").concat(t.instruction.order,", type=").concat(t.instruction.type,")"))}for(const{instruction:e,finalPos:t}of o){const r={role:e.role,content:e.content};n.splice(t,0,r),console.log("[Prompt Template] Position-based message inserted: role=".concat(e.role," at final pos ").concat(t))}const u=[];for(const e of h)try{const t=new RegExp(e.regex||""),r=n.findIndex((e=>t.test(e.content)));if(-1!==r){const t="before"===e.regexAt?r:r+1;u.push({instruction:e,finalPos:t}),console.log('[Prompt Template] Regex position calculated: regex="'.concat(e.regex,'" -> pos ').concat(t))}else console.warn('[Prompt Template] Regex match not found: "'.concat(e.regex,'"'))}catch(t){console.error('[Prompt Template] Invalid regex "'.concat(e.regex,'":'),t)}u.sort(((e,t)=>{if(e.finalPos!==t.finalPos)return t.finalPos-e.finalPos;const n=e.instruction.order;return t.instruction.order-n}));for(const{instruction:e,finalPos:t}of u){const r={role:e.role,content:e.content};n.splice(t,0,r),console.log("[Prompt Template] Regex-based message inserted: role=".concat(e.role," at final pos ").concat(t))}for(const e of n)delete e.original_index,delete e.role_specific_index;t.prompt=n}}}(t,a,{sandbox:o})}catch(e){throw console.error("[Prompt Template] Error processing prompt:",e),e}finally{null==o||o.destroy()}cn="";const c=Date.now()-i;console.log("[Prompt Template] processing ".concat(r.length," messages in ").concat(c,"ms")),await le(),zt(u,"send"),j(),y({generate:!0,basic:!0}),Be(),te.isInPlace=!1}async function mn(t,n,r){var i,s,a;if(!1===l.enabled)return;if(!1===l.render_enabled)return;if(on)return;te.isDryRun=!!r;const o=Date.now(),u=parseInt(t);if(isNaN(u)||u<0||u>=e.chat.length)return void console.warn("[Prompt Template] chat message #".concat(t," invalid"));if(l.depth_limit>-1&&e.chat.length-u-1>l.depth_limit)return void console.debug("[Prompt Template] Reached message limit ".concat(l.depth_limit," of message ").concat(t));const c=e.chat[u];if(!c)return void console.error("[Prompt Template] chat message #".concat(t," not found"));const p=$('div.mes[mesid="'.concat(t,'"]')),h=null==p?void 0:p.find(".mes_text");if(null==h||!h.text()||!c.mes||"..."===c.mes||c.mes===(null===(i=c.swipes)||void 0===i?void 0:i[c.swipe_id-1]))return void console.info("[Prompt Template] chat message #".concat(t,".").concat(c.swipe_id," is generating"));!r||null!=c&&null!==(s=c.is_ejs_processed)&&void 0!==s&&s[c.swipe_id||0]||(te.isDryRun=r=!1);const d=await wt(u,{runType:"render",message_id:u,swipe_id:c.swipe_id,runID:an++,is_last:u>=e.chat.length-1,is_user:c.is_user,is_system:c.is_system,name:c.name,isDryRun:r,generateType:""});function f(t){var n;return(0,e.messageFormatting)(t,null!==(n=c.name)&&void 0!==n?n:"",!!c.is_system,!!c.is_user,u)}const m=await z(),D=l.sandbox?new tn:null;let g=null,v=null;try{const n=!1===l.render_loader_enabled?"":await P(d,{escaper:f,msgId:u,decorator:"@@render_before",comment:"[RENDER:BEFORE]",entries:m,sandbox:D});if(!r&&l.raw_message_evaluation_enabled){d.runType="render_permanent";const n=await k(Ht(x(d,c.mes,{message:!0,user:c.is_user,assistant:!c.is_user&&!c.is_system,system:c.is_system,depth:e.chat.length-u-1,before:!0,after:!1,html:!1})),d,"chat #".concat(u,".").concat(c.swipe_id," raw"),{options:{filename:"render_permanent/".concat((0,e.getCurrentChatId)(),"/").concat(t,"/").concat(c.swipe_id),cache:!1},sandbox:D});d.runType="render",null!=n&&(c.mes=n,(0,e.updateMessageBlock)(u,c,{rerenderMessage:!0}))}const i=h.html();v=!1===l.code_blocks_enabled?function(e){return e.replace(/(<pre\b[^>]*>)([\s\S]*?)(<\/pre>)/gi,((e,t,n,r)=>t+n.replace(/&lt;/g,"&lt;").replace(/&gt;/g,"#gt#")+r))}(i):function(e){return e.replace(/<pre\b[^>]*>([\s\S]*?)<\/pre>/gi,((e,t)=>{const n=t.replace(/&lt;%([\s\S]*?)%&gt;/g,((e,t)=>"&lt;%".concat(t.replace(/<[^>]+>/g,""),"%&gt;")));return"<pre>".concat(n,"</pre>")}))}(i);const s={escaper:f,options:{openDelimiter:"&lt;",closeDelimiter:"&gt;",filename:"render/".concat((0,e.getCurrentChatId)(),"/").concat(t,"/").concat(c.swipe_id),cache:1===l.cache_enabled}};g=await k(Ht(function(e){return e.replace(/&lt;%([\s\S]*?)%&gt;/gi,((e,t)=>"&lt;%".concat(_.unescape(t),"%&gt;")))}(function(e){return e.replace(/&lt;%((?:[^%]|%[^>])*)%&gt;/gi,((e,t)=>{const n=t.replace(/<[^>]+>/g,"");return"&lt;%".concat(n,"%&gt;")}))}(x(d,v,{message:!0,user:c.is_user,assistant:!c.is_user&&!c.is_system,system:c.is_system,worldinfo:!1,depth:e.chat.length-u-1,before:!1,html:!0}))),s),d,"chat #".concat(u,".").concat(c.swipe_id),rn(rn({},s),{},{sandbox:D})),!1===l.code_blocks_enabled&&(g=function(e){var t;return null!==(t=null==e?void 0:e.replace(/(<pre\b[^>]*>)([\s\S]*?)(<\/pre>)/gi,((e,t,n,r)=>t+n.replace(/#lt#/g,"&lt;").replace(/#gt#/g,"&gt;")+r)))&&void 0!==t?t:null}(g));const a=!1===l.render_loader_enabled?"":await P(d,{escaper:f,msgId:u,decorator:"@@render_after",comment:"[RENDER:AFTER]",content:g,entries:m,sandbox:D});null!=g&&(g=n+g+a)}catch(e){console.error("Error processing message #".concat(u,":"),e),g=null}finally{null==D||D.destroy()}g&&g!==v&&(h.html(g),(0,$t.updateReasoningUI)(p),(0,e.addCopyToCodeBlocks)(p),(0,e.appendMediaToMessage)(c,p)),null!==(a=g)&&void 0!==a&&a.includes("<pre>")&&r&&(on=!0,console.debug("[HTML] rendering #".concat(u," message")),c.is_user?await e.eventSource.emit(e.event_types.USER_MESSAGE_RENDERED,t):c.is_system||await e.eventSource.emit(e.event_types.CHARACTER_MESSAGE_RENDERED,t,n),on=!1),c.is_ejs_processed||(c.is_ejs_processed=[]),c.is_ejs_processed[c.swipe_id||0]=!0;const b=Date.now()-o;console.log("[Prompt Template] processing #".concat(u," messages in ").concat(b,"ms")),r||(await le(),zt(h.text(),"receive"))}async function _n(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!1===l.enabled)return;if(y({basic:!0,message:!0,generate:!0},999),j(),Be(999),!1===l.preload_worldinfo_enabled&&!n)return;if(!t&&!n)return;te.isDryRun=!0;const r=Date.now();console.log("[Prompt Template] *** PRELOADING WORLD INFO ***");const i=await z(),s=i.filter((e=>!e.disable&&!e.decorators.includes("@@dont_preload")&&!Y(e,!0))),a=await wt(-1,{runType:"preparation",runID:an++,message_id:void 0,swipe_id:void 0,is_last:void 0,is_user:void 0,is_system:void 0,name:void 0,isDryRun:!0,generateType:""}),o=l.sandbox?new tn:null;try{await Zt(a,i,{sandbox:o});let t="";console.log("[Prompt Template] *** EVALUATING ".concat(s.length," WORLD INFO ***")),console.debug(s),l.generate_loader_enabled&&(t+=await P(a,{decorator:"@@generate_before",comment:"[GENERATE:BEFORE]",entries:i,preload:!0,sandbox:o}));for(const n of s)t+=await k((0,e.substituteParams)(n.content),_.merge(a,{world_info:n}),"worldinfo ".concat(n.world,".").concat(n.comment),{options:{filename:"worldinfo/".concat(n.world,"/").concat(n.uid,"-").concat(n.comment),cache:1===l.cache_enabled||2===l.cache_enabled},sandbox:o});const n=Ee();if(null!=n&&n.description||null!=n&&n.scenario){const e=(n.description||"")+"\n---\n"+(n.scenario||"");t+=await k(e,a,"character ".concat(n.name),{options:{filename:"character/".concat(n.name),cache:1===l.cache_enabled},sandbox:o})}l.generate_loader_enabled&&await P(a,{decorator:"@@generate_after",comment:"[GENERATE:AFTER]",content:t,entries:i,preload:!0,sandbox:o})}catch(e){throw console.error("[Prompt Template] Error processing world info:",e),e}finally{null==o||o.destroy()}const u=Date.now()-r;if(console.log("[Prompt Template] processing ".concat(s.length," world info in ").concat(u,"ms")),e.chat.length>1){console.log("[Prompt Template] *** UPDATE ALL MESSAGES ***");for(const e of $("div.mes[mesid]")){const t=$(e).attr("mesid");t&&await mn(t,"preload",!0)}}}async function Dn(t,n){if(!1===l.enabled)return;if(!1===l.preload_worldinfo_enabled)return;if(!e.this_chid)return;const r=Date.now();console.log("[Prompt Template] *** REFRESHING WORLD INFO: ".concat(t," ***"));if(!K().includes(t))return;const i=await M(t);console.debug(i);const s=i.filter((e=>!e.disable&&!e.decorators.includes("@@dont_preload")&&!Y(e,!0))),a=await wt(-1,{runType:"preparation",runID:an++,message_id:void 0,swipe_id:void 0,is_last:void 0,is_user:void 0,is_system:void 0,name:void 0,isDryRun:!0,generateType:""}),o=l.sandbox?new tn:null;try{await Zt(a,await M(t),{sandbox:o});let n="";l.generate_loader_enabled&&(n+=await P(a,{decorator:"@@generate_before",comment:"[GENERATE:BEFORE]",entries:i,sandbox:o}));for(const t of s)n+=await k((0,e.substituteParams)(t.content),_.merge(a,{world_info:t}),"worldinfo ".concat(t.world,".").concat(t.comment),{options:{filename:"worldinfo/".concat(t.world,"/").concat(t.uid,"-").concat(t.comment),cache:1===l.cache_enabled||2===l.cache_enabled},sandbox:o});l.generate_loader_enabled&&await P(a,{decorator:"@@generate_after",comment:"[GENERATE:AFTER]",content:n,entries:i,sandbox:o})}catch(e){throw console.error("[Prompt Template] Error processing world info:",e),e}finally{null==o||o.destroy()}const u=Date.now()-r;console.log("[Prompt Template] processing ".concat(s.length," world info in ").concat(u,"ms"))}async function gn(e,t,n){if(!1===l.enabled)return;if(n)return;const r=u.extension_settings.regex.findIndex((e=>e.id===pn));l.filter_message_enabled&&-1===r?(E("/<%(?![%])([\\s\\S]*?)(?<!%)%>/g","",{uuid:pn}),console.debug("[Prompt Template] inject regex filter")):!l.filter_message_enabled&&r>-1&&(y({uuid:pn}),console.debug("[Prompt Template] remove regex filter"))}async function vn(e,t){"append"!==t&&"continue"!==t&&"appendFinal"!==t&&"first_message"!==t&&"impersonate"!==t&&De(e)}async function bn(t,n){if(!1===l.enabled)return;if(!1===l.render_enabled)return;if(!1===l.raw_message_evaluation_enabled)return;const r=Date.now(),i=await wt(void 0,{runID:an++,message_id:void 0,swipe_id:void 0,is_last:void 0,is_user:void 0,is_system:void 0,name:void 0,isDryRun:!1,generateType:"custom"});let s=null;const a=l.sandbox?new tn:null;try{s=await k(Ht(x(i,t.message,{message:!0,user:!1,assistant:!0,system:!1,depth:0,before:!0,after:!1,html:!1})),i,"custom #".concat(n),{options:{filename:"custom/".concat((0,e.getCurrentChatId)()),cache:!1},sandbox:a})}catch(e){throw console.error("[Prompt Template] Error processing custom generate:",e),e}finally{null==a||a.destroy()}null!=s&&(t.message=s);const o=Date.now()-r;console.log("[Prompt Template] processing #".concat(n," custom generate in ").concat(o,"ms"))}async function En(t,n){var r,i,s,a;const o=e.chat[t];var u;(null==o||null===(r=o.variables)||void 0===r?void 0:r.length)>(null==o||null===(i=o.swipes)||void 0===i?void 0:i.length)&&(null===(u=o.variables)||void 0===u||u.splice(n,1));null!=o&&null!==(s=o.variables_initialized)&&void 0!==s&&s[n]&&(o.variables_initialized=o.variables_initialized.splice(n,1)),null!=o&&null!==(a=o.is_ejs_processed)&&void 0!==a&&a[n]&&(o.is_ejs_processed=o.is_ejs_processed.splice(n,1))}const yn=[e.event_types.MESSAGE_UPDATED,e.event_types.MESSAGE_SWIPED,e.event_types.USER_MESSAGE_RENDERED],xn=[e.event_types.MESSAGE_SENT,e.event_types.MESSAGE_RECEIVED,e.event_types.MESSAGE_SWIPED];const An=(e=>{var t={};return __webpack_require__.d(t,e),t})({SlashCommand:()=>__WEBPACK_EXTERNAL_MODULE__slash_commands_SlashCommand_js_1b0d5616__.SlashCommand});const Cn=(e=>{var t={};return __webpack_require__.d(t,e),t})({ARGUMENT_TYPE:()=>__WEBPACK_EXTERNAL_MODULE__slash_commands_SlashCommandArgument_js_a42b9371__.ARGUMENT_TYPE,SlashCommandArgument:()=>__WEBPACK_EXTERNAL_MODULE__slash_commands_SlashCommandArgument_js_a42b9371__.SlashCommandArgument,SlashCommandNamedArgument:()=>__WEBPACK_EXTERNAL_MODULE__slash_commands_SlashCommandArgument_js_a42b9371__.SlashCommandNamedArgument});const wn=(e=>{var t={};return __webpack_require__.d(t,e),t})({SlashCommandParser:()=>__WEBPACK_EXTERNAL_MODULE__slash_commands_SlashCommandParser_js_42c8b851__.SlashCommandParser});function Fn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sn(e,t,n){return t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pn(e,t,n){return t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}async function Tn(){globalThis.EjsTemplate={evalTemplate:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return te.isDryRun=!1,t=null!=t?t:await wt(),await Ct(e,t,{logging:!1,options:n})},prepareContext:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return await wt(t,e)},getSyntaxErrorInfo:Rt,setFeatures:e=>{!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(const[t,n]of Object.entries(c))void 0!==e[n.name]&&(l[n.name]=e[n.name],u.extension_settings.EjsTemplate[n.name]=e[n.name],m(t,e[n.name]))}(e)},allVariables:ne,saveVariables:le,resetFeatures:()=>p(!0),get defines(){return Pt},refreshWorldInfo:async()=>await _n((0,e.getCurrentChatId)(),!0),get initialVariables(){return te.initialVariables},parseJSON:bt,jsonPatch:gt,getFeatures:()=>function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kn(Object(n),!0).forEach((function(t){Pn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},l),compileTemplate:Ut,finalization:null!==globalThis&&void 0!==globalThis&&globalThis.FinalizationRegistry?new FinalizationRegistry((e=>{"function"==typeof(null==e?void 0:e.destroyIframe)&&e.destroyIframe()})):null}}async function Bn(){await async function(){e.eventSource.makeLast(e.event_types.CHAT_CHANGED,_n),e.eventSource.on(e.event_types.GENERATION_AFTER_COMMANDS,gn),e.eventSource.on(e.event_types.WORLDINFO_UPDATED,Dn),e.eventSource.on(e.event_types.GENERATION_AFTER_COMMANDS,hn),e.eventSource.on(e.event_types.GENERATE_AFTER_DATA,fn),yn.forEach((t=>e.eventSource.on(t,mn))),e.eventSource.on(e.event_types.WORLDINFO_ENTRIES_LOADED,dn),xn.forEach((t=>e.eventSource.on(t,vn))),e.eventSource.makeFirst(e.event_types.CHARACTER_MESSAGE_RENDERED,mn),e.eventSource.on("js_generation_before_end",bn),e.eventSource.on(e.event_types.MESSAGE_SWIPE_DELETED,En)}(),await async function(){}(),await async function(){function t(r,i){var s;u.extension_settings.EjsTemplate||(u.extension_settings.EjsTemplate={});const a=$('*[data-for="'.concat(r.slice(1),'"]'));a.length&&a.val()!=$(r).val()&&(a.off("change"),a.val($(r).val()),a.on("change",(()=>t(r,i)))),l[i.name]=null!==(s=f(r))&&void 0!==s?s:i.value,u.extension_settings.EjsTemplate[i.name]=l[i.name],console.debug("[Prompt Template] setting ".concat(i.name," changed to ").concat(u.extension_settings.EjsTemplate[i.name])),n().cache._capacity=l.cache_size,(0,e.saveSettingsDebounced)()}$("#extensions_settings").append(await(0,u.renderExtensionTemplateAsync)("third-party/ST-Prompt-Template","settings"));for(const[e,n]of Object.entries(c))"boolean"==typeof n.value?$(e).off("click").on("click",(()=>t(e,n))):($(e).off("change").on("change",(()=>t(e,n))),$('*[data-for="'.concat(e.slice(1),'"]')).off("change").on("change",(()=>t(e,n))));u.extension_settings.EjsTemplate||(u.extension_settings.EjsTemplate={},p(!0)),e.eventSource.on(e.event_types.SETTINGS_LOADED,h),e.eventSource.on(e.event_types.SETTINGS_UPDATED,d),h(),$("#pt_reset").click((function(){confirm("Reset all prompt template settings?")&&globalThis.EjsTemplate.resetFeatures()}))}(),await Tn(),console.log("ST-Prompt-Template initialized")}wn.SlashCommandParser.addCommandObject(An.SlashCommand.fromProps({name:"ejs",callback:async(e,t)=>{te.isDryRun=!1;const n=JSON.parse(e.ctx||"{}");e.block&&(t="<%= ".concat(t," %>"));const r=await wt(-1,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fn(Object(n),!0).forEach((function(t){Sn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({runType:"command",runID:-1,isDryRun:!1},n));l.debug_enabled&&console.debug("execute template code: ".concat(t));try{return await Ct(t,r,{logging:!1})}catch(e){throw e instanceof SyntaxError&&(e.message+=Rt(t)),console.error(e),e}finally{await le()}},namedArgumentList:[Cn.SlashCommandNamedArgument.fromProps({name:"ctx",description:"Execute context, eg. {a : 1, b: 2}",typeList:[Cn.ARGUMENT_TYPE.DICTIONARY],isRequired:!1}),Cn.SlashCommandNamedArgument.fromProps({name:"block",description:"Treat as a whole code block, eg. <%= code %>",typeList:[Cn.ARGUMENT_TYPE.DICTIONARY],isRequired:!1})],unnamedArgumentList:[Cn.SlashCommandArgument.fromProps({description:"code",typeList:[Cn.ARGUMENT_TYPE.STRING],isRequired:!0})],helpString:"Execute template code",returns:"string"})),wn.SlashCommandParser.addCommandObject(An.SlashCommand.fromProps({name:"ejs-refresh",callback:async(t,n)=>(await _n((0,e.getCurrentChatId)(),!0),""),helpString:"Preload world info"}));const On={init:Bn,exit:async function(){await async function(){e.eventSource.removeListener(e.event_types.CHAT_CHANGED,_n),e.eventSource.removeListener(e.event_types.WORLDINFO_UPDATED,Dn),e.eventSource.removeListener(e.event_types.GENERATION_AFTER_COMMANDS,hn),e.eventSource.removeListener(e.event_types.GENERATE_AFTER_DATA,fn),yn.forEach((t=>e.eventSource.removeListener(t,mn))),e.eventSource.removeListener(e.event_types.WORLDINFO_ENTRIES_LOADED,dn),xn.forEach((t=>e.eventSource.removeListener(t,vn))),e.eventSource.removeListener(e.event_types.CHARACTER_MESSAGE_RENDERED,mn),e.eventSource.removeListener(e.event_types.MESSAGE_SWIPE_DELETED,En)}(),await async function(){}(),await async function(){$("#extensions_settings").remove("#prompt_template_settings"),e.eventSource.removeListener(e.event_types.SETTINGS_LOADED,h),e.eventSource.removeListener(e.event_types.SETTINGS_UPDATED,d)}(),await async function(){delete globalThis.EjsTemplate}(),console.log("ST-Prompt-Template exited")},info:{id:"ST-Prompt-Template",name:"Prompt Template",description:""}},Nn=On;$((async()=>{await Bn()}))})(),__webpack_exports__=__webpack_exports__.default;var __webpack_exports__default=__webpack_exports__.default,__webpack_exports__exit=__webpack_exports__.false,__webpack_exports__info=__webpack_exports__.false,__webpack_exports__init=__webpack_exports__.false;export{__webpack_exports__default as default,__webpack_exports__exit as exit,__webpack_exports__info as info,__webpack_exports__init as init};
//# sourceMappingURL=index.js.map
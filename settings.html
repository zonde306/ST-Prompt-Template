<div id="prompt_template_settings">
	<div class="inline-drawer">
		<div class="inline-drawer-toggle inline-drawer-header">
			<b>
				<span data-i18n="Prompt template settings">提示词模板</span>
				<a class="notes-link" id="pt_reset">
                    <i class="fa fa-rotate-left"></i>
                </a>
			</b>
			<div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
		</div>
		
		<div class="inline-drawer-content">
			<label class="flex-container" title="全局开关" data-i18n="[title]Global switch">
				<input type="checkbox" id="pt_enabled">
				<span data-i18n="[PT] Enable">是否启用扩展</span>
				<span class="fa-solid fa-circle-question note-link-span"></span>
			</label>
			
			<hr>
			
			<label class="flex-container" title="生成全局开关" data-i18n="[title]Global generation switch">
				<input type="checkbox" id="pt_generate_enabled">
				<span data-i18n="[PT] Enable Generate-time evaluation">处理生成内容</span>
				<span class="fa-solid fa-circle-question note-link-span"></span>
			</label>
			
			<label class="flex-container" title="允许世界书条目的 [GENERATE:BEFORE] 和 [GENERATE:AFTER] 注入到生成提示词中" data-i18n="[title]Allow [GENERATE:BEFORE] and [GENERATE:AFTER] World Info entries to be injected into the generated prompt.">
				<input type="checkbox" id="pt_generate_loader_enabled">
				<span data-i18n="[PT] Enable [GENERATE] evaluation">生成时注入 [GENERATE] 世界书条目</span>
				<span class="fa-solid fa-circle-question note-link-span"></span>
			</label>

			<label class="flex-container" title="允许世界书条目的 @INJECT 注入到生成提示词中&#10;Contributed by kanon0914" data-i18n="[title]Allow @INJECT World Info entries to be injected into the generated prompt.\nContributed by kanon0914">
				<input type="checkbox" id="pt_inject_loader_enabled">
				<span data-i18n="[PT] Enable @INJECT evaluation">生成时注入 @INJECT 世界书条目</span>
				<span class="fa-solid fa-circle-question note-link-span"></span>
			</label>

			<hr>
			
			<label class="flex-container" title="楼层全局开关" data-i18n="[title]Global chat message switch">
				<input type="checkbox" id="pt_render_enabled">
				<span data-i18n="[PT] Enable Chat message evaluation">处理楼层消息</span>
				<span class="fa-solid fa-circle-question note-link-span"></span>
			</label>
			
			<label class="flex-container" title="允许世界书条目的 [RENDER:BEFORE] 和 [RENDER:AFTER] 注入到楼层消息中&#10;仅影响显示内容，不影响生成&#10;一般用来显示状态栏" data-i18n="[title]Allow [RENDER:BEFORE] and [RENDER:AFTER] World Info entries to be injected into chat messages.\nOnly affects display content, not generation.\nTypically used for displaying status bars.">
				<input type="checkbox" id="pt_render_loader_enabled">
				<span data-i18n="[PT] Enable [RENDER] evaluation">渲染楼层时注入 [RENDER] 世界书条目</span>
				<span class="fa-solid fa-circle-question note-link-span"></span>
			</label>
			
			<label class="flex-container" title="允许在处理楼层消息时对&lt;pre&gt;块进行模板处理" data-i18n="[title]Allow template processing of &lt;pre&gt; blocks when processing chat messages.">
				<input type="checkbox" id="pt_code_blocks">
				<span data-i18n="[PT] Enable code blocks">处理代码块</span>
				<span class="fa-solid fa-circle-question note-link-span"></span>
			</label>
			
			<label class="flex-container" title="先对原始消息进行原始消息的模板处理，会修改原始消息内容&#10;可以避免重复处理楼层消息，建议开启" data-i18n="[title]Process the original message content first, which will modify the original message content.\nThis can avoid reprocessing chat messages, it is recommended to enable.">
				<input type="checkbox" id="pt_permanent_evaluation">
				<span data-i18n="[PT] Permanent evaluation results">处理原始消息内容</span>
				<span class="fa-solid fa-circle-question note-link-span"></span>
			</label>
			
			<label class="flex-container" title="在生成前将楼层消息里的模板语句隐藏，不参与生成" data-i18n="[title]Hide template statements in chat messages before generation, so they are not included in the generation.">
				<input type="checkbox" id="pt_filter_chat_message">
				<span data-i18n="[PT] Filter chat message">生成时忽略楼层消息处理</span>
				<span class="fa-solid fa-circle-question note-link-span"></span>
			</label>
			
			<label title="仅处理深度小于此值的楼层&#10;-1表示无限制" data-i18n="[title]Only process messages shallower than this value.\n-1 means no limit.">
				<span data-i18n="[PT] chat depth limit">楼层处理最大深度</span>
				<span class="fa-solid fa-circle-question note-link-span"></span>
				<div class="flex-container">
					<div class="range-block-range">
						<input type="range" id="pt_chat_depth" name="chat_depth" min="-1" max="100" step="1" data-for="pt_chat_depth_counter">
					</div>
					<div class="range-block-counter" data-randomization-disabled="true">
						<input type="number" min="-1" max="100" step="1" data-for="pt_chat_depth" id="pt_chat_depth_counter">
					</div>
				</div>
			</label>
			
			<hr>
			
			<label class="flex-container" title="模板处理结束后立即保存&#10;一般不需要开启，酒馆也会自行保存的" data-i18n="[title]Save immediately after template processing is complete.\nUsually not necessary to enable, as Tavern will save it automatically.">
				<input type="checkbox" id="pt_autosave_enabled">
				<span data-i18n="[PT] Enable Autosave">自动保存变量更新</span>
				<span class="fa-solid fa-circle-question note-link-span"></span>
			</label>
			
			<label class="flex-container" title="打开角色卡时立即加载并处理世界书&#10;一般用来初始化变量和define" data-i18n="[title]Load and process World Info immediately when opening character cards.\nTypically used to initialize variables and defines.">
				<input type="checkbox" id="pt_preload_worldinfo">
				<span data-i18n="[PT] Enable Preload">立即加载世界书</span>
				<span class="fa-solid fa-circle-question note-link-span"></span>
			</label>
			
			<label class="flex-container" title="用来解决getvar is not defined的问题&#10;开启会导致define和const冲突" data-i18n="[title]Used to solve the 'getvar is not defined' issue.\nEnabling this may cause conflicts with 'define' and 'const'.">
				<input type="checkbox" id="pt_with_context_disabled">
				<span data-i18n="[PT] Disabling with statement">禁用with语句块</span>
				<span class="fa-solid fa-circle-question note-link-span"></span>
			</label>
			
			<label class="flex-container" title="控制台显示详细日志&#10;日志非常多" data-i18n="[title]Display detailed logs in the console.\nLogs can be very verbose.">
				<input type="checkbox" id="pt_debug_enabled">
				<span data-i18n="[PT] Enable debug logging">控制台显示详细信息</span>
				<span class="fa-solid fa-circle-question note-link-span"></span>
			</label>
			
			<label class="flex-container" title="旧设定兼容模式&#10;世界书中的GENERATE/RENDER/INJECT条目禁用时视为启用" data-i18n="[title]Old setting compatibility mode.\nGENERATE/RENDER/INJECT entries in World Info are considered enabled when disabled.">
				<input type="checkbox" id="pt_invert_enabled">
				<span data-i18n="[PT] Invert entry enable">GENERATE/RENDER/INJECT条目禁用视为启用</span>
				<span class="fa-solid fa-circle-question note-link-span"></span>
			</label>
			
			<hr>
			
			<label class="flex-container" title="模板编译缓存，可以提速&#10;目前存在一些问题" data-i18n="[title]Template compilation cache, can speed up performance.\nCurrent issues exist.">
				<span data-i18n="[PT] Enable cache">缓存（实验性）</span>
				<span class="fa-solid fa-circle-question note-link-span"></span>
				<select id="pt_cache_enabled">
					<option value="0" data-i18n="Disable">禁用</option>
					<option value="1" data-i18n="Enable">启用</option>
					<option value="2" data-i18n="Only worldinfo">仅世界书</option>
				</select>
			</label>
			
			<label title="缓存大小限制&#10;0则不限制" data-i18n="[title]Cache size limit.\n0 means no limit.">
				<span data-i18n="[PT] cache size">缓存大小</span>
				<span class="fa-solid fa-circle-question note-link-span"></span>
				<div class="flex-container">
					<div class="range-block-range">
						<input type="range" id="pt_cache_size" name="cache_size" min="0" max="512" step="8" data-for="pt_cache_size_counter">
					</div>
					<div class="range-block-counter" data-randomization-disabled="true">
						<input type="number" min="0" max="512" step="8" data-for="pt_cache_size" id="pt_cache_size_counter">
					</div>
				</div>
			</label>

			<label class="flex-container" title="缓存hash算法&#10;不同算法性能会有差异" data-i18n="[title]Cache hash algorithm.\nDifferent algorithms may have varying performance.">
				<span data-i18n="[PT] cache hasher">缓存Hash函数</span>
				<span class="fa-solid fa-circle-question note-link-span"></span>
				<select id="pt_cache_hasher">
					<option value="h32ToString" data-i18n="h32ToString">h32</option>
					<option value="h64ToString" data-i18n="h64ToString">h64</option>
				</select>
			</label>
		</div>
	</div>
</div>